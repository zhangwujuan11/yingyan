{"version":3,"file":"index.js","sources":["../../../xgplayer-helper-utils/es/events/index.js","../../../xgplayer-helper-models/es/playlist.js","../../../xgplayer-helper-models/es/data-view.js","../../../xgplayer-helper-models/es/track.js","../../../xgplayer-helper-models/es/u8a-buffer.js","../../../xgplayer-helper-models/es/track-meta.js","../../../xgplayer-helper-models/es/track-sample.js","../../../xgplayer-helper-models/es/media-info.js","../../../xgplayer-helper-models/es/ts-frag.js","../../../xgplayer-helper-utils/node_modules/eventemitter3/index.js","../../../xgplayer-helper-utils/es/context/index.js","../../../xgplayer-helper-utils/es/crypto/index.js","../../../xgplayer-helper-utils/es/loader-fetch/speed.js","../../../xgplayer-helper-utils/es/loader-fetch/fetch-loader.js","../../../xgplayer-helper-utils/es/common/dev-logger.js","../../../xgplayer-helper-codec/es/aac/adts.js","../../../xgplayer-helper-codec/es/avc/golomb.js","../../../xgplayer-helper-codec/es/avc/sps.js","../../../xgplayer-helper-codec/es/avc/rbsp.js","../../../xgplayer-helper-codec/es/avc/sei.js","../../../xgplayer-helper-codec/es/avc/nalunit.js","../../../xgplayer-helper-codec/es/hevc/golomb.js","../../../xgplayer-helper-codec/es/hevc/sps.js","../../../xgplayer-helper-codec/es/hevc/rbsp.js","../../../xgplayer-helper-codec/es/hevc/sei.js","../../../xgplayer-helper-codec/es/hevc/nalunit.js","../../../xgplayer-helper-codec/es/index.js","../../src/mobile/hls-live-mobile.js","../../../xgplayer-helper-transmuxers/node_modules/eventemitter3/index.js","../../../xgplayer-helper-transmuxers/es/hls/ts-demuxer.js","../../../xgplayer-helper-transmuxers/es/hls/ts.js","../../../xgplayer-helper-transmuxers/es/hls/m3u8.js","../../src/mobile/config.js","../../src/mobile/index.js"],"sourcesContent":["var BROWSER_EVENTS = {\n  VISIBILITY_CHANGE: 'VISIBILITY_CHANGE'\n};\nvar PLAYER_EVENTS = {\n  SEEK: 'SEEK'\n};\n\nvar LOADER_EVENTS = {\n  LADER_START: 'LOADER_START',\n  LOADER_DATALOADED: 'LOADER_DATALOADED',\n  LOADER_COMPLETE: 'LOADER_COMPLETE',\n  LOADER_RESPONSE_HEADERS: 'LOADER_RESPONSE_HEADERS',\n  LOADER_ERROR: 'LOADER_ERROR',\n  LOADER_RETRY: 'LOADER_RETRY',\n  LOADER_TTFB: 'LOADER_TTFB'\n};\n\nvar DEMUX_EVENTS = {\n  DEMUX_START: 'DEMUX_START',\n  DEMUX_COMPLETE: 'DEMUX_COMPLETE',\n  DEMUX_ERROR: 'DEMUX_ERROR',\n  METADATA_PARSED: 'METADATA_PARSED',\n  SEI_PARSED: 'SEI_PARSED',\n  VIDEO_METADATA_CHANGE: 'VIDEO_METADATA_CHANGE',\n  AUDIO_METADATA_CHANGE: 'AUDIO_METADATA_CHANGE',\n  MEDIA_INFO: 'MEDIA_INFO',\n  ISKEYFRAME: 'ISKEYFRAME'\n};\n\nvar REMUX_EVENTS = {\n  REMUX_METADATA: 'REMUX_METADATA',\n  REMUX_MEDIA: 'REMUX_MEDIA',\n  MEDIA_SEGMENT: 'MEDIA_SEGMENT',\n  REMUX_ERROR: 'REMUX_ERROR',\n  INIT_SEGMENT: 'INIT_SEGMENT',\n  DETECT_CHANGE_STREAM: 'DETECT_CHANGE_STREAM',\n  DETECT_CHANGE_STREAM_DISCONTINUE: 'DETECT_CHANGE_STREAM_DISCONTINUE',\n  DETECT_AUDIO_GAP: 'DETECT_AUDIO_GAP',\n  DETECT_LARGE_GAP: 'DETECT_LARGE_GAP',\n  DETECT_AUDIO_OVERLAP: 'DETECT_AUDIO_OVERLAP',\n  RANDOM_ACCESS_POINT: 'RANDOM_ACCESS_POINT',\n  DETECT_FRAG_ID_DISCONTINUE: 'DETECT_FRAG_ID_DISCONTINUE'\n};\n\nvar MSE_EVENTS = {\n  SOURCE_UPDATE_END: 'SOURCE_UPDATE_END',\n  MSE_ERROR: 'MSE_ERROR',\n  MSE_WRONG_TRACK_ADD: 'MSE_WRONG_TRACK_ADD'\n\n  // hls专有events\n};var HLS_EVENTS = {\n  RETRY_TIME_EXCEEDED: 'RETRY_TIME_EXCEEDED'\n};\n\nvar CRYPTO_EVENTS = {\n  START_DECRYPTOO: 'START_DECRYPTO',\n  DECRYPTED: 'DECRYPTED'\n};\nvar ALLEVENTS = Object.assign({}, LOADER_EVENTS, DEMUX_EVENTS, REMUX_EVENTS, MSE_EVENTS, HLS_EVENTS, PLAYER_EVENTS, BROWSER_EVENTS);\n\nvar FlvAllowedEvents = [];\nvar HlsAllowedEvents = [];\n\nfor (var key in ALLEVENTS) {\n  if (ALLEVENTS.hasOwnProperty(key)) {\n    FlvAllowedEvents.push(ALLEVENTS[key]);\n  }\n}\n\nfor (var _key in ALLEVENTS) {\n  if (ALLEVENTS.hasOwnProperty(_key)) {\n    HlsAllowedEvents.push(ALLEVENTS[_key]);\n  }\n}\n\nexport default {\n  ALLEVENTS: ALLEVENTS,\n  HLS_EVENTS: HLS_EVENTS,\n  REMUX_EVENTS: REMUX_EVENTS,\n  DEMUX_EVENTS: DEMUX_EVENTS,\n  MSE_EVENTS: MSE_EVENTS,\n  LOADER_EVENTS: LOADER_EVENTS,\n  FlvAllowedEvents: FlvAllowedEvents,\n  HlsAllowedEvents: HlsAllowedEvents,\n  CRYPTO_EVENTS: CRYPTO_EVENTS,\n  PLAYER_EVENTS: PLAYER_EVENTS,\n  BROWSER_EVENTS: BROWSER_EVENTS\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * @typedef {Object} TSFrag\n * @property {number} duration\n * @property {boolean} downloaded\n * @property {boolean} downloading\n * @property {number=} start\n * @property {number} cc\n * @property {boolean} discontinue\n */\n\nvar Playlist = function () {\n  function Playlist(configs) {\n    _classCallCheck(this, Playlist);\n\n    /** @type {string} */\n    this._baseURL = '';\n    /** @type {Object.<number, string>} */\n    this._list = {};\n    /** @type {Object.<string, TSFrag>} */\n    this._ts = {};\n    /** @type {number} */\n    this.version = 0;\n    /** @type {number} */\n    this.sequence = -1;\n    /** @type {number} */\n    this.targetduration = 0;\n    /** @type {number} */\n    this.duration = 0;\n    /** @type {number} */\n    this.fragLength = 0;\n    /** @type {TSFrag | undefined} */\n    this._lastget = undefined;\n    /** @type {boolean} */\n    this.end = false; // 判断live | vod , 对点播或直播结束时存在 EXT-X-ENDLIST\n    /** @type {boolean} */\n    this.autoclear = configs.autoclear || false;\n    /** @type {*} */\n    this.logger = configs.logger;\n    /** @type {string[]} */\n    this.downloadedUrls = [];\n    this._avgSegmentDuration = 4;\n  }\n\n  /**\n   * @return {Object<number, string>}\n   */\n\n\n  _createClass(Playlist, [{\n    key: 'push',\n\n\n    /**\n     * add a ts frag to play list\n     * @param {string} tsURL ts frag url\n     * @param {number} duration ts frag duration\n     * @param {boolean} discontinue has #EXT-X-DISCONTINUITY tag before this frag\n     * @param {number} id\n     * @param {number} cc\n     */\n    value: function push(tsURL, duration, discontinue, id, cc, isLast) {\n      if (!this._ts[tsURL]) {\n        this._ts[tsURL] = {\n          duration: duration,\n          downloaded: false,\n          downloading: false,\n          start: this.duration,\n          discontinue: !!discontinue,\n          id: id,\n          cc: cc,\n          isLast: isLast || false\n        };\n        this._list[this.duration] = tsURL;\n        this.duration += duration;\n        this.fragLength += 1;\n      }\n    }\n\n    /**\n     * delete a fragment from playlist\n     * @param {string} url\n     */\n\n  }, {\n    key: 'deleteFrag',\n    value: function deleteFrag(url) {\n      if (this._ts[url]) {\n        if (this._ts[url].start > this._lastget.time) {\n          this._lastget = {\n            duration: this._ts[url].duration,\n            time: this._ts[url].start,\n            downloaded: false,\n            downloading: false,\n            url: url,\n            id: this._ts[url].id\n          };\n        }\n        delete this._list[this._ts[url].start];\n        delete this._ts[url];\n        this.fragLength -= 1;\n      }\n    }\n  }, {\n    key: '_calcAvgFrgmentDuration',\n    value: function _calcAvgFrgmentDuration(data) {\n      if (!data.frags) return data.targetduration;\n      var fragLen = data.frags.length;\n      return Math.floor(data.duration / fragLen / 1000);\n    }\n\n    /**\n     * add m3u8 to current play list\n     * @param {*} data\n     * @param {boolean} deletepre\n     */\n\n  }, {\n    key: 'pushM3U8',\n    value: function pushM3U8(data, deletepre) {\n      // 常规信息替换\n      if (!data) {\n        throw new Error('No m3u8 data received.');\n      }\n      this.version = data.version;\n\n      this.targetduration = data.targetduration;\n\n      this._avgSegmentDuration = Math.min(this.targetduration, this._calcAvgFrgmentDuration(data));\n\n      if (data.encrypt && !this.encrypt) {\n        this.encrypt = data.encrypt;\n      }\n\n      this.end = data.end || false;\n\n      if (!data.sequence) {\n        data.sequence = 0;\n      }\n\n      // 新分片信息\n      if (data.sequence > this.sequence) {\n        var len = data.frags.length;\n        if (this.logger) {\n          this.logger.log('PLAYLIST', 'new playlist [' + data.sequence + ', ' + (data.sequence + len - 1) + ']');\n        }\n        this.sequence = data.sequence;\n        var newfraglist = [];\n        for (var i = 0; i < len; i++) {\n          var frag = data.frags[i];\n          if (!this._ts[frag.url] && this.downloadedUrls.indexOf(frag.url) < 0) {\n            newfraglist.push(frag.url);\n            this.push(frag.url, frag.duration, frag.discontinue, frag.id, frag.cc, frag.isLast);\n          }\n        }\n\n        if (newfraglist.length < 1) {\n          throw new Error('Can not read ts file list.');\n        }\n\n        if (deletepre) {\n          var tslist = this.getTsList();\n          for (var _i = 0; _i < tslist.length; _i++) {\n            if (newfraglist.indexOf(tslist[_i]) < 0) {\n              this.deleteFrag(tslist[_i]);\n            }\n          }\n        }\n      } else {\n        throw new Error('Old m3u8 file received, ' + data.sequence);\n      }\n    }\n\n    /**\n     * return ts url list\n     * @return {string[]}\n     */\n\n  }, {\n    key: 'getTsList',\n    value: function getTsList() {\n      return Object.keys(this._ts);\n    }\n\n    /**\n     * mark a ts frag as downloaded / not downloaded\n     * @param {string} tsname\n     * @param {boolean} isloaded\n     */\n\n  }, {\n    key: 'downloaded',\n    value: function downloaded(tsname, isloaded) {\n      var ts = this._ts[tsname];\n      if (ts) {\n        ts.downloaded = isloaded;\n      }\n    }\n\n    /**\n     * mark a ts frag as loading / not loading\n     * @param {string} tsname\n     * @param {boolean} loading\n     */\n\n  }, {\n    key: 'downloading',\n    value: function downloading(tsname, loading) {\n      var ts = this._ts[tsname];\n      if (ts) {\n        ts.downloading = loading;\n      }\n    }\n\n    /**\n     * get a frag by ts name\n     * @param name\n     * @return {TSFrag}\n     */\n\n  }, {\n    key: 'getTsByName',\n    value: function getTsByName(name) {\n      return this._ts[name];\n    }\n\n    /**\n     * get ts frag by timestamp\n     * @param {number} time\n     * @return {undefined|TSFrag}\n     */\n\n  }, {\n    key: 'getTs',\n    value: function getTs(time) {\n      var timelist = Object.keys(this._list);\n      var ts = void 0;\n\n      if (time === undefined) {\n        if (this._lastget) {\n          time = this._lastget.time + this._lastget.duration;\n        } else {\n          time = 0;\n        }\n      }\n\n      if (timelist.length < 1 || time >= this.duration) {\n        return undefined;\n      }\n      timelist = timelist.sort(function (a, b) {\n        return parseFloat(a) - parseFloat(b);\n      });\n      for (var i = 0; i < timelist.length; i++) {\n        if (time >= parseInt(timelist[i])) {\n          var url = this._list[timelist[i]];\n          var downloaded = this._ts[url].downloaded;\n          var downloading = this._ts[url].downloading;\n          ts = {\n            url: url,\n            downloaded: downloaded,\n            downloading: downloading,\n            time: parseInt(timelist[i]),\n            duration: parseInt(this._ts[url].duration),\n            id: this._ts[url].id,\n            cc: this._ts[url].cc,\n            isLast: this._ts[url].isLast\n          };\n          if (this.autoclear && this._lastget) {\n            delete this._ts[this._lastget.url];\n            delete this._list[this._lastget.time];\n          }\n          this._lastget = ts;\n        } else {\n          break;\n        }\n      }\n      if (ts) {\n        this.downloadedUrls.push(ts.url);\n      }\n      return ts;\n    }\n\n    /**\n     * get last downloaded ts frag\n     * @return {TSFrag|undefined}\n     */\n\n  }, {\n    key: 'getLastDownloadedTs',\n    value: function getLastDownloadedTs() {\n      var timelist = Object.keys(this._list).sort(function (a, b) {\n        var result = Number(a) - Number(b);\n        return result;\n      });\n      var found = void 0;\n      for (var i = 0; i < timelist.length; i++) {\n        var url = this._list[timelist[i]];\n        var downloaded = this._ts[url].downloaded;\n        var downloading = this._ts[url].downloading;\n        if (downloaded) {\n          found = { url: url, downloaded: downloaded, downloading: downloading, time: parseInt(timelist[i]), duration: parseInt(this._ts[url].duration) };\n        } else {\n          break;\n        }\n      }\n\n      return found;\n    }\n  }, {\n    key: 'clear',\n    value: function clear() {\n      this._baseURL = '';\n      this._list = {};\n      this._ts = {};\n      this.version = 0;\n      this.sequence = -1;\n      this.targetduration = 0;\n      this.duration = 0;\n    }\n  }, {\n    key: 'clearDownloaded',\n    value: function clearDownloaded() {\n      var list = Object.keys(this._ts);\n      for (var i = 0, l = list.length; i < l; i++) {\n        var ts = this._ts[list[i]];\n        ts.downloaded = false;\n        ts.downloading = false;\n      }\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this._baseURL = '';\n      this._list = {};\n      this._ts = {};\n      this.version = 0;\n      this.sequence = -1;\n      this.targetduration = 0;\n      this.duration = 0;\n      this.fragLength = 0;\n      this._lastget = undefined;\n      this.autoclear = false;\n    }\n  }, {\n    key: 'resetSequence',\n    value: function resetSequence() {\n      this.sequence = -1;\n    }\n  }, {\n    key: 'list',\n    get: function get() {\n      return this._list;\n    }\n\n    /**\n     * @param {string} baseURL\n     */\n\n  }, {\n    key: 'baseURL',\n    set: function set(baseURL) {\n      if (this.baseURL !== baseURL) {\n        this.clear();\n        this._baseURL = baseURL;\n      }\n    }\n\n    /**\n     * base cdn url for ts fragments\n     * @return {string}\n     */\n    ,\n    get: function get() {\n      return this._baseURL;\n    }\n  }, {\n    key: 'avgSegmentDuration',\n    get: function get() {\n      return this._avgSegmentDuration;\n    }\n  }]);\n\n  return Playlist;\n}();\n\nexport default Playlist;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar XGDataView = function () {\n  function XGDataView(buffer) {\n    _classCallCheck(this, XGDataView);\n\n    if (buffer instanceof ArrayBuffer) {\n      /** @type {ArrayBuffer} */\n      this.buffer = buffer;\n      /** @type {DataView} */\n      this.dataview = new DataView(buffer);\n      /** @type {number} */\n      this.dataview.position = 0;\n    } else {\n      throw new Error('data is invalid');\n    }\n  }\n\n  /**\n   * byffer length\n   * @return {number}\n   */\n\n\n  _createClass(XGDataView, [{\n    key: 'back',\n\n\n    /**\n     * move read position backward\n     * @param count\n     */\n    value: function back(count) {\n      this.position -= count;\n    }\n  }, {\n    key: 'getUint8',\n    value: function getUint8(offset) {\n      return this.dataview.getUint8(offset);\n    }\n\n    /**\n     * move read position forward\n     * @param count\n     */\n\n  }, {\n    key: 'skip',\n    value: function skip(count) {\n      var loop = Math.floor(count / 4);\n      var last = count % 4;\n      for (var i = 0; i < loop; i++) {\n        XGDataView.readByte(this.dataview, 4);\n      }\n      if (last > 0) {\n        XGDataView.readByte(this.dataview, last);\n      }\n    }\n\n    /**\n     * [readByte 从DataView中读取数据]\n     * @param  {DataView} buffer [DataView实例]\n     * @param  {Number} size   [读取字节数]\n     * @return {Number}        [整数]\n     */\n\n  }, {\n    key: 'readUint8',\n\n\n    /**\n     * @return {Number}\n     */\n    value: function readUint8() {\n      return XGDataView.readByte(this.dataview, 1);\n    }\n\n    /**\n     * @return {Number}\n     */\n\n  }, {\n    key: 'readUint16',\n    value: function readUint16() {\n      return XGDataView.readByte(this.dataview, 2);\n    }\n\n    /**\n     * @return {Number}\n     */\n\n  }, {\n    key: 'readUint24',\n    value: function readUint24() {\n      return XGDataView.readByte(this.dataview, 3);\n    }\n\n    /**\n     * @return {Number}\n     */\n\n  }, {\n    key: 'readUint32',\n    value: function readUint32() {\n      return XGDataView.readByte(this.dataview, 4);\n    }\n\n    /**\n     * @return {Number}\n     */\n\n  }, {\n    key: 'readUint64',\n    value: function readUint64() {\n      return XGDataView.readByte(this.dataview, 8);\n    }\n\n    /**\n     * @return {Number}\n     */\n\n  }, {\n    key: 'readInt8',\n    value: function readInt8() {\n      return XGDataView.readByte(this.dataview, 1, true);\n    }\n\n    /**\n     * @return {Number}\n     */\n\n  }, {\n    key: 'readInt16',\n    value: function readInt16() {\n      return XGDataView.readByte(this.dataview, 2, true);\n    }\n\n    /**\n     * @return {Number}\n     */\n\n  }, {\n    key: 'readInt32',\n    value: function readInt32() {\n      return XGDataView.readByte(this.dataview, 4, true);\n    }\n\n    /**\n     * @return {Uint8Array}\n     */\n\n  }, {\n    key: 'writeUint32',\n    value: function writeUint32(value) {\n      return new Uint8Array([value >>> 24 & 0xff, value >>> 16 & 0xff, value >>> 8 & 0xff, value & 0xff]);\n    }\n  }, {\n    key: 'length',\n    get: function get() {\n      return this.buffer.byteLength;\n    }\n\n    /**\n     * set current read position of data-view\n     * @param value\n     */\n\n  }, {\n    key: 'position',\n    set: function set(value) {\n      this.dataview.position = value;\n    }\n\n    /**\n     * set current read position of data-view\n     * @param value\n     */\n    ,\n    get: function get() {\n      return this.dataview.position;\n    }\n  }], [{\n    key: 'readByte',\n    value: function readByte(buffer, size, sign) {\n      var res = void 0;\n      switch (size) {\n        case 1:\n          if (sign) {\n            res = buffer.getInt8(buffer.position);\n          } else {\n            res = buffer.getUint8(buffer.position);\n          }\n          break;\n        case 2:\n          if (sign) {\n            res = buffer.getInt16(buffer.position);\n          } else {\n            res = buffer.getUint16(buffer.position);\n          }\n          break;\n        case 3:\n          if (sign) {\n            throw new Error('not supported for readByte 3');\n          } else {\n            res = buffer.getUint8(buffer.position) << 16;\n            res |= buffer.getUint8(buffer.position + 1) << 8;\n            res |= buffer.getUint8(buffer.position + 2);\n          }\n          break;\n        case 4:\n          if (sign) {\n            res = buffer.getInt32(buffer.position);\n          } else {\n            res = buffer.getUint32(buffer.position);\n          }\n          break;\n        case 8:\n          if (sign) {\n            throw new Error('not supported for readBody 8');\n          } else {\n            res = buffer.getUint32(buffer.position) << 32;\n            res |= buffer.getUint32(buffer.position + 4);\n          }\n          break;\n        default:\n          res = '';\n      }\n      buffer.position += size;\n      return res;\n    }\n  }]);\n\n  return XGDataView;\n}();\n\nexport default XGDataView;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Track = function () {\n  function Track() {\n    _classCallCheck(this, Track);\n\n    /** @type {number} */\n    this.id = -1;\n    /** @type {number} */\n    this.sequenceNumber = 0;\n    /** @type {*} */\n    this.samples = [];\n    /** @type {*} */\n    this.droppedSamples = [];\n    /** @type {number} */\n    this.length = 0;\n  }\n\n  _createClass(Track, [{\n    key: 'reset',\n    value: function reset() {\n      this.sequenceNumber = 0;\n      this.samples = [];\n      this.length = 0;\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this.reset();\n      this.id = -1;\n    }\n  }]);\n\n  return Track;\n}();\n\nexport default Track;\n\n\nexport var AudioTrack = function (_Track) {\n  _inherits(AudioTrack, _Track);\n\n  function AudioTrack() {\n    _classCallCheck(this, AudioTrack);\n\n    /** @type {string} */\n    var _this = _possibleConstructorReturn(this, (AudioTrack.__proto__ || Object.getPrototypeOf(AudioTrack)).call(this));\n\n    _this.TAG = 'AudioTrack';\n    /** @type {string} */\n    _this.type = 'audio';\n    return _this;\n  }\n\n  return AudioTrack;\n}(Track);\n\nexport var VideoTrack = function (_Track2) {\n  _inherits(VideoTrack, _Track2);\n\n  function VideoTrack() {\n    _classCallCheck(this, VideoTrack);\n\n    /** @type {string} */\n    var _this2 = _possibleConstructorReturn(this, (VideoTrack.__proto__ || Object.getPrototypeOf(VideoTrack)).call(this));\n\n    _this2.TAG = 'VideoTrack';\n    /** @type {string} */\n    _this2.type = 'video';\n    /** @type {number} */\n    _this2.dropped = 0;\n    /** @type {number} */\n    _this2.sequenceNumber = 0;\n    return _this2;\n  }\n\n  _createClass(VideoTrack, [{\n    key: 'reset',\n    value: function reset() {\n      this.sequenceNumber = 0;\n      this.samples = [];\n      this.length = 0;\n      this.dropped = 0;\n    }\n  }]);\n\n  return VideoTrack;\n}(Track);\n\nexport var Tracks = function () {\n  function Tracks() {\n    _classCallCheck(this, Tracks);\n\n    this.audioTrack = null;\n    this.videoTrack = null;\n  }\n\n  _createClass(Tracks, [{\n    key: 'destroy',\n    value: function destroy() {\n      this.audioTrack = null;\n      this.videoTrack = null;\n    }\n  }]);\n\n  return Tracks;\n}();","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar XgBuffer = function () {\n  /**\n   * A buffer to store loaded data.\n   *\n   * @class LoaderBuffer\n   * @param {number} length - Optional the buffer size\n   */\n  function XgBuffer(length) {\n    _classCallCheck(this, XgBuffer);\n\n    this.length = length || 0;\n    this.historyLen = length || 0;\n    this.array = [];\n    this.offset = 0;\n  }\n\n  /**\n   * The function to push data.\n   *\n   * @param {Uint8Array} data - The data to push into the buffer\n   */\n\n\n  _createClass(XgBuffer, [{\n    key: \"push\",\n    value: function push(data) {\n      this.array.push(data);\n      this.length += data.byteLength;\n      this.historyLen += data.byteLength;\n    }\n\n    /**\n     * The function to shift data.\n     *\n     * @param {number} length - The size of shift.\n     */\n\n  }, {\n    key: \"shift\",\n    value: function shift(length) {\n      if (this.array.length < 1) {\n        return new Uint8Array(0);\n      }\n\n      if (length === undefined) {\n        return this._shiftBuffer();\n      }\n      if (this.offset + length === this.array[0].length) {\n        var _ret = this.array[0].slice(this.offset, this.offset + length);\n        this.offset = 0;\n        this.array.shift();\n        this.length -= length;\n        return _ret;\n      }\n\n      if (this.offset + length < this.array[0].length) {\n        var _ret2 = this.array[0].slice(this.offset, this.offset + length);\n        this.offset += length;\n        this.length -= length;\n        return _ret2;\n      }\n\n      var ret = new Uint8Array(length);\n      var tmpoff = 0;\n      while (this.array.length > 0 && length > 0) {\n        if (this.offset + length < this.array[0].length) {\n          var tmp = this.array[0].slice(this.offset, this.offset + length);\n          ret.set(tmp, tmpoff);\n          this.offset += length;\n          this.length -= length;\n          length = 0;\n          break;\n        } else {\n          // console.log('mark1')\n          var templength = this.array[0].length - this.offset;\n          ret.set(this.array[0].slice(this.offset, this.array[0].length), tmpoff);\n          this.array.shift();\n          this.offset = 0;\n          tmpoff += templength;\n          this.length -= templength;\n          length -= templength;\n        }\n      }\n      return ret;\n    }\n\n    /**\n     * Function to clear the buffer.\n     */\n\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.array = [];\n      this.length = 0;\n      this.offset = 0;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.clear();\n      this.historyLen = 0;\n    }\n\n    /**\n     * Function to shift one unit8Array.\n     */\n\n  }, {\n    key: \"_shiftBuffer\",\n    value: function _shiftBuffer() {\n      this.length -= this.array[0].length;\n      this.offset = 0;\n      return this.array.shift();\n    }\n\n    /**\n     * Convert uint8 data to number.\n     *\n     * @param {number} start - the start postion.\n     * @param {number} length - the length of data.\n     */\n\n  }, {\n    key: \"toInt\",\n    value: function toInt(start, length) {\n      var retInt = 0;\n      var i = this.offset + start;\n      while (i < this.offset + length + start) {\n        if (i < this.array[0].length) {\n          retInt = retInt * 256 + this.array[0][i];\n        } else if (this.array[1]) {\n          retInt = retInt * 256 + this.array[1][i - this.array[0].length];\n        }\n\n        i++;\n      }\n      return retInt;\n    }\n  }]);\n\n  return XgBuffer;\n}();\n\nexport default XgBuffer;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nexport var AudioTrackMeta = function () {\n  function AudioTrackMeta(meta) {\n    _classCallCheck(this, AudioTrackMeta);\n\n    var _default = {\n      sampleRate: 48000,\n      channelCount: 2,\n      codec: 'mp4a.40.2',\n      config: [41, 401, 136, 0],\n      duration: 0,\n      id: 2,\n      refSampleDuration: 21,\n      sampleRateIndex: 3,\n      timescale: 1000,\n      type: 'audio'\n    };\n    if (meta) {\n      return Object.assign({}, _default, meta);\n    }\n    return _default;\n  }\n\n  _createClass(AudioTrackMeta, [{\n    key: 'destroy',\n    value: function destroy() {\n      this.init = null;\n    }\n  }]);\n\n  return AudioTrackMeta;\n}();\n\nexport var VideoTrackMeta = function () {\n  function VideoTrackMeta(meta) {\n    _classCallCheck(this, VideoTrackMeta);\n\n    var _default = {\n      avcc: null,\n      sps: new Uint8Array(0),\n      pps: new Uint8Array(0),\n      chromaFormat: 420,\n      codec: 'avc1.640020',\n      codecHeight: 720,\n      codecWidth: 1280,\n      duration: 0,\n      frameRate: {\n        fixed: true,\n        fps: 25,\n        fps_num: 25000,\n        fps_den: 1000\n      },\n      id: 1,\n      level: '3.2',\n      presentHeight: 720,\n      presentWidth: 1280,\n      profile: 'High',\n      refSampleDuration: 40,\n      parRatio: {\n        height: 1,\n        width: 1\n      },\n      timescale: 1000,\n      type: 'video'\n    };\n\n    if (meta) {\n      return Object.assign({}, _default, meta);\n    }\n    return _default;\n  }\n\n  _createClass(VideoTrackMeta, [{\n    key: 'destroy',\n    value: function destroy() {\n      this.init = null;\n      this.sps = null;\n      this.pps = null;\n    }\n  }]);\n\n  return VideoTrackMeta;\n}();","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * @typedef {Object} TAudioSample\n * @property {number} dts\n * @property {number} pts\n * @property {number} originDts\n * @property {Uint8Array} data\n */\n\n/**\n * @typedef {Object} TVideoSample\n * @property {number} dts\n * @property {number} pts\n * @property {boolean} isKeyframe\n * @property {number} originDts\n * @property {Uint8Array} data\n * @property {Array<any>} nals\n */\n\nexport var AudioSample = function () {\n  function AudioSample(info) {\n    _classCallCheck(this, AudioSample);\n\n    var _default = AudioSample.getDefault();\n    if (!info) {\n      return _default;\n    }\n    return Object.assign({}, _default, info);\n  }\n\n  /**\n   * default audio sample\n   * @return {TAudioSample}\n   */\n\n\n  _createClass(AudioSample, null, [{\n    key: \"getDefault\",\n    value: function getDefault() {\n      return {\n        dts: -1,\n        pts: -1,\n        originDts: -1,\n        data: new Uint8Array()\n      };\n    }\n  }]);\n\n  return AudioSample;\n}();\n\nexport var VideoSample = function () {\n  /**\n   * @constructor\n   * @param info\n   * @return {TVideoSample}\n   */\n  function VideoSample(info) {\n    _classCallCheck(this, VideoSample);\n\n    var _default = VideoSample.getDefault();\n\n    if (!info) {\n      return _default;\n    }\n    var sample = Object.assign({}, _default, info);\n\n    return sample;\n  }\n\n  /**\n   * default video sample\n   * @return {TVideoSample}\n   */\n\n\n  _createClass(VideoSample, null, [{\n    key: \"getDefault\",\n    value: function getDefault() {\n      return {\n        dts: -1,\n        pts: undefined,\n        isKeyframe: false, // is Random access point\n        originDts: -1,\n        data: new Uint8Array(),\n        nals: []\n      };\n    }\n  }]);\n\n  return VideoSample;\n}();","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * @typedef {Object} VideoMediaInfo\n * @property {string|null} codec\n * @property {number|null} width\n * @property {number|null} height\n * @property {string|null} profile\n * @property {{fixed: boolean,fps: number,fps_num: number,fps_den: number}} frameRate\n * @property {string|null} chromaFormat\n * @property {{width:number,height:number}} parRatio\n */\n\n/**\n * @typedef {Object} AudioMediaInfo\n * @property {string|null} codec\n * @property {number|null} sampleRate\n * @property {number|null} sampleRateIndex\n * @property {number|null} channelCount\n */\n\n/**\n * @param {Object} obj\n * @return {boolean}\n */\nvar isObjectFilled = function isObjectFilled(obj) {\n  for (var key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      if (obj[key] === null) {\n        return false;\n      }\n    }\n  }\n  return true;\n};\n\nvar MediaInfo = function () {\n  function MediaInfo() {\n    _classCallCheck(this, MediaInfo);\n\n    this.mimeType = null;\n    this.duration = null;\n\n    /** @type {boolean} */\n    this.hasVideo = false;\n    /**\n     * video media info\n     * @type {VideoMediaInfo}\n     */\n    this.video = {\n      codec: null,\n      width: null,\n      height: null,\n      profile: null,\n      level: null,\n      frameRate: {\n        fixed: true,\n        fps: 25,\n        fps_num: 25000,\n        fps_den: 1000\n      },\n      chromaFormat: null,\n      parRatio: {\n        width: 1,\n        height: 1\n      }\n      /** @type {boolean} */\n    };this.hasAudio = false;\n\n    /**\n     * video media info\n     * @type {AudioMediaInfo}\n     */\n    this.audio = {\n      codec: null,\n      sampleRate: null,\n      sampleRateIndex: null,\n      channelCount: null\n    };\n  }\n\n  _createClass(MediaInfo, [{\n    key: \"isComplete\",\n    value: function isComplete() {\n      return MediaInfo.isBaseInfoReady(this) && MediaInfo.isVideoReady(this) && MediaInfo.isAudioReady(this);\n    }\n  }], [{\n    key: \"isBaseInfoReady\",\n    value: function isBaseInfoReady(mediaInfo) {\n      return isObjectFilled(mediaInfo);\n    }\n  }, {\n    key: \"isVideoReady\",\n    value: function isVideoReady(mediaInfo) {\n      if (!mediaInfo.hasVideo) {\n        return true;\n      }\n\n      return isObjectFilled(mediaInfo.video);\n    }\n  }, {\n    key: \"isAudioReady\",\n    value: function isAudioReady(mediaInfo) {\n      if (!mediaInfo.hasAudio) {\n        return true;\n      }\n\n      return isObjectFilled(mediaInfo.video);\n    }\n  }]);\n\n  return MediaInfo;\n}();\n\nexport default MediaInfo;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * @typedef {Object} TsFragProps\n * @property {number} start\n * @property {number} duration\n * @property {string} url\n * @property {boolean} discontinue\n * @property {number} id\n * @property {number} cc\n */\nvar TsFrag = function () {\n  _createClass(TsFrag, null, [{\n    key: 'getDefault',\n\n    /**\n     *\n     * @return TsFrag\n     */\n    value: function getDefault() {\n      return {\n        id: -1,\n        url: '',\n        start: -1,\n        duration: -1,\n        discontinue: false,\n        cc: -1\n      };\n    }\n    /**\n     *\n     * @param {TsFragProps} props\n     */\n\n  }]);\n\n  function TsFrag(props) {\n    _classCallCheck(this, TsFrag);\n\n    var merged = Object.assign({}, TsFrag.getDefault(), props);\n\n    this.id = merged.id;\n\n    this.url = merged.url;\n\n    this.start = merged.start;\n\n    this.duration = merged.duration;\n\n    this.discontinue = merged.discontinue;\n\n    this.cc = merged.cc;\n  }\n\n  return TsFrag;\n}();\n\nexport default TsFrag;","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport EVENTS from '../events';\nimport { MediaInfo } from 'xgplayer-helper-models';\nimport EventEmitter from 'eventemitter3';\n\nvar DIRECT_EMIT_FLAG = '__TO__';\n\nvar Context = function () {\n  /**\n   *\n   * @param {*} player\n   * @param {*} configs\n   * @param {string[]}allowedEvents\n   */\n  function Context(player, configs) {\n    var allowedEvents = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n\n    _classCallCheck(this, Context);\n\n    this._emitter = new EventEmitter();\n    if (!this._emitter.off) {\n      this._emitter.off = this._emitter.removeListener;\n    }\n\n    this.mediaInfo = new MediaInfo();\n    this._instanceMap = {}; // 所有的解码流程实例\n    this._clsMap = {}; // 构造函数的map\n    this._inited = false;\n    this.allowedEvents = allowedEvents;\n    this._configs = configs;\n    this._player = player;\n    this._hooks = {}; // 注册在事件前/后的钩子，例如 before('DEMUX_COMPLETE')\n  }\n\n  /**\n   * 从上下文中获取解码流程实例，如果没有实例，构造一个\n   * @param {string} tag\n   * @returns {*}\n   */\n\n\n  _createClass(Context, [{\n    key: 'getInstance',\n    value: function getInstance(tag) {\n      var instance = this._instanceMap[tag];\n      if (instance) {\n        return instance;\n      } else {\n        // throw new Error(`${tag}实例尚未初始化`)\n        return null;\n      }\n    }\n\n    /**\n     * 初始化具体实例\n     * @param {string} tag\n     * @param {any[]}args\n     */\n\n  }, {\n    key: 'initInstance',\n    value: function initInstance(tag) {\n      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      var a = args[0],\n          b = args[1],\n          c = args[2],\n          d = args[3];\n\n      if (this._clsMap[tag]) {\n        var newInstance = new this._clsMap[tag](a, b, c, d);\n        this._instanceMap[tag] = newInstance;\n        if (newInstance.init) {\n          newInstance.init(); // TODO: lifecircle\n        }\n        return newInstance;\n      } else {\n        throw new Error(tag + '\\u672A\\u5728context\\u4E2D\\u6CE8\\u518C');\n      }\n    }\n\n    /**\n     * 避免大量的initInstance调用，初始化所有的组件\n     * @param {*} config\n     */\n\n  }, {\n    key: 'init',\n    value: function init(config) {\n      if (this._inited) {\n        return;\n      }\n      for (var tag in this._clsMap) {\n        // if not inited, init an instance\n        if (this._clsMap.hasOwnProperty(tag) && !this._instanceMap[tag]) {\n          this.initInstance(tag, config);\n        }\n      }\n      this._inited = true;\n    }\n\n    /**\n     * 注册一个上下文流程，提供安全的事件发送机制\n     * @param {string} tag\n     * @param {*} cls\n     */\n\n  }, {\n    key: 'registry',\n    value: function registry(tag, cls) {\n      var _this2 = this;\n\n      var emitter = this._emitter;\n      var checkMessageName = this._isMessageNameValid.bind(this);\n      var self = this;\n      var enhanced = function (_cls) {\n        _inherits(enhanced, _cls);\n\n        function enhanced(a, b, c) {\n          _classCallCheck(this, enhanced);\n\n          var _this = _possibleConstructorReturn(this, (enhanced.__proto__ || Object.getPrototypeOf(enhanced)).call(this, a, b, c));\n\n          _this.listeners = {};\n          _this.onceListeners = {};\n          _this.TAG = tag;\n          _this._context = self;\n          return _this;\n        }\n\n        /**\n         * @param {string} messageName\n         * @param {function} callback\n         */\n\n\n        _createClass(enhanced, [{\n          key: 'on',\n          value: function on(messageName, callback) {\n            checkMessageName(messageName);\n\n            if (this.listeners[messageName]) {\n              this.listeners[messageName].push(callback);\n            } else {\n              this.listeners[messageName] = [callback];\n            }\n\n            emitter.on('' + messageName + DIRECT_EMIT_FLAG + tag, callback); // 建立定向通信监听\n            return emitter.on(messageName, callback);\n          }\n\n          /**\n           * @param {string} messageName\n           * @param {function} callback\n           */\n\n        }, {\n          key: 'before',\n          value: function before(messageName, callback) {\n            checkMessageName(messageName);\n            if (self._hooks[messageName]) {\n              self._hooks[messageName].push(callback);\n            } else {\n              self._hooks[messageName] = [callback];\n            }\n          }\n\n          /**\n           * @param {string} messageName\n           * @param {function} callback\n           */\n\n        }, {\n          key: 'once',\n          value: function once(messageName, callback) {\n            checkMessageName(messageName);\n\n            if (this.onceListeners[messageName]) {\n              this.onceListeners[messageName].push(callback);\n            } else {\n              this.onceListeners[messageName] = [callback];\n            }\n\n            emitter.once('' + messageName + DIRECT_EMIT_FLAG + tag, callback);\n            return emitter.once(messageName, callback);\n          }\n\n          /**\n           * @param {string} messageName\n           * @param {any[]} args\n           */\n\n        }, {\n          key: 'emit',\n          value: function emit(messageName) {\n            checkMessageName(messageName);\n            // console.log('emit ', messageName);\n\n            var beforeList = self._hooks ? self._hooks[messageName] : null;\n\n            for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n              args[_key2 - 1] = arguments[_key2];\n            }\n\n            if (beforeList) {\n              for (var i = 0, len = beforeList.length; i < len; i++) {\n                var callback = beforeList[i];\n                // eslint-disable-next-line standard/no-callback-literal\n                callback.apply(undefined, args);\n              }\n            }\n            return emitter.emit.apply(emitter, [messageName].concat(args));\n          }\n\n          /**\n           * 定向发送给某个组件单例的消息\n           * @param {string} messageName\n           * @param {any[]} args\n           */\n\n        }, {\n          key: 'emitTo',\n          value: function emitTo(tag, messageName) {\n            checkMessageName(messageName);\n\n            for (var _len3 = arguments.length, args = Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {\n              args[_key3 - 2] = arguments[_key3];\n            }\n\n            return emitter.emit.apply(emitter, ['' + messageName + DIRECT_EMIT_FLAG + tag].concat(args));\n          }\n\n          /**\n           * 定向发送给某个组件单例的消息\n           * @param {string} messageName\n           * @param {function} callback\n           */\n\n        }, {\n          key: 'off',\n          value: function off(messageName, callback) {\n            checkMessageName(messageName);\n            return emitter.off(messageName, callback);\n          }\n        }, {\n          key: 'removeListeners',\n          value: function removeListeners() {\n            var hasOwn = Object.prototype.hasOwnProperty.bind(this.listeners);\n\n            for (var messageName in this.listeners) {\n              if (hasOwn(messageName)) {\n                var callbacks = this.listeners[messageName] || [];\n                for (var i = 0; i < callbacks.length; i++) {\n                  var callback = callbacks[i];\n                  emitter.off(messageName, callback);\n                  emitter.off('' + messageName + DIRECT_EMIT_FLAG + tag, callback);\n                }\n              }\n            }\n\n            for (var _messageName in this.onceListeners) {\n              if (hasOwn(_messageName)) {\n                var _callbacks = this.onceListeners[_messageName] || [];\n                for (var _i = 0; _i < _callbacks.length; _i++) {\n                  var _callback = _callbacks[_i];\n                  emitter.off(_messageName, _callback);\n                  emitter.off('' + _messageName + DIRECT_EMIT_FLAG + tag, _callback);\n                }\n              }\n            }\n          }\n\n          /**\n           * 在组件销毁时，默认将它注册的事件全部卸载，确保不会造成内存泄漏\n           */\n\n        }, {\n          key: 'destroy',\n          value: function destroy() {\n            // step1 unlisten events\n            this.removeListeners();\n            this.listeners = {};\n            // step2 release from context\n            delete self._instanceMap[tag];\n            if (_get(enhanced.prototype.__proto__ || Object.getPrototypeOf(enhanced.prototype), 'destroy', this)) {\n              return _get(enhanced.prototype.__proto__ || Object.getPrototypeOf(enhanced.prototype), 'destroy', this).call(this);\n            }\n            this._context = null;\n          }\n        }, {\n          key: '_player',\n          get: function get() {\n            if (!this._context) {\n              return null;\n            }\n            return this._context._player;\n          },\n          set: function set(v) {\n            if (this._context) {\n              this._context._player = v;\n            }\n          }\n        }, {\n          key: '_pluginConfig',\n          get: function get() {\n            if (!this._context) {\n              return null;\n            }\n            return this._context._configs;\n          }\n        }]);\n\n        return enhanced;\n      }(cls);\n      this._clsMap[tag] = enhanced;\n\n      /**\n       * get instance immediately\n       * e.g const instance = context.registry(tag, Cls)(config)\n       * */\n      return function () {\n        for (var _len4 = arguments.length, args = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n          args[_key4] = arguments[_key4];\n        }\n\n        return _this2.initInstance.apply(_this2, [tag].concat(args));\n      };\n    }\n\n    /**\n     * 各个模块处理seek\n     * @param {number} time\n     */\n\n  }, {\n    key: 'seek',\n    value: function seek(time) {\n      this._emitter.emit(EVENTS.PLAYER_EVENTS.SEEK, time);\n    }\n\n    /**\n     * 对存在的实例进行\n     */\n\n  }, {\n    key: 'destroyInstances',\n    value: function destroyInstances() {\n      var _this3 = this;\n\n      Object.keys(this._instanceMap).forEach(function (tag) {\n        if (_this3._instanceMap[tag].destroy) {\n          _this3._instanceMap[tag].destroy();\n        }\n      });\n    }\n\n    /**\n     * 编解码流程无需关注事件的解绑\n     */\n\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this.destroyInstances();\n      if (this._emitter) {\n        this._emitter.removeAllListeners();\n      }\n      this._emitter = null;\n      this.allowedEvents = [];\n      this._clsMap = null;\n      this._hooks = null;\n      this._player = null;\n      this._configs = null;\n    }\n\n    /**\n     * 对信道进行收拢\n     * @param {string} messageName\n     * @private\n     */\n\n  }, {\n    key: '_isMessageNameValid',\n    value: function _isMessageNameValid(messageName) {\n      if (!this.allowedEvents.indexOf(messageName) < 0) {\n        throw new Error('unregistered message name: ' + messageName);\n      }\n    }\n  }]);\n\n  return Context;\n}();\n\nexport default Context;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport EVENTS from '../events';\n\nvar CRYPTO_EVENTS = EVENTS.CRYPTO_EVENTS;\n\nvar Crypto = function () {\n  function Crypto(config) {\n    _classCallCheck(this, Crypto);\n\n    this.inputBuffer = config.inputbuffer;\n    this.outputBuffer = config.outputbuffer;\n    this.key = config.key;\n    this.iv = config.iv;\n    this.method = config.method;\n\n    this.crypto = window.crypto || window.msCrypto;\n  }\n\n  _createClass(Crypto, [{\n    key: 'init',\n    value: function init() {\n      this.on(CRYPTO_EVENTS.START_DECRYPTO, this.decrypto.bind(this));\n    }\n  }, {\n    key: 'decrypto',\n    value: function decrypto() {\n      var _this = this;\n\n      if (!this.aeskey) {\n        var sbkey = this.crypto.subtle.importKey('raw', this.key.buffer, { name: 'AES-CBC' }, false, ['encrypt', 'decrypt']);\n        sbkey.then(function (key) {\n          _this.aeskey = key;\n          _this.decryptoData();\n        });\n      } else {\n        this.decryptoData();\n      }\n    }\n  }, {\n    key: 'decryptoData',\n    value: function decryptoData() {\n      var _this2 = this;\n\n      var inputbuffer = this._context.getInstance(this.inputBuffer);\n      var outputbuffer = this._context.getInstance(this.outputBuffer);\n      var data = inputbuffer.shift();\n      if (data) {\n        this.crypto.subtle.decrypt({ name: 'AES-CBC', iv: this.iv.buffer }, this.aeskey, data).then(function (res) {\n          outputbuffer.push(new Uint8Array(res));\n          _this2.emit(CRYPTO_EVENTS.DECRYPTED);\n          _this2.decryptoData(data);\n        });\n      }\n    }\n  }]);\n\n  return Crypto;\n}();\n\nexport default Crypto;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Speed = function () {\n  function Speed() {\n    _classCallCheck(this, Speed);\n\n    // milliseconds\n    this._firstCheckpoint = 0;\n    this._lastCheckpoint = 0;\n    this._intervalBytes = 0;\n    this._lastSamplingBytes = 0;\n\n    this._now = Date.now;\n  }\n\n  _createClass(Speed, [{\n    key: \"reset\",\n    value: function reset() {\n      this._firstCheckpoint = this._lastCheckpoint = 0;\n      this._intervalBytes = 0;\n      this._lastSamplingBytes = 0;\n    }\n  }, {\n    key: \"addBytes\",\n    value: function addBytes(bytes) {\n      var duration = this._now() - this._lastCheckpoint;\n      if (this._firstCheckpoint === 0) {\n        this._firstCheckpoint = this._now();\n        this._lastCheckpoint = this._firstCheckpoint;\n        this._intervalBytes += bytes;\n      } else if (duration < 5000) {\n        this._intervalBytes += bytes;\n      } else {\n        // duration >= 1000\n        this._lastSamplingBytes = this._intervalBytes / (duration / 1000);\n        this._intervalBytes = bytes;\n        this._lastCheckpoint = this._now();\n      }\n    }\n  }, {\n    key: \"currentKBps\",\n    get: function get() {\n      this.addBytes(0);\n\n      var durationSeconds = (this._now() - this._lastCheckpoint) / 1000;\n      if (durationSeconds === 0) durationSeconds = 1;\n      return this._intervalBytes / durationSeconds / 1024;\n    }\n  }, {\n    key: \"lastSamplingKBps\",\n    get: function get() {\n      this.addBytes(0);\n\n      if (this._lastSamplingBytes !== 0) {\n        return this._lastSamplingBytes / 1024;\n      } else {\n        // lastSecondBytes === 0\n        if (this._now() - this._lastCheckpoint >= 500) {\n          // if time interval since last checkpoint has exceeded 500ms\n          // the speed is nearly accurate\n          return this.currentKBps;\n        } else {\n          // We don't know\n          return 0;\n        }\n      }\n    }\n  }]);\n\n  return Speed;\n}();\n\nexport default Speed;","var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport EVENTS from '../events';\nimport Speed from './speed';\n\nvar LOADER_EVENTS = EVENTS.LOADER_EVENTS;\nvar READ_STREAM = 0;\nvar READ_TEXT = 1;\nvar READ_JSON = 2;\nvar READ_BUFFER = 3;\n\nvar FetchLoader = function () {\n  function FetchLoader(configs) {\n    _classCallCheck(this, FetchLoader);\n\n    this.configs = Object.assign({}, configs);\n    this.url = null;\n    this.status = 0;\n    this.error = null;\n    this._reader = null;\n    this._canceled = false;\n    this._destroyed = false;\n    this.readtype = this.configs.readtype;\n    this.buffer = this.configs.buffer || 'LOADER_BUFFER';\n    this._loaderTaskNo = 0;\n    this._ttfb = 0;\n    this._speed = new Speed();\n    if (window.AbortController) {\n      this.abortControllerEnabled = true;\n    }\n  }\n\n  _createClass(FetchLoader, [{\n    key: 'init',\n    value: function init() {\n      this.on(LOADER_EVENTS.LADER_START, this.load.bind(this));\n    }\n  }, {\n    key: 'fetch',\n\n\n    /**\n     * @param {string}      url\n     * @param {RequestInit} params\n     * @param {number}      timeout\n     * @return {Promise<unknown>}\n     */\n    value: function (_fetch) {\n      function fetch(_x, _x2, _x3) {\n        return _fetch.apply(this, arguments);\n      }\n\n      fetch.toString = function () {\n        return _fetch.toString();\n      };\n\n      return fetch;\n    }(function (url, params, timeout) {\n      var _this2 = this;\n\n      var timer = null;\n      if (this.abortControllerEnabled) {\n        this.abortController = new window.AbortController();\n      }\n      Object.assign(params, { signal: this.abortController ? this.abortController.signal : undefined });\n      var start = new Date().getTime();\n      return Promise.race([fetch(url, params), new Promise(function (resolve, reject) {\n        timer = setTimeout(function () {\n          /* eslint-disable-next-line */\n          reject({\n            code: 999,\n            message: 'fetch timeout'\n          });\n          if (_this2.abortController) {\n            _this2.abortController.abort();\n          }\n        }, timeout || 1e4); // 10s\n      })]).then(function (response) {\n        if (timer) {\n          clearTimeout(timer);\n          timer = null;\n        }\n        var end = new Date().getTime();\n        _this2.emit(LOADER_EVENTS.LOADER_TTFB, {\n          start: start,\n          end: end,\n          elapsed: end - start\n        });\n        return response;\n      });\n    })\n\n    /**\n     * @param {string}      url\n     * @param {RequestInit} params\n     * @param {number}      retryTimes\n     * @param {number}      totalRetry\n     * @param {number}      delayTime\n     * @return {Promise<{ok}>}\n     */\n\n  }, {\n    key: 'internalLoad',\n    value: function internalLoad(url, params, retryTimes, totalRetry) {\n      var _this3 = this;\n\n      var delayTime = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n      var loadTimeout = arguments[5];\n\n      if (this._destroyed) return;\n      this.loading = true;\n      return this.fetch(this.url, params, loadTimeout).then(function (response) {\n        !_this3._destroyed && _this3.emit(LOADER_EVENTS.LOADER_RESPONSE_HEADERS, _this3.TAG, response.headers);\n\n        if (response.ok) {\n          _this3.status = response.status;\n          Promise.resolve().then(function () {\n            _this3._onFetchResponse(response);\n          });\n\n          return Promise.resolve(response);\n        }\n\n        if (retryTimes-- > 0) {\n          _this3._retryTimer = setTimeout(function () {\n            _this3.emit(LOADER_EVENTS.LOADER_RETRY, _this3.TAG, {\n              response: response,\n              reason: 'response not ok',\n              retryTime: totalRetry - retryTimes\n            });\n            return _this3.internalLoad(url, params, retryTimes, totalRetry, delayTime, loadTimeout);\n          }, delayTime);\n        } else {\n          _this3.loading = false;\n          _this3.emit(LOADER_EVENTS.LOADER_ERROR, _this3.TAG, {\n            code: response.status || 21,\n            message: response.status + ' (' + response.statusText + ')'\n          });\n        }\n      }).catch(function (error) {\n        if (_this3._destroyed) {\n          _this3.loading = false;\n          return;\n        }\n\n        if (retryTimes-- > 0) {\n          _this3._retryTimer = setTimeout(function () {\n            _this3.emit(LOADER_EVENTS.LOADER_RETRY, _this3.TAG, {\n              error: error,\n              reason: 'fetch error',\n              retryTime: totalRetry - retryTimes\n            });\n            return _this3.internalLoad(url, params, retryTimes, totalRetry, delayTime, loadTimeout);\n          }, delayTime);\n        } else {\n          _this3.loading = false;\n          if (error && error.name === 'AbortError') {\n            return;\n          }\n          _this3.emit(LOADER_EVENTS.LOADER_ERROR, _this3.TAG, Object.assign({ code: 21 }, error));\n        }\n      });\n    }\n\n    /**\n     * @param {string}      url\n     * @param {RequestInit} opts\n     * @param {retryCount, retryDelay, loadTimeout}  pluginConfig\n     * @return {Promise<{ok}>}\n     */\n\n  }, {\n    key: 'load',\n    value: function load(url) {\n      var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n          retryCount = _ref.retryCount,\n          retryDelay = _ref.retryDelay,\n          loadTimeout = _ref.loadTimeout;\n\n      retryCount = retryCount === undefined ? 3 : retryCount;\n      this.url = url;\n      this._canceled = false;\n\n      // TODO: Add Ranges\n      var params = this.getParams(opts);\n\n      return this.internalLoad(url, params, retryCount, retryCount, retryDelay, loadTimeout);\n    }\n  }, {\n    key: '_onFetchResponse',\n    value: function _onFetchResponse(response) {\n      var _this4 = this;\n\n      var _this = this;\n      var buffer = this._context.getInstance(this.buffer);\n      this._loaderTaskNo++;\n      var taskno = this._loaderTaskNo;\n      if (response.ok === true) {\n        switch (this.readtype) {\n          case READ_JSON:\n            response.json().then(function (data) {\n              _this.loading = false;\n              if (!_this._canceled && !_this._destroyed) {\n                if (buffer) {\n                  buffer.push(data);\n                  _this.emit(LOADER_EVENTS.LOADER_COMPLETE, buffer);\n                } else {\n                  _this.emit(LOADER_EVENTS.LOADER_COMPLETE, data);\n                }\n              }\n            });\n            break;\n          case READ_TEXT:\n            response.text().then(function (data) {\n              _this.loading = false;\n              if (!_this._canceled && !_this._destroyed) {\n                if (buffer) {\n                  buffer.push(data);\n                  _this.emit(LOADER_EVENTS.LOADER_COMPLETE, buffer);\n                } else {\n                  _this.emit(LOADER_EVENTS.LOADER_COMPLETE, data);\n                }\n              }\n            });\n            break;\n          case READ_BUFFER:\n            response.arrayBuffer().then(function (data) {\n              _this.loading = false;\n              if (!_this._canceled && !_this._destroyed) {\n                if (buffer) {\n                  buffer.push(new Uint8Array(data));\n                  _this4._speed.addBytes(data.byteLength);\n                  _this.emit(LOADER_EVENTS.LOADER_COMPLETE, buffer);\n                } else {\n                  _this.emit(LOADER_EVENTS.LOADER_COMPLETE, data);\n                }\n              }\n            }).catch(function () {});\n            break;\n          case READ_STREAM:\n          default:\n            return this._onReader(response.body.getReader(), taskno);\n        }\n      }\n    }\n  }, {\n    key: '_onReader',\n    value: function _onReader(reader, taskno) {\n      var _this5 = this;\n\n      var buffer = this._context.getInstance(this.buffer);\n      if (!buffer && this._reader || this._destroyed) {\n        try {\n          this._reader.cancel();\n        } catch (e) {\n          // DO NOTHING\n        }\n      }\n\n      this._reader = reader;\n      if (this.loading === false) {\n        return;\n      }\n\n      // reader read function returns a Promise. get data when callback and has value.done when disconnected.\n      // read方法返回一个Promise. 回调中可以获取到数据。当value.done存在时，说明链接断开。\n      this._noDataTimer = setTimeout(function () {\n        if (_this5.loading === false) return;\n        _this5.emit(LOADER_EVENTS.LOADER_COMPLETE);\n      }, 3000);\n      this._reader && this._reader.read().then(function (val) {\n        clearTimeout(_this5._noDataTimer);\n        if (_this5._canceled || _this5._destroyed) {\n          if (_this5._reader) {\n            try {\n              _this5._reader.cancel();\n            } catch (e) {\n              // DO NOTHING\n            }\n          }\n          return;\n        }\n        if (val.done) {\n          _this5.loading = false;\n          _this5.status = 0;\n          Promise.resolve().then(function () {\n            _this5.emit(LOADER_EVENTS.LOADER_COMPLETE, buffer);\n          });\n          return;\n        }\n\n        buffer.push(val.value);\n        _this5._speed.addBytes(val.value.byteLength);\n        Promise.resolve().then(function () {\n          _this5.emit(LOADER_EVENTS.LOADER_DATALOADED, buffer);\n        });\n        return _this5._onReader(reader, taskno);\n      }).catch(function (error) {\n        clearTimeout(_this5._noDataTimer);\n        _this5.loading = false;\n        if (error && error.name === 'AbortError') return;\n        _this5.emit(LOADER_EVENTS.LOADER_ERROR, _this5.TAG, error);\n      });\n    }\n\n    /**\n     *\n     * @param {RequestInit} opts\n     * @return {{mode: string, headers: Headers, cache: string, method: string}}\n     */\n\n  }, {\n    key: 'getParams',\n    value: function getParams(opts) {\n      var options = Object.assign({}, opts);\n      var headers = new Headers();\n\n      var params = {\n        method: 'GET',\n        headers: headers,\n        mode: 'cors',\n        cache: 'default'\n\n        // add custmor headers\n        // 添加自定义头\n      };if (_typeof(this.configs.headers) === 'object') {\n        var configHeaders = this.configs.headers;\n        for (var key in configHeaders) {\n          if (configHeaders.hasOwnProperty(key)) {\n            headers.append(key, configHeaders[key]);\n          }\n        }\n      }\n\n      if (_typeof(options.headers) === 'object') {\n        var optHeaders = options.headers;\n        for (var _key in optHeaders) {\n          if (optHeaders.hasOwnProperty(_key)) {\n            headers.append(_key, optHeaders[_key]);\n          }\n        }\n      }\n\n      if (options.cors === false) {\n        params.mode = 'same-origin';\n      }\n\n      // withCredentials is disabled by default\n      // withCredentials 在默认情况下不被使用。\n      if (options.withCredentials) {\n        params.credentials = 'include';\n      }\n\n      // TODO: Add ranges;\n      return params;\n    }\n\n    // in KB/s\n\n  }, {\n    key: 'cancel',\n    value: function cancel() {\n      if (this._reader) {\n        try {\n          this._reader.cancel();\n        } catch (e) {\n          // 防止failed: 200错误被打印到控制台上\n        }\n        this._reader = null;\n        this.loading = false;\n      }\n      clearTimeout(this._noDataTimer);\n      this._canceled = true;\n      if (this.abortController) {\n        this.abortController.abort();\n      }\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this._destroyed = true;\n      clearTimeout(this._retryTimer);\n      clearTimeout(this._noDataTimer);\n      this.cancel();\n      this._speed.reset();\n    }\n  }, {\n    key: 'currentSpeed',\n    get: function get() {\n      return this._speed.lastSamplingKBps;\n    }\n  }], [{\n    key: 'isSupported',\n    value: function isSupported() {\n      return !!window.fetch;\n    }\n  }, {\n    key: 'type',\n    get: function get() {\n      return 'loader';\n    }\n  }]);\n\n  return FetchLoader;\n}();\n\nexport default FetchLoader;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DevLogger = function () {\n  function DevLogger() {\n    var _this = this;\n\n    _classCallCheck(this, DevLogger);\n\n    try {\n      var matched = /xgd=(\\d)/.exec(document.cookie);\n      this._status = !!matched;\n      this._level = matched && matched[1];\n    } catch (e) {\n      this._status = false;\n    }\n\n    ['group', 'groupEnd', 'log', 'warn', 'error'].forEach(function (funName) {\n      _this[funName] = function (arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10) {\n        var _console;\n\n        if (!_this._status) return;\n        var tagName = arg1;\n        var args = [arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10].filter(function (x) {\n          return x !== undefined;\n        });\n        (_console = console)[funName].apply(_console, ['[' + tagName + ']:'].concat(_toConsumableArray(args)));\n      };\n    });\n  }\n\n  /**\n   * @return {*|boolean|boolean}\n   */\n\n\n  _createClass(DevLogger, [{\n    key: 'enable',\n    get: function get() {\n      return this._status;\n    }\n\n    /**\n     * @return {boolean}\n     */\n\n  }, {\n    key: 'long',\n    get: function get() {\n      return this._level === '2';\n    }\n  }]);\n\n  return DevLogger;\n}();\n\nexport default new DevLogger();","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ADTS = function () {\n  function ADTS() {\n    _classCallCheck(this, ADTS);\n  }\n\n  _createClass(ADTS, null, [{\n    key: \"isHeader\",\n    value: function isHeader(data, offset) {\n      // Look for ADTS header | 1111 1111 | 1111 X00X | where X can be either 0 or 1\n      // Layer bits (position 14 and 15) in header should be always 0 for ADTS\n      // More info https://wiki.multimedia.cx/index.php?title=ADTS\n      if (offset + 1 < data.length && ADTS.isHeaderPattern(data, offset)) {\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"getFrameDuration\",\n    value: function getFrameDuration(samplerate) {\n      return 1024 * 90000 / samplerate;\n    }\n  }, {\n    key: \"isHeaderPattern\",\n    value: function isHeaderPattern(data, offset) {\n      return data[offset] === 0xff && (data[offset + 1] & 0xf6) === 0xf0;\n    }\n  }, {\n    key: \"getHeaderLength\",\n    value: function getHeaderLength(data, offset) {\n      return data[offset + 1] & 0x01 ? 7 : 9;\n    }\n  }, {\n    key: \"getFullFrameLength\",\n    value: function getFullFrameLength(data, offset) {\n      return (data[offset + 3] & 0x03) << 11 | data[offset + 4] << 3 | (data[offset + 5] & 0xE0) >>> 5;\n    }\n  }, {\n    key: \"parseFrameHeader\",\n    value: function parseFrameHeader(data, offset, pts, frameIndex, frameDuration) {\n      var headerLength = void 0,\n          frameLength = void 0,\n          stamp = void 0;\n      var length = data.length;\n\n      // The protection skip bit tells us if we have 2 bytes of CRC data at the end of the ADTS header\n      headerLength = ADTS.getHeaderLength(data, offset);\n      // retrieve frame size\n      frameLength = ADTS.getFullFrameLength(data, offset);\n      frameLength -= headerLength;\n\n      if (frameLength > 0 && offset + headerLength + frameLength <= length) {\n        stamp = pts + frameIndex * frameDuration;\n        // logger.log(`AAC frame, offset/length/total/pts:${offset+headerLength}/${frameLength}/${data.byteLength}/${(stamp/90).toFixed(0)}`);\n        return { headerLength: headerLength, frameLength: frameLength, stamp: stamp };\n      }\n\n      return undefined;\n    }\n  }, {\n    key: \"appendFrame\",\n    value: function appendFrame(sampleRate, data, offset, pts, frameIndex) {\n      var frameDuration = ADTS.getFrameDuration(sampleRate);\n      var header = ADTS.parseFrameHeader(data, offset, pts, frameIndex, frameDuration);\n      if (header) {\n        var stamp = header.stamp;\n        var headerLength = header.headerLength;\n        var frameLength = header.frameLength;\n\n        // logger.log(`AAC frame, offset/length/total/pts:${offset+headerLength}/${frameLength}/${data.byteLength}/${(stamp/90).toFixed(0)}`);\n        var aacSample = {\n          unit: data.subarray(offset + headerLength, offset + headerLength + frameLength),\n          pts: stamp,\n          dts: stamp\n        };\n\n        return { sample: aacSample, length: frameLength + headerLength };\n      }\n\n      return undefined;\n    }\n  }]);\n\n  return ADTS;\n}();\n\nexport default ADTS;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Golomb = function () {\n  /**\n   * @param {Uint8Array} uint8array\n   */\n  function Golomb(uint8array) {\n    _classCallCheck(this, Golomb);\n\n    this.TAG = 'Golomb';\n    this._buffer = uint8array;\n    this._bufferIndex = 0;\n    this._totalBytes = uint8array.byteLength;\n    this._totalBits = uint8array.byteLength * 8;\n    this._currentWord = 0;\n    this._currentWordBitsLeft = 0;\n  }\n\n  _createClass(Golomb, [{\n    key: 'destroy',\n    value: function destroy() {\n      this._buffer = null;\n    }\n  }, {\n    key: '_fillCurrentWord',\n    value: function _fillCurrentWord() {\n      var bufferBytesLeft = this._totalBytes - this._bufferIndex;\n      if (bufferBytesLeft <= 0) {\n        // TODO 异常处理\n      }\n\n      var bytesRead = Math.min(4, bufferBytesLeft);\n      var word = new Uint8Array(4);\n      word.set(this._buffer.subarray(this._bufferIndex, this._bufferIndex + bytesRead));\n      this._currentWord = new DataView(word.buffer).getUint32(0);\n\n      this._bufferIndex += bytesRead;\n      this._currentWordBitsLeft = bytesRead * 8;\n    }\n\n    /**\n     * @param size\n     * @return {number|*|number}\n     */\n\n  }, {\n    key: 'readBits',\n    value: function readBits(size) {\n      var bits = Math.min(this._currentWordBitsLeft, size); // :uint\n      var valu = this._currentWord >>> 32 - bits;\n      if (size > 32) {\n        throw new Error('Cannot read more than 32 bits at a time');\n      }\n      this._currentWordBitsLeft -= bits;\n      if (this._currentWordBitsLeft > 0) {\n        this._currentWord <<= bits;\n      } else if (this._totalBytes - this._bufferIndex > 0) {\n        this._fillCurrentWord();\n      }\n\n      bits = size - bits;\n      if (bits > 0 && this._currentWordBitsLeft) {\n        return valu << bits | this.readBits(bits);\n      } else {\n        return valu;\n      }\n    }\n\n    /**\n     * @return {boolean}\n     */\n\n  }, {\n    key: 'readBool',\n    value: function readBool() {\n      return this.readBits(1) === 1;\n    }\n\n    /**\n     * @return {*|number}\n     */\n\n  }, {\n    key: 'readByte',\n    value: function readByte() {\n      return this.readBits(8);\n    }\n  }, {\n    key: '_skipLeadingZero',\n    value: function _skipLeadingZero() {\n      var zeroCount = void 0;\n      for (zeroCount = 0; zeroCount < this._currentWordBitsLeft; zeroCount++) {\n        if ((this._currentWord & 0x80000000 >>> zeroCount) !== 0) {\n          this._currentWord <<= zeroCount;\n          this._currentWordBitsLeft -= zeroCount;\n          return zeroCount;\n        }\n      }\n      this._fillCurrentWord();\n      return zeroCount + this._skipLeadingZero();\n    }\n\n    /**\n     * @return {number}\n     */\n\n  }, {\n    key: 'readUEG',\n    value: function readUEG() {\n      // unsigned exponential golomb\n      var leadingZeros = this._skipLeadingZero();\n      return this.readBits(leadingZeros + 1) - 1;\n    }\n\n    /**\n     * @return {number}\n     */\n\n  }, {\n    key: 'readSEG',\n    value: function readSEG() {\n      // signed exponential golomb\n      var value = this.readUEG();\n      if (value & 0x01) {\n        return value + 1 >>> 1;\n      } else {\n        return -1 * (value >>> 1);\n      }\n    }\n  }, {\n    key: 'readSliceType',\n    value: function readSliceType() {\n      // skip NALu type Nal unit header 8bit\n      this.readByte();\n      // discard first_mb_in_slice\n      this.readUEG();\n      // return slice_type\n      return this.readUEG();\n    }\n  }]);\n\n  return Golomb;\n}();\n\nexport default Golomb;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport Golomb from './golomb';\n\nvar SPSParser = function () {\n  function SPSParser() {\n    _classCallCheck(this, SPSParser);\n  }\n\n  _createClass(SPSParser, null, [{\n    key: '_ebsp2rbsp',\n\n    /**\n     * 0x00000300  -> 0x000000\n     * 0x00000301  -> 0x000001\n     * 0x00000302  -> 0x000002\n     * 0x00000303  -> 0x000003\n     */\n    value: function _ebsp2rbsp(uint8array) {\n      var src = uint8array;\n      var srcLength = src.byteLength;\n      var dst = new Uint8Array(srcLength);\n      var dstIdx = 0;\n\n      for (var i = 0; i < srcLength; i++) {\n        if (i >= 2) {\n          if (src[i] === 0x03 && src[i - 1] === 0x00 && src[i - 2] === 0x00) {\n            continue;\n          }\n        }\n        dst[dstIdx] = src[i];\n        dstIdx++;\n      }\n\n      return new Uint8Array(dst.buffer, 0, dstIdx);\n    }\n  }, {\n    key: 'parseSPS',\n    value: function parseSPS(uint8array) {\n      var rbsp = SPSParser._ebsp2rbsp(uint8array);\n      var gb = new Golomb(rbsp);\n\n      gb.readByte();\n      var profileIdc = gb.readByte();\n      gb.readByte();\n      var levelIdc = gb.readByte();\n      gb.readUEG();\n\n      var profile_string = SPSParser.getProfileString(profileIdc);\n      var level_string = SPSParser.getLevelString(levelIdc);\n      var chroma_format_idc = 1;\n      var chroma_format = 420;\n      var chroma_format_table = [0, 420, 422, 444];\n      var bit_depth = 8;\n\n      if (profileIdc === 100 || profileIdc === 110 || profileIdc === 122 || profileIdc === 244 || profileIdc === 44 || profileIdc === 83 || profileIdc === 86 || profileIdc === 118 || profileIdc === 128 || profileIdc === 138 || profileIdc === 144) {\n        chroma_format_idc = gb.readUEG();\n        if (chroma_format_idc === 3) {\n          gb.readBits(1);\n        }\n        if (chroma_format_idc <= 3) {\n          chroma_format = chroma_format_table[chroma_format_idc];\n        }\n\n        bit_depth = gb.readUEG() + 8;\n        gb.readUEG();\n        gb.readBits(1);\n        if (gb.readBool()) {\n          var scaling_list_count = chroma_format_idc !== 3 ? 8 : 12;\n          for (var i = 0; i < scaling_list_count; i++) {\n            if (gb.readBool()) {\n              if (i < 6) {\n                SPSParser._skipScalingList(gb, 16);\n              } else {\n                SPSParser._skipScalingList(gb, 64);\n              }\n            }\n          }\n        }\n      }\n      gb.readUEG();\n      var pic_order_cnt_type = gb.readUEG();\n      if (pic_order_cnt_type === 0) {\n        gb.readUEG();\n      } else if (pic_order_cnt_type === 1) {\n        gb.readBits(1);\n        gb.readSEG();\n        gb.readSEG();\n        var num_ref_frames_in_pic_order_cnt_cycle = gb.readUEG();\n        for (var _i = 0; _i < num_ref_frames_in_pic_order_cnt_cycle; _i++) {\n          gb.readSEG();\n        }\n      }\n      gb.readUEG();\n      gb.readBits(1);\n\n      var pic_width_in_mbs_minus1 = gb.readUEG();\n      var pic_height_in_map_units_minus1 = gb.readUEG();\n\n      var frame_mbs_only_flag = gb.readBits(1);\n      if (frame_mbs_only_flag === 0) {\n        gb.readBits(1);\n      }\n      gb.readBits(1);\n\n      var frame_crop_left_offset = 0;\n      var frame_crop_right_offset = 0;\n      var frame_crop_top_offset = 0;\n      var frame_crop_bottom_offset = 0;\n\n      var frame_cropping_flag = gb.readBool();\n      if (frame_cropping_flag) {\n        frame_crop_left_offset = gb.readUEG();\n        frame_crop_right_offset = gb.readUEG();\n        frame_crop_top_offset = gb.readUEG();\n        frame_crop_bottom_offset = gb.readUEG();\n      }\n\n      var par_width = 1;var par_height = 1;\n      var fps = 0;var fps_fixed = true;var fps_num = 0;var fps_den = 0;\n\n      var vui_parameters_present_flag = gb.readBool();\n      if (vui_parameters_present_flag) {\n        if (gb.readBool()) {\n          // aspect_ratio_info_present_flag\n          var aspect_ratio_idc = gb.readByte();\n          var par_w_table = [1, 12, 10, 16, 40, 24, 20, 32, 80, 18, 15, 64, 160, 4, 3, 2];\n          var par_h_table = [1, 11, 11, 11, 33, 11, 11, 11, 33, 11, 11, 33, 99, 3, 2, 1];\n\n          if (aspect_ratio_idc > 0 && aspect_ratio_idc < 16) {\n            par_width = par_w_table[aspect_ratio_idc - 1];\n            par_height = par_h_table[aspect_ratio_idc - 1];\n          } else if (aspect_ratio_idc === 255) {\n            par_width = gb.readByte() << 8 | gb.readByte();\n            par_height = gb.readByte() << 8 | gb.readByte();\n          }\n        }\n\n        if (gb.readBool()) {\n          gb.readBool();\n        }\n        if (gb.readBool()) {\n          gb.readBits(4);\n          if (gb.readBool()) {\n            gb.readBits(24);\n          }\n        }\n        if (gb.readBool()) {\n          gb.readUEG();\n          gb.readUEG();\n        }\n        if (gb.readBool()) {\n          var num_units_in_tick = gb.readBits(32);\n          var time_scale = gb.readBits(32);\n          fps_fixed = gb.readBool();\n\n          fps_num = time_scale;\n          fps_den = num_units_in_tick * 2;\n          fps = fps_num / fps_den;\n        }\n      }\n\n      var parScale = 1;\n      if (par_width !== 1 || par_height !== 1) {\n        parScale = par_width / par_height;\n      }\n\n      var crop_unit_x = 0;var crop_unit_y = 0;\n      if (chroma_format_idc === 0) {\n        crop_unit_x = 1;\n        crop_unit_y = 2 - frame_mbs_only_flag;\n      } else {\n        var sub_wc = chroma_format_idc === 3 ? 1 : 2;\n        var sub_hc = chroma_format_idc === 1 ? 2 : 1;\n        crop_unit_x = sub_wc;\n        crop_unit_y = sub_hc * (2 - frame_mbs_only_flag);\n      }\n\n      var codec_width = (pic_width_in_mbs_minus1 + 1) * 16;\n      var codec_height = (2 - frame_mbs_only_flag) * ((pic_height_in_map_units_minus1 + 1) * 16);\n\n      codec_width -= (frame_crop_left_offset + frame_crop_right_offset) * crop_unit_x;\n      codec_height -= (frame_crop_top_offset + frame_crop_bottom_offset) * crop_unit_y;\n\n      var present_width = Math.ceil(codec_width * parScale);\n\n      gb.destroy();\n      gb = null;\n\n      return {\n        profile_string: profile_string,\n        level_string: level_string,\n        bit_depth: bit_depth,\n        chroma_format: chroma_format,\n        chroma_format_string: SPSParser.getChromaFormatString(chroma_format),\n\n        frame_rate: {\n          fixed: fps_fixed,\n          fps: fps,\n          fps_den: fps_den,\n          fps_num: fps_num\n        },\n\n        par_ratio: {\n          width: par_width,\n          height: par_height\n        },\n\n        codec_size: {\n          width: codec_width,\n          height: codec_height\n        },\n\n        present_size: {\n          width: present_width,\n          height: codec_height\n        }\n      };\n    }\n  }, {\n    key: '_skipScalingList',\n    value: function _skipScalingList(gb, count) {\n      var lastScale = 8;\n      var nextScale = 8;\n      var deltaScale = 0;\n      for (var i = 0; i < count; i++) {\n        if (nextScale !== 0) {\n          deltaScale = gb.readSEG();\n          nextScale = (lastScale + deltaScale + 256) % 256;\n        }\n        lastScale = nextScale === 0 ? lastScale : nextScale;\n      }\n    }\n  }, {\n    key: 'getProfileString',\n    value: function getProfileString(profileIdc) {\n      switch (profileIdc) {\n        case 66:\n          return 'Baseline';\n        case 77:\n          return 'Main';\n        case 88:\n          return 'Extended';\n        case 100:\n          return 'High';\n        case 110:\n          return 'High10';\n        case 122:\n          return 'High422';\n        case 244:\n          return 'High444';\n        default:\n          return 'Unknown';\n      }\n    }\n  }, {\n    key: 'getLevelString',\n    value: function getLevelString(levelIdc) {\n      return (levelIdc / 10).toFixed(1);\n    }\n  }, {\n    key: 'getChromaFormatString',\n    value: function getChromaFormatString(chroma) {\n      switch (chroma) {\n        case 420:\n          return '4:2:0';\n        case 422:\n          return '4:2:2';\n        case 444:\n          return '4:4:4';\n        default:\n          return 'Unknown';\n      }\n    }\n  }, {\n    key: 'toVideoMeta',\n    value: function toVideoMeta(spsConfig) {\n      var meta = {};\n      if (spsConfig && spsConfig.codec_size) {\n        meta.codecWidth = spsConfig.codec_size.width;\n        meta.codecHeight = spsConfig.codec_size.height;\n        meta.presentWidth = spsConfig.present_size.width;\n        meta.presentHeight = spsConfig.present_size.height;\n      }\n\n      meta.profile = spsConfig.profile_string;\n      meta.level = spsConfig.level_string;\n      meta.bitDepth = spsConfig.bit_depth;\n      meta.chromaFormat = spsConfig.chroma_format;\n\n      meta.parRatio = {\n        width: spsConfig.par_ratio.width,\n        height: spsConfig.par_ratio.height\n      };\n\n      meta.frameRate = spsConfig.frame_rate;\n\n      var fpsDen = meta.frameRate.fps_den;\n      var fpsNum = meta.frameRate.fps_num;\n      meta.refSampleDuration = Math.floor(meta.timescale * (fpsDen / fpsNum));\n      return meta;\n    }\n  }]);\n\n  return SPSParser;\n}();\n\nexport default SPSParser;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar RBSP = function () {\n  function RBSP() {\n    _classCallCheck(this, RBSP);\n  }\n\n  _createClass(RBSP, null, [{\n    key: \"EBSP2RBSP\",\n\n    /**\n     * convert EBSP to RBSP\n     * @param data {Uint8Array}\n     * @returns {Uint8Array}\n     * @constructor\n     */\n    value: function EBSP2RBSP(data) {\n      return data.filter(function (el, idx) {\n        if (idx < 2) {\n          return true;\n        } else {\n          return !(data[idx - 2] === 0 && data[idx - 1] === 0 && el === 3);\n        }\n      });\n    }\n\n    /**\n     * EBSP = SODB + '10000000'\n     * @param data {Uint8Array}\n     * @constructor\n     */\n\n  }, {\n    key: \"EBSP2SODB\",\n    value: function EBSP2SODB(data) {\n      var lastByte = data[data.byteLength - 1];\n      if (lastByte && lastByte === 128) {\n        return data.slice(0, data.byteLength - 1);\n      }\n\n      return data;\n    }\n  }]);\n\n  return RBSP;\n}();\n\nexport default RBSP;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport RBSP from './rbsp';\n\nvar u8aToString = function u8aToString(data) {\n  var result = '';\n  for (var i = 0; i < data.byteLength; i++) {\n    result += String.fromCharCode(data[i]);\n  }\n  return result;\n};\n\nvar SEIParser = function () {\n  function SEIParser() {\n    _classCallCheck(this, SEIParser);\n  }\n\n  _createClass(SEIParser, null, [{\n    key: '_resolveNalu',\n    value: function _resolveNalu(data) {\n      if (data.length >= 1) {\n        return RBSP.EBSP2SODB(RBSP.EBSP2RBSP(data.slice(1)));\n      }\n      return null;\n    }\n    /**\n     *\n     * @param data {Uint8Array}\n     */\n\n  }, {\n    key: 'parse',\n    value: function parse(data) {\n      var sodb = SEIParser._resolveNalu(data);\n\n      var _SEIParser$switchPayl = SEIParser.switchPayloadType(sodb),\n          payloadType = _SEIParser$switchPayl.payloadType,\n          offset = _SEIParser$switchPayl.offset;\n\n      var content = sodb.slice(offset);\n\n      switch (payloadType) {\n        case 5:\n          return SEIParser.user_data_unregistered(content);\n        default:\n          return {\n            code: payloadType,\n            content: content\n          };\n      }\n    }\n\n    /**\n     *\n     * @param data\n     * @returns {{payloadType: number, offset: number}}\n     */\n\n  }, {\n    key: 'switchPayloadType',\n    value: function switchPayloadType(data) {\n      var dv = new DataView(data.buffer);\n      var payloadType = 0;\n      var offset = 0;\n      while (dv.getUint8(offset) === 255) {\n        offset++;\n        payloadType += 255;\n      }\n      payloadType += dv.getUint8(offset++);\n\n      return {\n        payloadType: payloadType,\n        offset: offset\n      };\n    }\n\n    /**\n     *\n     * @param data {Uint8Array}\n     * @return {{ payloadLength: number, offset: number }}\n     */\n\n  }, {\n    key: 'getPayloadLength',\n    value: function getPayloadLength(data) {\n      var dv = new DataView(data.buffer);\n\n      var payloadLength = 0;\n      var offset = 0;\n      while (dv.getUint8(offset) === 255) {\n        offset++;\n        payloadLength += 255;\n      }\n      payloadLength += dv.getUint8(offset++);\n\n      return {\n        payloadLength: payloadLength,\n        offset: offset\n      };\n    }\n\n    /**\n     * resolve 0x05 user data unregistered\n     * @param data {Uint8Array}\n     */\n    // eslint-disable-next-line camelcase\n\n  }, {\n    key: 'user_data_unregistered',\n    value: function user_data_unregistered(data) {\n      var _SEIParser$getPayload = SEIParser.getPayloadLength(data),\n          payloadLength = _SEIParser$getPayload.payloadLength,\n          offset = _SEIParser$getPayload.offset;\n\n      if (payloadLength < 16) {\n        return {\n          uuid: '',\n          content: null\n        };\n      }\n      var payload = data.slice(offset);\n\n      var uuid = u8aToString(payload.slice(0, 16));\n      var content = u8aToString(payload.slice(16, payloadLength));\n\n      return {\n        code: 5, // for user data unregistered\n        uuid: uuid,\n        content: content\n      };\n    }\n  }]);\n\n  return SEIParser;\n}();\n\nexport default SEIParser;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport SpsParser from './sps';\nimport SEIParser from './sei';\n\nvar Nalunit = function () {\n  function Nalunit() {\n    _classCallCheck(this, Nalunit);\n  }\n\n  _createClass(Nalunit, null, [{\n    key: 'getNalunits',\n\n    // https://en.wikipedia.org/wiki/Network_Abstraction_Layer\n    value: function getNalunits(buffer) {\n      if (buffer.length - buffer.position < 4) {\n        return [];\n      }\n\n      var buf = buffer.dataview;\n      var position = buffer.position;\n      // 0x001 || 0x0001\n      if (buf.getInt32(position) === 1 || buf.getInt16(position) === 0 && buf.getInt8(position + 2) === 1) {\n        return Nalunit.getAnnexbNals(buffer);\n      } else {\n        return Nalunit.getAvccNals(buffer);\n      }\n    }\n  }, {\n    key: 'getAnnexbNals',\n    value: function getAnnexbNals(buffer) {\n      var nals = [];\n      var position = Nalunit.getHeaderPositionAnnexB(buffer);\n      var start = position.pos;\n      var end = start;\n      while (start < buffer.length - 4) {\n        var header = buffer.buffer.slice(start, start + position.headerLength);\n        if (position.pos === buffer.position) {\n          buffer.skip(position.headerLength);\n        }\n        position = Nalunit.getHeaderPositionAnnexB(buffer);\n        end = position.pos;\n        var body = new Uint8Array(buffer.buffer.slice(start + header.byteLength, end));\n        var unit = { header: header, body: body };\n        Nalunit.analyseNal(unit);\n        if (unit.type <= 9 && unit.type !== 0) {\n          nals.push(unit);\n        }\n        buffer.skip(end - buffer.position);\n        start = end;\n      }\n      return nals;\n    }\n  }, {\n    key: 'getAvccNals',\n    value: function getAvccNals(buffer) {\n      // buffer.buffer = RBSP.EBSP2RBSP(new Uint8Array(buffer.buffer)).buffer;\n      // buffer.dataview = new DataView(buffer.buffer)\n      // buffer.dataview.position = 0;\n      var nals = [];\n      while (buffer.position < buffer.length - 4) {\n        var length = buffer.dataview.getInt32(buffer.dataview.position);\n        if (buffer.length - buffer.position >= length) {\n          var header = buffer.buffer.slice(buffer.position, buffer.position + 4);\n          buffer.skip(4);\n          var body = new Uint8Array(buffer.buffer.slice(buffer.position, buffer.position + length));\n          buffer.skip(length);\n          var unit = { header: header, body: body };\n          Nalunit.analyseNal(unit);\n          if (unit.type <= 9 && unit.type !== 0) {\n            nals.push(unit);\n          }\n        } else {\n          break;\n        }\n      }\n      return nals;\n    }\n\n    // * ISO-14496-10 7.3.1\n    // *  forbidden_zero_bit  1bit\n    // *  nal_ref_idc  2bit\n    // *  nal_unit_type 5bit\n\n  }, {\n    key: 'analyseNal',\n    value: function analyseNal(unit) {\n      var type = unit.body[0] & 0x1f;\n      unit.type = type;\n      switch (type) {\n        case 1:\n          // NDR\n          unit.ndr = true;\n          break;\n        case 5:\n          // IDR\n          unit.idr = true;\n          break;\n        case 6:\n          // SEI\n          try {\n            unit.sei = SEIParser.parse(unit.body);\n          } catch (e) {}\n          break;\n        case 7:\n          // SPS\n          unit.sps = SpsParser.parseSPS(unit.body);\n          break;\n        case 8:\n          // PPS\n          unit.pps = true;\n          break;\n        case 9:\n          // AUD\n          break;\n        default:\n          break;\n      }\n    }\n  }, {\n    key: 'getHeaderPositionAnnexB',\n    value: function getHeaderPositionAnnexB(buffer) {\n      // seperate\n      var pos = buffer.position;\n      var headerLength = 0;\n      var bufferLen = buffer.length;\n      while (headerLength !== 3 && headerLength !== 4 && pos < bufferLen - 4) {\n        if (buffer.dataview.getInt16(pos) === 0) {\n          if (buffer.dataview.getInt16(pos + 2) === 1) {\n            // 0x000001\n            headerLength = 4;\n          } else if (buffer.dataview.getInt8(pos + 2) === 1) {\n            headerLength = 3;\n          } else {\n            pos++;\n          }\n        } else {\n          pos++;\n        }\n      }\n\n      if (pos === bufferLen - 4) {\n        if (buffer.dataview.getInt16(pos) === 0) {\n          if (buffer.dataview.getInt16(pos + 2) === 1) {\n            // 0x000001\n            headerLength = 4;\n          } else {\n            pos = bufferLen;\n          }\n        } else {\n          pos++;\n          if (buffer.dataview.getInt16(pos) === 0 && buffer.dataview.getInt8(pos) === 1) {\n            // 0x0000001\n            headerLength = 3;\n          } else {\n            pos = bufferLen;\n          }\n        }\n      }\n      return { pos: pos, headerLength: headerLength };\n    }\n\n    // 组装AvcDecoderConfigurationRecord\n    // *  configurationVerison = 1  uint(8)\n    // *  avcProfileIndication      uint(8)\n    // *  profile_compatibility     uint(8)\n    // *  avcLevelIndication        uint(8)\n    // *  reserved   `111111`       bit(6)\n    // *  lengthSizeMinusOne        uint(2)\n    // *  reserved   `111`          bit(3)\n    // *  numOfSPS                  uint(5)\n    // *  for(numOfSPS)\n    // *    spsLength               uint(16)\n    // *    spsNALUnit              spsLength个字节\n    // *  numOfPPS                  uint(8)\n    // *  for(numOfPPS)\n    // *     ppsLength              uint(16)\n    // *     ppsNALUnit             ppsLength个字节\n\n  }, {\n    key: 'getAvcc',\n    value: function getAvcc(sps, pps) {\n      var ret = new Uint8Array(sps.byteLength + pps.byteLength + 11);\n      ret[0] = 0x01;\n      ret[1] = sps[1];\n      ret[2] = sps[2];\n      ret[3] = sps[3];\n      ret[4] = 255;\n      ret[5] = 225; // 11100001\n\n      var offset = 6;\n\n      ret.set(new Uint8Array([sps.byteLength >>> 8 & 0xff, sps.byteLength & 0xff]), offset);\n      offset += 2;\n      ret.set(sps, offset);\n      offset += sps.byteLength;\n\n      ret[offset] = 1;\n      offset++;\n\n      ret.set(new Uint8Array([pps.byteLength >>> 8 & 0xff, pps.byteLength & 0xff]), offset);\n      offset += 2;\n      ret.set(pps, offset);\n      return ret;\n    }\n  }]);\n\n  return Nalunit;\n}();\n\nexport default Nalunit;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Golomb = function () {\n  /**\n   * @param {Uint8Array} uint8array\n   */\n  function Golomb(uint8array) {\n    _classCallCheck(this, Golomb);\n\n    this.TAG = 'Golomb';\n    this._buffer = uint8array;\n    this._bufferIndex = 0;\n    this._totalBytes = uint8array.byteLength;\n    this._totalBits = uint8array.byteLength * 8;\n    this._currentWord = 0;\n    this._currentWordBitsLeft = 0;\n  }\n\n  _createClass(Golomb, [{\n    key: 'destroy',\n    value: function destroy() {\n      this._buffer = null;\n    }\n  }, {\n    key: '_fillCurrentWord',\n    value: function _fillCurrentWord() {\n      var bufferBytesLeft = this._totalBytes - this._bufferIndex;\n      if (bufferBytesLeft <= 0) {\n        // TODO 异常处理\n      }\n\n      var bytesRead = Math.min(4, bufferBytesLeft);\n      var word = new Uint8Array(4);\n      word.set(this._buffer.subarray(this._bufferIndex, this._bufferIndex + bytesRead));\n      this._currentWord = new DataView(word.buffer).getUint32(0);\n\n      this._bufferIndex += bytesRead;\n      this._currentWordBitsLeft = bytesRead * 8;\n    }\n\n    /**\n     * @param size\n     * @return {number|*|number}\n     */\n\n  }, {\n    key: 'readBits',\n    value: function readBits(size) {\n      var bits = Math.min(this._currentWordBitsLeft, size); // :uint\n      var valu = this._currentWord >>> 32 - bits;\n      if (size > 32) {\n        throw new Error('Cannot read more than 32 bits at a time');\n      }\n      this._currentWordBitsLeft -= bits;\n      if (this._currentWordBitsLeft > 0) {\n        this._currentWord <<= bits;\n      } else if (this._totalBytes - this._bufferIndex > 0) {\n        this._fillCurrentWord();\n      }\n\n      bits = size - bits;\n      if (bits > 0 && this._currentWordBitsLeft) {\n        return valu << bits | this.readBits(bits);\n      } else {\n        return valu;\n      }\n    }\n\n    /**\n     * @return {boolean}\n     */\n\n  }, {\n    key: 'readBool',\n    value: function readBool() {\n      return this.readBits(1) === 1;\n    }\n\n    /**\n     * @return {*|number}\n     */\n\n  }, {\n    key: 'readByte',\n    value: function readByte() {\n      return this.readBits(8);\n    }\n  }, {\n    key: '_skipLeadingZero',\n    value: function _skipLeadingZero() {\n      var zeroCount = void 0;\n      for (zeroCount = 0; zeroCount < this._currentWordBitsLeft; zeroCount++) {\n        if ((this._currentWord & 0x80000000 >>> zeroCount) !== 0) {\n          this._currentWord <<= zeroCount;\n          this._currentWordBitsLeft -= zeroCount;\n          return zeroCount;\n        }\n      }\n      this._fillCurrentWord();\n      return zeroCount + this._skipLeadingZero();\n    }\n\n    /**\n     * @return {number}\n     */\n\n  }, {\n    key: 'readUEG',\n    value: function readUEG() {\n      // unsigned exponential golomb\n      var leadingZeros = this._skipLeadingZero();\n      return this.readBits(leadingZeros + 1) - 1;\n    }\n\n    /**\n     * @return {number}\n     */\n\n  }, {\n    key: 'readSEG',\n    value: function readSEG() {\n      // signed exponential golomb\n      var value = this.readUEG();\n      if (value & 0x01) {\n        return value + 1 >>> 1;\n      } else {\n        return -1 * (value >>> 1);\n      }\n    }\n  }, {\n    key: 'readSliceType',\n    value: function readSliceType() {\n      // skip NALu type Nal unit header 8bit\n      this.readByte();\n      // discard first_mb_in_slice\n      this.readUEG();\n      // return slice_type\n      return this.readUEG();\n    }\n  }]);\n\n  return Golomb;\n}();\n\nexport default Golomb;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport Golomb from './golomb';\n\nvar SPSParser = function () {\n  function SPSParser() {\n    _classCallCheck(this, SPSParser);\n  }\n\n  _createClass(SPSParser, null, [{\n    key: '_ebsp2rbsp',\n\n    /**\n     *\n     * @param {Uint8Array} uint8array\n     * @return {Uint8Array}\n     */\n    value: function _ebsp2rbsp(uint8array) {\n      var src = uint8array;\n      var srcLength = src.byteLength;\n      var dst = new Uint8Array(srcLength);\n      var dstIdx = 0;\n\n      for (var i = 0; i < srcLength; i++) {\n        if (i >= 2) {\n          if (src[i] === 0x03 && src[i - 1] === 0x00 && src[i - 2] === 0x00) {\n            continue;\n          }\n        }\n        dst[dstIdx] = src[i];\n        dstIdx++;\n      }\n\n      return new Uint8Array(dst.buffer, 0, dstIdx);\n    }\n\n    /**\n     * @param {Uint8Array} uint8array\n     * @return {{width: *, general_profile_idc: number, chromaFormatIdc: *, general_level_idc: number, general_tier_flag: number, bitDepthLumaMinus8: (*|number), bitDepthChromaMinus8: (*|number), general_profile_space: number, height: *}}\n     */\n\n  }, {\n    key: 'parseSPS',\n    value: function parseSPS(uint8array) {\n      var rbsp = SPSParser._ebsp2rbsp(uint8array);\n      var gb = new Golomb(rbsp);\n\n      var vpsId = 0;\n      var maxSubLayersMinus1 = 0;\n      var tINf = 0;\n      var spsId = 0;\n      var separate_colour_plane_flag = 0;\n      var chromaFormatIdc = 0;\n      var width = 0;\n      var height = 0;\n      var conf_win_left_offset = 0;\n      var conf_win_right_offset = 0;\n      var conf_win_top_offset = 0;\n      var conf_win_bottom_offset = 0;\n      var conformanceWindowFlag = 0;\n      var bitDepthLumaMinus8 = 0;\n      var bitDepthChromaMinus8 = 0;\n      var sub_width_c = 0;\n      var sub_height_c = 0;\n      var profileTierLevel = {};\n\n      gb.readByte(); // NAL header\n      gb.readByte();\n\n      vpsId = gb.readBits(4); // vps_id\n      maxSubLayersMinus1 = gb.readBits(3); // max_sub_layers_minus1\n      tINf = gb.readBits(1); // temporal_id_nesting_flag\n\n      profileTierLevel = SPSParser._readProfileTierLevel(gb, maxSubLayersMinus1);\n\n      spsId = gb.readUEG(); // sps id\n      chromaFormatIdc = gb.readUEG();\n      if (chromaFormatIdc === 3) {\n        separate_colour_plane_flag = gb.readBits(1); // separate_colour_plane_flag\n      }\n\n      width = gb.readUEG(); // pic_width_in_luma_samples\n      height = gb.readUEG(); // pic_height_in_luma_samples\n\n      conformanceWindowFlag = gb.readBits(1);\n      if (conformanceWindowFlag === 1) {\n        conf_win_left_offset = gb.readUEG(); // conf_win_left_offset\n        conf_win_right_offset = gb.readUEG(); // conf_win_right_offset\n        conf_win_top_offset = gb.readUEG(); // conf_win_top_offset\n        conf_win_bottom_offset = gb.readUEG(); // conf_win_bottom_offset\n      }\n\n      bitDepthLumaMinus8 = gb.readUEG(); // bit_depth_luma_minus8\n      bitDepthChromaMinus8 = gb.readUEG(); // bit_depth_chroma_minus8\n\n      if (conformanceWindowFlag === 1) {\n        sub_width_c = (chromaFormatIdc === 1 || chromaFormatIdc === 2) && separate_colour_plane_flag === 0 ? 2 : 1;\n        sub_height_c = chromaFormatIdc === 1 && separate_colour_plane_flag === 0 ? 2 : 1;\n        width -= sub_width_c * conf_win_right_offset + sub_width_c * conf_win_left_offset;\n        height -= sub_height_c * conf_win_bottom_offset + sub_height_c * conf_win_top_offset;\n      }\n\n      gb.destroy();\n      gb = null;\n\n      return { width: width,\n        height: height,\n        general_profile_space: profileTierLevel.general_profile_space,\n        general_tier_flag: profileTierLevel.general_tier_flag,\n        general_profile_idc: profileTierLevel.general_profile_idc,\n        general_level_idc: profileTierLevel.general_level_idc,\n        chromaFormatIdc: chromaFormatIdc,\n        bitDepthLumaMinus8: bitDepthLumaMinus8,\n        bitDepthChromaMinus8: bitDepthChromaMinus8 };\n    }\n\n    // static parseSPS (uint8array) {\n    //   let rbsp = SPSParser._ebsp2rbsp(uint8array)\n    //   let gb = new Golomb(rbsp)\n    //\n    //   gb.readByte()\n    //   let profileIdc = gb.readByte()\n    //   gb.readByte()\n    //   let levelIdc = gb.readByte()\n    //   gb.readUEG()\n    //\n    //   let profile_string = SPSParser.getProfileString(profileIdc)\n    //   let level_string = SPSParser.getLevelString(levelIdc)\n    //   let chroma_format_idc = 1\n    //   let chroma_format = 420\n    //   let chroma_format_table = [0, 420, 422, 444]\n    //   let bit_depth = 8\n    //\n    //   if (profileIdc === 100 || profileIdc === 110 || profileIdc === 122 ||\n    //     profileIdc === 244 || profileIdc === 44 || profileIdc === 83 ||\n    //     profileIdc === 86 || profileIdc === 118 || profileIdc === 128 ||\n    //     profileIdc === 138 || profileIdc === 144) {\n    //     chroma_format_idc = gb.readUEG()\n    //     if (chroma_format_idc === 3) {\n    //       gb.readBits(1)\n    //     }\n    //     if (chroma_format_idc <= 3) {\n    //       chroma_format = chroma_format_table[chroma_format_idc]\n    //     }\n    //\n    //     bit_depth = gb.readUEG() + 8\n    //     gb.readUEG()\n    //     gb.readBits(1)\n    //     if (gb.readBool()) {\n    //       let scaling_list_count = (chroma_format_idc !== 3) ? 8 : 12\n    //       for (let i = 0; i < scaling_list_count; i++) {\n    //         if (gb.readBool()) {\n    //           if (i < 6) {\n    //             SPSParser._skipScalingList(gb, 16)\n    //           } else {\n    //             SPSParser._skipScalingList(gb, 64)\n    //           }\n    //         }\n    //       }\n    //     }\n    //   }\n    //   gb.readUEG()\n    //   let pic_order_cnt_type = gb.readUEG()\n    //   if (pic_order_cnt_type === 0) {\n    //     gb.readUEG()\n    //   } else if (pic_order_cnt_type === 1) {\n    //     gb.readBits(1)\n    //     gb.readSEG()\n    //     gb.readSEG()\n    //     let num_ref_frames_in_pic_order_cnt_cycle = gb.readUEG()\n    //     for (let i = 0; i < num_ref_frames_in_pic_order_cnt_cycle; i++) {\n    //       gb.readSEG()\n    //     }\n    //   }\n    //   gb.readUEG()\n    //   gb.readBits(1)\n    //\n    //   let pic_width_in_mbs_minus1 = gb.readUEG()\n    //   let pic_height_in_map_units_minus1 = gb.readUEG()\n    //\n    //   let frame_mbs_only_flag = gb.readBits(1)\n    //   if (frame_mbs_only_flag === 0) {\n    //     gb.readBits(1)\n    //   }\n    //   gb.readBits(1)\n    //\n    //   let frame_crop_left_offset = 0\n    //   let frame_crop_right_offset = 0\n    //   let frame_crop_top_offset = 0\n    //   let frame_crop_bottom_offset = 0\n    //\n    //   let frame_cropping_flag = gb.readBool()\n    //   if (frame_cropping_flag) {\n    //     frame_crop_left_offset = gb.readUEG()\n    //     frame_crop_right_offset = gb.readUEG()\n    //     frame_crop_top_offset = gb.readUEG()\n    //     frame_crop_bottom_offset = gb.readUEG()\n    //   }\n    //\n    //   let par_width = 1, par_height = 1\n    //   let fps = 0, fps_fixed = true, fps_num = 0, fps_den = 0\n    //\n    //   let vui_parameters_present_flag = gb.readBool()\n    //   if (vui_parameters_present_flag) {\n    //     if (gb.readBool()) { // aspect_ratio_info_present_flag\n    //       let aspect_ratio_idc = gb.readByte()\n    //       let par_w_table = [1, 12, 10, 16, 40, 24, 20, 32, 80, 18, 15, 64, 160, 4, 3, 2]\n    //       let par_h_table = [1, 11, 11, 11, 33, 11, 11, 11, 33, 11, 11, 33, 99, 3, 2, 1]\n    //\n    //       if (aspect_ratio_idc > 0 && aspect_ratio_idc < 16) {\n    //         par_width = par_w_table[aspect_ratio_idc - 1]\n    //         par_height = par_h_table[aspect_ratio_idc - 1]\n    //       } else if (aspect_ratio_idc === 255) {\n    //         par_width = gb.readByte() << 8 | gb.readByte()\n    //         par_height = gb.readByte() << 8 | gb.readByte()\n    //       }\n    //     }\n    //\n    //     if (gb.readBool()) {\n    //       gb.readBool()\n    //     }\n    //     if (gb.readBool()) {\n    //       gb.readBits(4)\n    //       if (gb.readBool()) {\n    //         gb.readBits(24)\n    //       }\n    //     }\n    //     if (gb.readBool()) {\n    //       gb.readUEG()\n    //       gb.readUEG()\n    //     }\n    //     if (gb.readBool()) {\n    //       let num_units_in_tick = gb.readBits(32)\n    //       let time_scale = gb.readBits(32)\n    //       fps_fixed = gb.readBool()\n    //\n    //       fps_num = time_scale\n    //       fps_den = num_units_in_tick * 2\n    //       fps = fps_num / fps_den\n    //     }\n    //   }\n    //\n    //   let parScale = 1\n    //   if (par_width !== 1 || par_height !== 1) {\n    //     parScale = par_width / par_height\n    //   }\n    //\n    //   let crop_unit_x = 0, crop_unit_y = 0\n    //   if (chroma_format_idc === 0) {\n    //     crop_unit_x = 1\n    //     crop_unit_y = 2 - frame_mbs_only_flag\n    //   } else {\n    //     let sub_wc = (chroma_format_idc === 3) ? 1 : 2\n    //     let sub_hc = (chroma_format_idc === 1) ? 2 : 1\n    //     crop_unit_x = sub_wc\n    //     crop_unit_y = sub_hc * (2 - frame_mbs_only_flag)\n    //   }\n    //\n    //   let codec_width = (pic_width_in_mbs_minus1 + 1) * 16\n    //   let codec_height = (2 - frame_mbs_only_flag) * ((pic_height_in_map_units_minus1 + 1) * 16)\n    //\n    //   codec_width -= (frame_crop_left_offset + frame_crop_right_offset) * crop_unit_x\n    //   codec_height -= (frame_crop_top_offset + frame_crop_bottom_offset) * crop_unit_y\n    //\n    //   let present_width = Math.ceil(codec_width * parScale)\n    //\n    //   gb.destroy()\n    //   gb = null\n    //\n    //   return {\n    //     profile_string: profile_string,\n    //     level_string: level_string,\n    //     bit_depth: bit_depth,\n    //     chroma_format: chroma_format,\n    //     chroma_format_string: SPSParser.getChromaFormatString(chroma_format),\n    //\n    //     frame_rate: {\n    //       fixed: fps_fixed,\n    //       fps: fps,\n    //       fps_den: fps_den,\n    //       fps_num: fps_num\n    //     },\n    //\n    //     par_ratio: {\n    //       width: par_width,\n    //       height: par_height\n    //     },\n    //\n    //     codec_size: {\n    //       width: codec_width,\n    //       height: codec_height\n    //     },\n    //\n    //     present_size: {\n    //       width: present_width,\n    //       height: codec_height\n    //     }\n    //   }\n    // }\n    /**\n     * @param gb\n     * @param maxSubLayersMinus1\n     * @return {{general_profile_idc: (*|number), general_level_idc: (*|number), general_tier_flag: (*|number), general_profile_space: (*|number)}}\n     */\n\n  }, {\n    key: '_readProfileTierLevel',\n    value: function _readProfileTierLevel(gb, maxSubLayersMinus1) {\n      var general_profile_space = 0;\n      var general_tier_flag = 0;\n      var general_profile_idc = 0;\n      var general_level_idc = 0;\n      general_profile_space = gb.readBits(2) || 0; // profile_space\n      general_tier_flag = gb.readBits(1) || 0; // tierFlag\n      general_profile_idc = gb.readBits(5) || 0; // profileIdc\n\n      gb.readBits(16); // some 32bits\n      gb.readBits(16);\n\n      gb.readBits(1); // progressiveSourceFlag\n      gb.readBits(1); // interlacedSourceFlag\n      gb.readBits(1); // nonPackedConstraintFlag\n      gb.readBits(1); // frameOnlyConstraintFlag\n\n      gb.readBits(16); // reserved zero bits\n      gb.readBits(16);\n      gb.readBits(12);\n\n      general_level_idc = gb.readBits(8) || 0; // level_idc\n\n      var subLayerProfilePresentFlag = [];\n      var subLayerLevelPresentFlag = [];\n      for (var j = 0; j < maxSubLayersMinus1; j++) {\n        subLayerProfilePresentFlag[j] = gb.readBits(1);\n        subLayerLevelPresentFlag[j] = gb.readBits(1);\n      }\n\n      if (maxSubLayersMinus1 > 0) {\n        gb.readBits((8 - maxSubLayersMinus1) * 2);\n      }\n\n      for (var i = 0; i < maxSubLayersMinus1; i++) {\n        if (subLayerProfilePresentFlag[i] !== 0) {\n          gb.readBits(2);\n          gb.readBits(1);\n          gb.readBits(5);\n\n          gb.readBits(16);\n          gb.readBits(16);\n\n          gb.readBits(4);\n\n          gb.readBits(16);\n          gb.readBits(16);\n          gb.readBits(12);\n        }\n        if (subLayerLevelPresentFlag[i] !== 0) {\n          gb.readBits(8);\n        }\n      }\n\n      return {\n        general_profile_space: general_profile_space,\n        general_tier_flag: general_tier_flag,\n        general_profile_idc: general_profile_idc,\n        general_level_idc: general_level_idc\n      };\n    }\n\n    /**\n     *\n     *  @param {any} gb\n     * @param {number}count\n     */\n\n  }, {\n    key: '_skipScalingList',\n    value: function _skipScalingList(gb, count) {\n      var lastScale = 8;\n      var nextScale = 8;\n      var deltaScale = 0;\n      for (var i = 0; i < count; i++) {\n        if (nextScale !== 0) {\n          deltaScale = gb.readSEG();\n          nextScale = (lastScale + deltaScale + 256) % 256;\n        }\n        lastScale = nextScale === 0 ? lastScale : nextScale;\n      }\n    }\n\n    /**\n     *\n     * @param {number} profileIdc\n     * @return {string}\n     */\n\n  }, {\n    key: 'getProfileString',\n    value: function getProfileString(profileIdc) {\n      switch (profileIdc) {\n        case 66:\n          return 'Baseline';\n        case 77:\n          return 'Main';\n        case 88:\n          return 'Extended';\n        case 100:\n          return 'High';\n        case 110:\n          return 'High10';\n        case 122:\n          return 'High422';\n        case 244:\n          return 'High444';\n        default:\n          return 'Unknown';\n      }\n    }\n\n    /**\n     * @param {number} levelIdc\n     * @return {string}\n     */\n\n  }, {\n    key: 'getLevelString',\n    value: function getLevelString(levelIdc) {\n      return (levelIdc / 10).toFixed(1);\n    }\n\n    /**\n     * @param {number} chroma\n     * @return {string}\n     */\n\n  }, {\n    key: 'getChromaFormatString',\n    value: function getChromaFormatString(chroma) {\n      switch (chroma) {\n        case 420:\n          return '4:2:0';\n        case 422:\n          return '4:2:2';\n        case 444:\n          return '4:4:4';\n        default:\n          return 'Unknown';\n      }\n    }\n\n    /**\n     * @param {any} spsConfig\n     * @return {any}\n     */\n\n  }, {\n    key: 'toVideoMeta',\n    value: function toVideoMeta(spsConfig) {\n      var meta = {};\n      if (spsConfig && spsConfig.codec_size) {\n        meta.codecWidth = spsConfig.codec_size.width;\n        meta.codecHeight = spsConfig.codec_size.height;\n        meta.presentWidth = spsConfig.present_size.width;\n        meta.presentHeight = spsConfig.present_size.height;\n      } else if (spsConfig.width && spsConfig.height) {\n        meta.codecWidth = spsConfig.width;\n        meta.codecHeight = spsConfig.height;\n        meta.presentWidth = spsConfig.width;\n        meta.presentHeight = spsConfig.height;\n      }\n\n      meta.profile = spsConfig.profile_string;\n      meta.level = spsConfig.level_string;\n      meta.bitDepth = spsConfig.bit_depth;\n      meta.chromaFormat = spsConfig.chroma_format;\n\n      // meta.parRatio = {\n      //   width: spsConfig.par_ratio.width,\n      //   height: spsConfig.par_ratio.height\n      // }\n\n      // meta.frameRate = spsConfig.frame_rate\n\n      // let fpsDen = meta.frameRate.fps_den\n      // let fpsNum = meta.frameRate.fps_num\n      // meta.refSampleDuration = Math.floor(meta.timescale * (fpsDen / fpsNum))\n      return meta;\n    }\n  }]);\n\n  return SPSParser;\n}();\n\nexport default SPSParser;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar RBSP = function () {\n  function RBSP() {\n    _classCallCheck(this, RBSP);\n  }\n\n  _createClass(RBSP, null, [{\n    key: \"EBSP2RBSP\",\n\n    /**\n     * convert EBSP to RBSP\n     * @param {Uint8Array} data\n     * @returns {Uint8Array}\n     * @constructor\n     */\n    value: function EBSP2RBSP(data) {\n      return data.filter(function (el, idx) {\n        if (idx < 2) {\n          return true;\n        } else {\n          return !(data[idx - 2] === 0 && data[idx - 1] === 0 && el === 3);\n        }\n      });\n    }\n\n    /**\n     * @param {Uint8Array} data\n     * @constructor\n     */\n\n  }, {\n    key: \"EBSP2SODB\",\n    value: function EBSP2SODB(data) {\n      var lastByte = data[data.byteLength - 1];\n      if (lastByte && lastByte === 128) {\n        return data.slice(0, data.byteLength - 1);\n      }\n\n      return data;\n    }\n  }]);\n\n  return RBSP;\n}();\n\nexport default RBSP;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport RBSP from './rbsp';\n\n/**\n * @param {Uint8Array} data\n * @return {string}\n */\nvar u8aToString = function u8aToString(data) {\n  var result = '';\n  for (var i = 0; i < data.byteLength; i++) {\n    result += String.fromCharCode(data[i]);\n  }\n  return result;\n};\n\nvar SEIParser = function () {\n  function SEIParser() {\n    _classCallCheck(this, SEIParser);\n  }\n\n  _createClass(SEIParser, null, [{\n    key: '_resolveNalu',\n    value: function _resolveNalu(data) {\n      if (data.length >= 1) {\n        return RBSP.EBSP2SODB(RBSP.EBSP2RBSP(data.slice(1)));\n      }\n      return null;\n    }\n\n    /**\n     * @param {Uint8Array} data\n     * @return {{uuid: string, content: null}|{code: number, uuid: string, content: string}|{code: number, content: Uint8Array}}\n     */\n\n  }, {\n    key: 'parse',\n    value: function parse(data) {\n      var sodb = SEIParser._resolveNalu(data);\n\n      var _SEIParser$switchPayl = SEIParser.switchPayloadType(sodb),\n          payloadType = _SEIParser$switchPayl.payloadType,\n          offset = _SEIParser$switchPayl.offset;\n\n      var content = sodb.slice(offset);\n\n      switch (payloadType) {\n        case 5:\n          return SEIParser.user_data_unregistered(content);\n        default:\n          return {\n            code: payloadType,\n            content: content\n          };\n      }\n    }\n\n    /**\n     *\n     * @param {Uint8Array} data\n     * @returns {{payloadType: number, offset: number}}\n     */\n\n  }, {\n    key: 'switchPayloadType',\n    value: function switchPayloadType(data) {\n      var dv = new DataView(data.buffer);\n      var payloadType = 0;\n      var offset = 0;\n      while (dv.getUint8(offset) === 255) {\n        offset++;\n        payloadType += 255;\n      }\n      payloadType += dv.getUint8(offset++);\n\n      return {\n        payloadType: payloadType,\n        offset: offset\n      };\n    }\n\n    /**\n     *\n     * @param {Uint8Array} data\n     * @return {{ payloadLength: number, offset: number }}\n     */\n\n  }, {\n    key: 'getPayloadLength',\n    value: function getPayloadLength(data) {\n      var dv = new DataView(data.buffer);\n\n      var payloadLength = 0;\n      var offset = 0;\n      while (dv.getUint8(offset) === 255) {\n        offset++;\n        payloadLength += 255;\n      }\n      payloadLength += dv.getUint8(offset++);\n\n      return {\n        payloadLength: payloadLength,\n        offset: offset\n      };\n    }\n\n    /**\n     * resolve 0x05 user data unregistered\n     * @param {Uint8Array} data\n     */\n    // eslint-disable-next-line camelcase\n\n  }, {\n    key: 'user_data_unregistered',\n    value: function user_data_unregistered(data) {\n      var _SEIParser$getPayload = SEIParser.getPayloadLength(data),\n          payloadLength = _SEIParser$getPayload.payloadLength,\n          offset = _SEIParser$getPayload.offset;\n\n      if (payloadLength < 16) {\n        return {\n          uuid: '',\n          content: null\n        };\n      }\n      var payload = data.slice(offset);\n\n      var uuid = u8aToString(payload.slice(0, 16));\n      var content = u8aToString(payload.slice(16, payloadLength));\n\n      return {\n        code: 5, // for user data unregistered\n        uuid: uuid,\n        content: content\n      };\n    }\n  }]);\n\n  return SEIParser;\n}();\n\nexport default SEIParser;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport SpsParser from './sps';\nimport SEIParser from './sei';\n\nvar Nalunit = function () {\n  function Nalunit() {\n    _classCallCheck(this, Nalunit);\n  }\n\n  _createClass(Nalunit, null, [{\n    key: 'getNalunits',\n\n    /**\n     * @param {any} buffer\n     * @return {[]|*[]}\n     */\n    value: function getNalunits(buffer) {\n      if (buffer.length - buffer.position < 4) {\n        return [];\n      }\n\n      var buf = buffer.dataview;\n      var position = buffer.position;\n\n      if (buf.getInt32(position) === 1 || buf.getInt16(position) === 0 && buf.getInt8(position + 2) === 1) {\n        return Nalunit.getAnnexbNals(buffer);\n      } else {\n        return Nalunit.getHvccNals(buffer);\n      }\n    }\n\n    /**\n     * @param {any} buffer\n     * @return {[]}\n     */\n\n  }, {\n    key: 'getAnnexbNals',\n    value: function getAnnexbNals(buffer) {\n      var nals = [];\n      var position = Nalunit.getHeaderPositionAnnexB(buffer);\n      var start = position.pos;\n      var end = start;\n      while (start < buffer.length - 4) {\n        var header = buffer.buffer.slice(start, start + position.headerLength);\n        if (position.pos === buffer.position) {\n          buffer.skip(position.headerLength);\n        }\n        position = Nalunit.getHeaderPositionAnnexB(buffer);\n        end = position.pos;\n        var body = new Uint8Array(buffer.buffer.slice(start + header.byteLength, end));\n        var unit = { header: header, body: body };\n        Nalunit.analyseNal(unit);\n        if (unit.type <= 40) {\n          nals.push(unit);\n        }\n        buffer.skip(end - buffer.position);\n        start = end;\n      }\n      return nals;\n    }\n\n    // |四字节 nalSize| nalUnit |\n    /**\n     * @param {any} buffer\n     * @return {[]}\n     */\n\n  }, {\n    key: 'getHvccNals',\n    value: function getHvccNals(buffer) {\n      // console.log('getHvccNals')\n      var nals = [];\n      while (buffer.position < buffer.length - 4) {\n        // console.log('buffer')\n        // console.log(buffer)\n        // console.log(buffer.position)\n        // console.log(buffer.length)\n        // console.log(buffer.dataview)\n        // let length = buffer.dataview.getInt32();\n        var length = buffer.dataview.getInt32(buffer.dataview.position);\n        if (buffer.length - buffer.position >= length) {\n          var header = buffer.buffer.slice(buffer.position, buffer.position + 4);\n          buffer.skip(4);\n          var body = new Uint8Array(buffer.buffer.slice(buffer.position, buffer.position + length));\n          buffer.skip(length);\n          var unit = { header: header, body: body };\n          try {\n            Nalunit.analyseNal(unit);\n          } catch (e) {\n            continue;\n          }\n          if (unit.type <= 40) {\n            nals.push(unit);\n          }\n        } else {\n          break;\n        }\n      }\n      return nals;\n    }\n\n    /**\n     * @param {any} unit\n     */\n\n  }, {\n    key: 'analyseNal',\n    value: function analyseNal(unit) {\n      var type = unit.body[0] >>> 1 & 0x3f;\n      unit.type = type;\n      switch (type) {\n        case 0:\n          // SLICE_TRAIL_N\n          unit.slice_trail_n = true;\n          break;\n        case 1:\n          // SLICE_TRAIL_R\n          unit.slice_trail_r = true;\n          unit.key = true;\n          break;\n        case 2:\n          // SLICE_TSA_N\n          unit.slice_tsa_n = true;\n          break;\n        case 3:\n          // SLICE_TSA_R\n          unit.slice_tsa_r = true;\n          unit.key = true;\n          break;\n        case 4:\n          // SLICE_STSA_N\n          unit.slice_stsa_n = true;\n          break;\n        case 5:\n          // SLICE_STSA_R\n          unit.slice_stsa_r = true;\n          unit.key = true;\n          break;\n        case 6:\n          // SLICE_RADL_N\n          unit.slice_radl_n = true;\n          break;\n        case 7:\n          // SLICE_RADL_R\n          unit.slice_radl_r = true;\n          unit.key = true;\n          break;\n        case 8:\n          // SLICE_RASL_N\n          unit.slice_rasl_n = true;\n          break;\n        case 9:\n          // SLICE_RASL_R\n          unit.slice_rasl_r = true;\n          unit.key = true;\n          break;\n        case 16:\n          // SLICE_BLA_W_LP\n          unit.slice_bla_w_lp = true;\n          break;\n        case 17:\n          // SLICE_BLA_W_RADL\n          unit.slice_bla_w_radl = true;\n          break;\n        case 18:\n          // SLICE_BLA_N_LP\n          unit.slice_bla_n_lp = true;\n          break;\n        case 19:\n          // SLICE_IDR_W_RADL\n          unit.slice_idl_w_radl = true;\n          unit.key = true;\n          break;\n        case 20:\n          // SLICE_IDR_N_LP\n          unit.slice_idr_n_lp = true;\n          unit.key = true;\n          break;\n        case 21:\n          // SLICE_CRA_NUT\n          unit.slice_cra_nut = true;\n          unit.key = true;\n          break;\n        case 32:\n          // VPS\n          unit.vps = true;\n          break;\n        case 33:\n          // SPS\n          unit.sps = SpsParser.parseSPS(unit.body);\n          break;\n        case 34:\n          // PPS\n          unit.pps = true;\n          break;\n        case 35:\n          // AUD\n          break;\n        case 36:\n          // EOS\n          unit.aud = true;\n          break;\n        case 37:\n          // EOB\n          unit.eob = true;\n          break;\n        case 38:\n          // FD\n          unit.fd = true;\n          break;\n        case 39:\n          // PREFIX_SEI\n          // unit.prefix_sei = true;\n          try {\n            unit.sei = SEIParser.parse(unit.body.slice(1));\n          } catch (e) {}\n          break;\n        case 40:\n          // SUFFIX_SEI\n          unit.sei = SEIParser.parse(unit.body.slice(1));\n          break;\n        default:\n          break;\n      }\n    }\n  }, {\n    key: 'getHeaderPositionAnnexB',\n    value: function getHeaderPositionAnnexB(buffer) {\n      // seperate\n      var pos = buffer.position;\n      var headerLength = 0;\n      var bufferLen = buffer.length;\n      while (headerLength !== 3 && headerLength !== 4 && pos < bufferLen - 4) {\n        if (buffer.dataview.getInt16(pos) === 0) {\n          if (buffer.dataview.getInt16(pos + 2) === 1) {\n            // 0x00000001\n            headerLength = 4;\n          } else if (buffer.dataview.getInt8(pos + 2) === 1) {\n            headerLength = 3;\n          } else {\n            pos++;\n          }\n        } else {\n          pos++;\n        }\n      }\n\n      if (pos === bufferLen - 4) {\n        if (buffer.dataview.getInt16(pos) === 0) {\n          if (buffer.dataview.getInt16(pos + 2) === 1) {\n            // 0x00000001\n            headerLength = 4;\n          }\n        } else {\n          pos++;\n          if (buffer.dataview.getInt16(pos) === 0 && buffer.dataview.getInt8(pos) === 1) {\n            // 0x000001\n            headerLength = 3;\n          } else {\n            pos = bufferLen;\n          }\n        }\n      }\n      return { pos: pos, headerLength: headerLength };\n    }\n  }]);\n\n  return Nalunit;\n}();\n\nexport default Nalunit;","import _AAC from './aac';\nimport _ADTS from './aac/adts';\nimport * as _avc from './avc';\nimport * as _hevc from './hevc';\nimport _Compat from './compat';\nimport _CompatHls from './compat/hls';\nimport _UTF8 from './utf8';\n\nexport var AAC = _AAC;\nexport var ADTS = _ADTS;\nexport var avc = _avc;\nexport var hevc = _hevc;\nexport var Compat = _Compat;\nexport var CompatHls = _CompatHls;\nexport var UTF8 = _UTF8;","import { EVENTS } from 'xgplayer-helper-utils'\nimport { XGDataView } from 'xgplayer-helper-models'\nimport { avc, hevc } from 'xgplayer-helper-codec';\n\nconst { NalUnitHEVC } = hevc;\nconst { NalUnit } = avc;\nconst LOADER_EVENTS = EVENTS.LOADER_EVENTS;\nconst DEMUX_EVENTS = EVENTS.DEMUX_EVENTS;\nconst HLS_EVENTS = EVENTS.HLS_EVENTS;\nconst CRYTO_EVENTS = EVENTS.CRYTO_EVENTS;\nconst HLS_ERROR = 'HLS_ERROR';\n\nconst MASTER_PLAYLIST_REGEX = /#EXT-X-STREAM-INF:([^\\n\\r]*)[\\r\\n]+([^\\r\\n]+)/g;\n\nclass HlsLiveController {\n  constructor (configs) {\n    this.configs = Object.assign({}, configs);\n    this.url = '';\n    this.sequence = 0;\n    this._playlist = null;\n    this.retrytimes = this.configs.retrytimes || 3;\n    this.preloadTime = this.configs.preloadTime;\n    this.container = this.configs.container;\n    this._m3u8lasttime = 0;\n    this._timmer = setInterval(this._checkStatus.bind(this), 50);\n    this._lastCheck = 0;\n\n    this.m3u8Text = null\n  }\n\n  init () {\n    const { XgBuffer, Tracks, Playlist, FetchLoader, TsDemuxer } = this._player.hlsOps;\n    // 初始化Buffer （M3U8/TS/Playlist);\n    this._context.registry('M3U8_BUFFER', XgBuffer);\n    this._context.registry('TS_BUFFER', XgBuffer);\n    this._context.registry('TRACKS', Tracks);\n\n    this._playlist = this._context.registry('PLAYLIST', Playlist)({autoclear: true});\n\n    // 初始化M3U8Loader;\n    this._m3u8loader = this._context.registry('M3U8_LOADER', FetchLoader)({ buffer: 'M3U8_BUFFER', readtype: 1 });\n    this._tsloader = this._context.registry('TS_LOADER', FetchLoader)({ buffer: 'TS_BUFFER', readtype: 3 });\n\n    // 初始化TS Demuxer\n    this._context.registry('TS_DEMUXER', TsDemuxer)({ inputbuffer: 'TS_BUFFER' });\n\n    this.initEvents();\n  }\n\n  initEvents () {\n    this.on(LOADER_EVENTS.LOADER_COMPLETE, this._onLoadComplete.bind(this));\n\n    this.on(DEMUX_EVENTS.METADATA_PARSED, this._onMetadataParsed.bind(this));\n\n    this.on(DEMUX_EVENTS.SEI_PARSED, this._handleSEIParsed.bind(this))\n\n    this.on(DEMUX_EVENTS.DEMUX_COMPLETE, this._onDemuxComplete.bind(this));\n\n    this.on(LOADER_EVENTS.LOADER_ERROR, this._onLoadError.bind(this));\n\n    this.on(DEMUX_EVENTS.DEMUX_ERROR, this._onDemuxError.bind(this));\n  }\n\n  _onError (type, mod, err, fatal) {\n    let error = {\n      errorType: type,\n      errorDetails: `[${mod}]: ${err ? err.message : ''}`,\n      errorFatal: fatal\n    }\n    this._player.emit(HLS_ERROR, error);\n  }\n\n  _onDemuxComplete () {\n    if (this._player.video) {\n      const { videoTrack, audioTrack } = this._context.getInstance('TRACKS');\n      videoTrack.samples.forEach((sample) => {\n        if (sample.analyzed) {\n          return;\n        }\n        sample.analyzed = true;\n        const buffer = new XGDataView(sample.data.buffer)\n        let nals\n        if (this._isHEVC(videoTrack.meta)) {\n          nals = NalUnitHEVC.getHvccNals(buffer);\n        } else {\n          nals = NalUnit.getNalunits(buffer);\n        }\n        const nalsLength = nals.reduce((len, current) => {\n          return len + 4 + current.body.byteLength;\n        }, 0);\n        const newData = new Uint8Array(nalsLength);\n        let offset = 0;\n        nals.forEach((nal) => {\n          newData.set([0, 0, 0, 1], offset)\n          offset += 4;\n          newData.set(new Uint8Array(nal.body), offset);\n          offset += nal.body.byteLength;\n        })\n\n        sample.data = newData;\n      })\n      this._player.video.onDemuxComplete(videoTrack, audioTrack);\n    }\n  }\n\n  _onMetadataParsed (type) {\n    if (type === 'audio') {\n      // 将音频meta信息交给audioContext，不走remux封装\n      const { audioTrack } = this._context.getInstance('TRACKS')\n      if (audioTrack && audioTrack.meta) {\n        this._setMetaToAudio(audioTrack.meta)\n      }\n    } else {\n      const { videoTrack } = this._context.getInstance('TRACKS')\n      if (videoTrack && videoTrack.meta) {\n        this._setMetaToVideo(videoTrack.meta)\n      }\n    }\n  }\n\n  _setMetaToAudio (audioMeta) {\n    if (this._player.video) {\n      this._player.video.setAudioMeta(audioMeta);\n    }\n  }\n\n  _setMetaToVideo (videoMeta) {\n    if (this._player.video) {\n      this._player.video.setVideoMeta(videoMeta);\n    }\n  }\n\n  _onLoadError (loader, error) {\n    if (!this._tsloader.loading && !this._m3u8loader.loading && this.retrytimes > 1) {\n      this.retrytimes--;\n      this._onError(LOADER_EVENTS.LOADER_ERROR, loader, error, false);\n    } else if (this.retrytimes <= 1) {\n      this._onError(LOADER_EVENTS.LOADER_ERROR, loader, error, true);\n      this.emit(HLS_EVENTS.RETRY_TIME_EXCEEDED);\n      if (this._player.video) {\n        this._player.video.handleEnded()\n      }\n    }\n  }\n\n  _onDemuxError (mod, error, fatal) {\n    if (fatal === undefined) {\n      fatal = true;\n    }\n    this._onError(LOADER_EVENTS.LOADER_ERROR, mod, error, fatal);\n  }\n\n  _handleSEIParsed (sei) {\n    this._player.emit('SEI_PARSED', sei)\n  }\n\n  _onLoadComplete (buffer) {\n    if (buffer.TAG === 'M3U8_BUFFER') {\n      let mdata;\n      try {\n        this.m3u8Text = buffer.shift();\n        let result = MASTER_PLAYLIST_REGEX.exec(this.m3u8Text)\n        if (result && result[2]) {\n          // redirect\n          this.load(result[2])\n        } else {\n          mdata = this._player.hlsOps.M3U8Parser.parse(this.m3u8Text, this.url);\n        }\n      } catch (error) {\n        this._onError('M3U8_PARSER_ERROR', 'M3U8_PARSER', error, false);\n      }\n\n      if (!mdata) {\n        if (this.retrytimes > 0) {\n          this.retrytimes--;\n          this._preload();\n        } else {\n          this.emit(HLS_EVENTS.RETRY_TIME_EXCEEDED);\n          if (this._player.video) {\n            this._player.video.handleEnded()\n          }\n        }\n        return;\n      }\n\n      try {\n        this._playlist.pushM3U8(mdata, true);\n      } catch (error) {\n        this._onError('M3U8_PARSER_ERROR', 'PLAYLIST', error, false);\n      }\n\n      if (this._playlist.encrypt && this._playlist.encrypt.uri && !this._playlist.encrypt.key) {\n        const { XgBuffer, FetchLoader } = this._player.hlsOps\n        this._context.registry('DECRYPT_BUFFER', XgBuffer)();\n        this._context.registry('KEY_BUFFER', XgBuffer)();\n        this._tsloader.buffer = 'DECRYPT_BUFFER';\n        this._keyLoader = this._context.registry('KEY_LOADER', FetchLoader)({buffer: 'KEY_BUFFER', readtype: 3});\n        this.emitTo('KEY_LOADER', LOADER_EVENTS.LADER_START, this._playlist.encrypt.uri);\n      } else {\n        this._m3u8Loaded(mdata);\n      }\n    } else if (buffer.TAG === 'TS_BUFFER') {\n      this.retrytimes = this.configs.retrytimes || 3;\n      this._playlist.downloaded(this._tsloader.url, true);\n      this.emit(DEMUX_EVENTS.DEMUX_START);\n    } else if (buffer.TAG === 'DECRYPT_BUFFER') {\n      this.retrytimes = this.configs.retrytimes || 3;\n      this._playlist.downloaded(this._tsloader.url, true);\n      this.emitTo('CRYPTO', CRYTO_EVENTS.START_DECRYPT);\n    } else if (buffer.TAG === 'KEY_BUFFER') {\n      const { Crypto } = this._player.hlsOps\n      this.retrytimes = this.configs.retrytimes || 3;\n      this._playlist.encrypt.key = buffer.shift();\n      this._crypto = this._context.registry('CRYPTO', Crypto)({\n        key: this._playlist.encrypt.key,\n        iv: this._playlist.encrypt.ivb,\n        method: this._playlist.encrypt.method,\n        inputbuffer: 'DECRYPT_BUFFER',\n        outputbuffer: 'TS_BUFFER'\n      });\n      this._crypto.on(CRYTO_EVENTS.DECRYPTED, this._onDcripted.bind(this));\n    }\n  }\n\n  _onDcripted () {\n    this.emit(DEMUX_EVENTS.DEMUX_START);\n  }\n\n  _m3u8Loaded (mdata) {\n    if (!this.preloadTime) {\n      this.preloadTime = this._playlist.targetduration ? this._playlist.targetduration : 5;\n    }\n    if (this._playlist.fragLength > 0 && this._playlist.sequence < mdata.sequence) {\n      this.retrytimes = this.configs.retrytimes || 3;\n    } else {\n      if (this.retrytimes > 0) {\n        this.retrytimes--;\n        this._preload();\n      } else {\n        this.emit(HLS_EVENTS.RETRY_TIME_EXCEEDED);\n        if (this._player.video) {\n          this._player.video.handleEnded()\n        }\n      }\n    }\n  }\n  _checkStatus () {\n    if (this.retrytimes < 1 && (new Date().getTime() - this._lastCheck < 10000)) {\n      return;\n    }\n    this._lastCheck = new Date().getTime();\n    if (this.container.buffered.length < 1) {\n      this._preload()\n    } else {\n      // Check for load.\n      let currentTime = this.container.currentTime;\n      if (this.container.readyState <= 2) {\n        this._preload();\n      }\n      let bufferend = this.container.buffered.end(this.container.buffered.length - 1);\n\n      if (currentTime > bufferend - this.preloadTime) {\n        this._preload();\n      }\n    }\n  }\n\n  _preload () {\n    if (this._tsloader.loading || this._m3u8loader.loading) {\n      return;\n    }\n    let frag = this._playlist.getTs();\n\n    if (frag && !frag.downloaded && !frag.downloading) {\n      this._playlist.downloading(frag.url, true);\n      this.emitTo('TS_LOADER', LOADER_EVENTS.LADER_START, frag.url)\n    } else {\n      let preloadTime = this.preloadTime ? this.preloadTime : 0;\n      let current = new Date().getTime();\n      if ((!frag || frag.downloaded) &&\n        (current - this._m3u8lasttime) / 1000 > preloadTime) {\n        this._m3u8lasttime = current\n        this.emitTo('M3U8_LOADER', LOADER_EVENTS.LADER_START, this.url);\n      }\n    }\n  }\n\n  _isHEVC (meta) {\n    return meta && meta.codec === 'hev1.1.6.L93.B0'\n  }\n\n  load (url) {\n    this.url = url;\n    this._preload();\n  }\n\n  destroy () {\n    clearInterval(this._timmer);\n    this.off(LOADER_EVENTS.LOADER_COMPLETE, this._onLoadComplete);\n    // this.off(REMUX_EVENTS.REMUX_ERROR);\n    this.off(DEMUX_EVENTS.METADATA_PARSED, this._onMetadataParsed);\n    this.off(DEMUX_EVENTS.DEMUX_COMPLETE, this._onDemuxComplete);\n\n    this.m3u8Text = null\n  }\n}\nexport default HlsLiveController;\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport EventEmitter from 'eventemitter3';\nimport { logger } from 'xgplayer-helper-utils';\nimport { XGDataView, AudioTrackMeta, VideoTrackMeta, AudioSample, VideoSample } from 'xgplayer-helper-models';\nimport { ADTS, avc, hevc } from 'xgplayer-helper-codec';\n\n/**\n * @typedef {import('xgplayer-helper-models').TsFrag } TsFrag\n */\n/**\n * @typedef {import('xgplayer-helper-models').Buffer } Buffer\n */\nvar NalUnit = avc.NalUnit;\nvar NalUnitHEVC = hevc.NalUnitHEVC;\n\nvar StreamType = {\n  0x01: ['video', 'MPEG-1'],\n  0x02: ['video', 'MPEG-2'],\n  0x1b: ['video', 'AVC.H264'],\n  0x24: ['video', 'HVC.H265'],\n  0xea: ['video', 'VC-1'],\n  0x03: ['audio', 'MPEG-1'],\n  0x04: ['audio', 'MPEG-2'],\n  0x0f: ['audio', 'MPEG-2.AAC'],\n  0x11: ['audio', 'MPEG-4.AAC'],\n  0x80: ['audio', 'LPCM'],\n  0x81: ['audio', 'AC3'],\n  0x06: ['audio', 'AC3'],\n  0x82: ['audio', 'DTS'],\n  0x83: ['audio', 'Dolby TrueHD'],\n  0x84: ['audio', 'AC3-Plus'],\n  0x85: ['audio', 'DTS-HD'],\n  0x86: ['audio', 'DTS-MA'],\n  0xa1: ['audio', 'AC3-Plus-SEC'],\n  0xa2: ['audio', 'DTS-HD-SEC']\n};\n\nvar TsDemuxer = function (_EventEmitter) {\n  _inherits(TsDemuxer, _EventEmitter);\n\n  _createClass(TsDemuxer, null, [{\n    key: 'EVENTS',\n    get: function get() {\n      return {\n        DEMUX_COMPLETE: 'DEMUX_COMPLETE',\n        METADATA_PARSED: 'METADATA_PARSED',\n        VIDEO_SAMPLE_PARSED: 'VIDEO_SAMPLE_PARSED',\n        AUDIO_SAMPLE_PARSED: 'AUDIO_SAMPLES_PARSED',\n        SEI_PARSED: 'SEI_PARSED'\n      };\n    }\n\n    /**\n     * @param {any} videoTrack\n     * @param {any} audioTrack\n     */\n\n  }]);\n\n  function TsDemuxer(_ref) {\n    var videoTrack = _ref.videoTrack,\n        audioTrack = _ref.audioTrack;\n\n    _classCallCheck(this, TsDemuxer);\n\n    var _this = _possibleConstructorReturn(this, (TsDemuxer.__proto__ || Object.getPrototypeOf(TsDemuxer)).call(this));\n\n    _this.TAG = 'TsDemuxer';\n    _this.demuxing = false;\n    _this.videoTrack = videoTrack;\n    _this.audioTrack = audioTrack;\n    _this.pat = [];\n    _this.pmt = [];\n    _this._hasVideoMeta = false;\n    _this._hasAudioMeta = false;\n    _this.gopId = 0;\n    return _this;\n  }\n\n  /**\n   *\n   * @param {TsFrag} frag ts fragment parsed from m3u8\n   * @param {Buffer} buffer u8a-buffer\n   * @param {boolean} isVod is a vod m3u8\n   */\n\n\n  _createClass(TsDemuxer, [{\n    key: 'demux',\n    value: function demux(frag, buffer, isVod) {\n      if (frag) {\n        logger.log(this.TAG, 'do demux: id=' + frag.id + ',demuxing=' + this.demuxing);\n      }\n      if (this.demuxing) {\n        return;\n      }\n\n      var frags = { pat: [], pmt: [] };\n      var peses = {};\n      while (buffer.length >= 188) {\n        if (buffer.length >= 1 && buffer.array[0][buffer.offset] !== 71) {\n          throw new Error('Untrust sync code: ' + buffer.array[0][buffer.offset] + ', try to recover;');\n        }\n        while (buffer.length >= 1 && buffer.array[0][buffer.offset] !== 71) {\n          buffer.shift(1);\n        }\n        if (buffer.length < 188) {\n          continue;\n        }\n        var buf = buffer.shift(188);\n        // console.log(buf);\n        var tsStream = new XGDataView(buf.buffer);\n        var ts = {};\n        TsDemuxer.read(tsStream, ts, frags);\n        var pes = peses[ts.header.pid];\n        if (ts.pes) {\n          ts.pes.codec = ts.header.codec;\n          ts.pes.streamType = ts.header.streamType;\n          if (!peses[ts.header.pid]) {\n            peses[ts.header.pid] = [];\n          }\n          peses[ts.header.pid].push(ts.pes);\n          ts.pes.ES.buffer = [ts.pes.ES.buffer];\n        } else if (pes) {\n          pes[pes.length - 1].ES.buffer.push(ts.payload.stream);\n        }\n      }\n\n      var AudioOptions = Object.assign({}, frag);\n      var VideoOptions = Object.assign({}, frag);\n\n      var noAudio = isVod && this._hasVideoMeta && !this._hasAudioMeta;\n      var noVideo = isVod && this._hasAudioMeta && !this._hasVideoMeta;\n\n      // Get Frames data\n      for (var i = 0; i < Object.keys(peses).length; i++) {\n        var epeses = peses[Object.keys(peses)[i]];\n        for (var j = 0; j < epeses.length; j++) {\n          var cPes = epeses[j];\n          cPes.id = Object.keys(peses)[i];\n\n          // 1. !noAudio 首片无音频,后续分片当无音频处理\n          // 2. cPes.streamType === 0x0f || cPes.streamType === 0x11 只处理aac,其他音频格式当无音频\n          var isAAC = cPes.streamType === 0x0f || cPes.streamType === 0x11;\n          if (cPes.type === 'audio' && !noAudio && isAAC) {\n            cPes.ES.buffer = TsDemuxer.mergeAudioES(cPes.ES.buffer);\n            this.pushAudioSample(cPes, AudioOptions);\n            AudioOptions = {};\n          } else if (cPes.type === 'video' && !noVideo) {\n            cPes.ES.buffer = TsDemuxer.mergeVideoES(cPes.ES.buffer);\n            if (cPes.codec === 'HVC.H265') {\n              this.pushVideoSampleHEVC(epeses[j], VideoOptions);\n            } else {\n              this.pushVideoSample(epeses[j], VideoOptions);\n            }\n            VideoOptions = { spsFound: !!VideoOptions.spsFound };\n          }\n        }\n      }\n    }\n  }, {\n    key: 'pushAudioSample',\n    value: function pushAudioSample(pes, options) {\n      var meta = new AudioTrackMeta({\n        audioSampleRate: pes.ES.frequence,\n        sampleRate: pes.ES.frequence,\n        channelCount: pes.ES.channel,\n        codec: 'mp4a.40.' + pes.ES.audioObjectType,\n        originCodec: 'mp4a.40.' + pes.ES.originAudioObjectType,\n        originObjectType: pes.ES.originAudioObjectType,\n        config: pes.ES.audioConfig,\n        id: 2,\n        sampleRateIndex: pes.ES.frequencyIndex\n      });\n      meta.refSampleDuration = Math.floor(1024 / meta.audioSampleRate * meta.timescale);\n\n      var metaEqual = TsDemuxer.compareMeta(this.audioTrack.meta, meta, true);\n\n      if (!this._hasAudioMeta || !metaEqual) {\n        this._hasAudioMeta = true;\n        if (options) {\n          options.meta = Object.assign({}, meta);\n        } else {\n          options = {\n            meta: Object.assign({}, meta)\n          };\n        }\n        this.emit(TsDemuxer.EVENTS.METADATA_PARSED, 'audio', meta);\n      }\n\n      var frameIndex = 0;\n      pes.ES.buffer.skip(pes.pesHeaderLength + 9);\n      var streamChanged = false;\n      while (pes.ES.buffer.position < pes.ES.buffer.length) {\n        if (ADTS.isHeader(new Uint8Array(pes.ES.buffer.buffer), pes.ES.buffer.position) && pes.ES.buffer.position + 5 < pes.ES.buffer.length) {\n          var frame = ADTS.appendFrame(this.audioTrack.meta.sampleRate, new Uint8Array(pes.ES.buffer.buffer), pes.ES.buffer.position, pes.pts, frameIndex);\n          if (frame && frame.sample) {\n            // logger.log(`${Math.round(frame.sample.pts)} : AAC`);\n            pes.ES.buffer.skip(frame.length);\n            var sample = new AudioSample({\n              dts: frame.sample.dts,\n              pts: frame.sample.pts,\n              data: frame.sample.unit,\n              options: streamChanged ? {} : options\n            });\n            if (options.meta) {\n              streamChanged = true;\n            }\n            sample.dts = sample.pts = Math.ceil(sample.pts / 90);\n            this.emit(TsDemuxer.EVENTS.AUDIO_SAMPLE_PARSED, sample);\n            frameIndex++;\n          } else {\n            // logger.log('Unable to parse AAC frame');\n            break;\n          }\n        } else {\n          // nothing found, keep looking\n          pes.ES.buffer.skip(1);\n        }\n      }\n    }\n  }, {\n    key: 'pushVideoSample',\n    value: function pushVideoSample(pes, options) {\n      var _this2 = this;\n\n      var nals = NalUnit.getNalunits(pes.ES.buffer);\n      var meta = new VideoTrackMeta();\n      var spsFound = options.spsFound; // 保存当前分片内是否解析过sps\n      var sampleLength = 0;\n      var sps = false;\n      var pps = false;\n      var seiList = [];\n      for (var i = 0; i < nals.length; i++) {\n        var nal = nals[i];\n        if (nal.type < 9 && !nal.sei) {\n          sampleLength += 4 + nal.body.byteLength;\n        }\n        if (nal.sps) {\n          sps = nal;\n          meta.sps = nal.body;\n          meta.chromaFormat = sps.sps.chroma_format;\n          meta.codec = 'avc1.';\n          for (var j = 1; j < 4; j++) {\n            var h = sps.body[j].toString(16);\n            if (h.length < 2) {\n              h = '0' + h;\n            }\n            meta.codec += h;\n          }\n          meta.codecHeight = sps.sps.codec_size.height;\n          meta.codecWidth = sps.sps.codec_size.width;\n          meta.frameRate = sps.sps.frame_rate;\n          meta.id = 1;\n          meta.level = sps.sps.level_string;\n          meta.presentHeight = sps.sps.present_size.height;\n          meta.presentWidth = sps.sps.present_size.width;\n          meta.profile = sps.sps.profile_string;\n          meta.refSampleDuration = Math.floor(meta.timescale * (sps.sps.frame_rate.fps_den / sps.sps.frame_rate.fps_num));\n          meta.sarRatio = sps.sps.sar_ratio ? sps.sps.sar_ratio : sps.sps.par_ratio;\n        } else if (nal.pps) {\n          meta.pps = nal.body;\n          pps = nal;\n        } else if (nal.sei) {\n          seiList.push(nal.sei);\n        }\n      }\n\n      if (sps && pps) {\n        meta.avcc = NalUnit.getAvcc(sps.body, pps.body);\n        var metaEqual = TsDemuxer.compareMeta(this.videoTrack.meta, meta, true);\n        if (!this._hasVideoMeta || !metaEqual) {\n          if (options) {\n            options.meta = Object.assign({}, meta);\n          } else {\n            options = {\n              meta: Object.assign({}, meta)\n            };\n          }\n          if (!spsFound) {\n            this.emit(TsDemuxer.EVENTS.METADATA_PARSED, 'video', meta);\n          }\n          options.spsFound = true;\n          this._hasVideoMeta = true;\n        }\n      }\n\n      var data = new Uint8Array(sampleLength);\n      var offset = 0;\n      var isKeyframe = false;\n      for (var _i = 0; _i < nals.length; _i++) {\n        var _nal = nals[_i];\n        if (_nal.type && _nal.type >= 9) {\n          continue;\n        }\n        var length = _nal.body.byteLength;\n        if (_nal.idr) {\n          isKeyframe = true;\n        }\n        if (!_nal.sei) {\n          data.set(new Uint8Array([length >>> 24 & 0xff, length >>> 16 & 0xff, length >>> 8 & 0xff, length & 0xff]), offset);\n          offset += 4;\n          data.set(_nal.body, offset);\n          offset += length;\n        }\n      }\n      var dts = parseInt(pes.dts / 90);\n      var pts = parseInt(pes.pts / 90);\n\n      if (seiList.length) {\n        seiList.forEach(function (sei) {\n          sei.dts = dts;\n          _this2.emit(TsDemuxer.EVENTS.SEI_PARSED, sei);\n        });\n      }\n      var sample = new VideoSample({\n        dts: dts,\n        pts: pts,\n        cts: pts - dts,\n        originDts: pes.dts,\n        purePts: pes.purePts,\n        isKeyframe: isKeyframe,\n        data: data,\n        nals: nals,\n        options: options,\n        firstInGop: isKeyframe,\n        gopId: isKeyframe ? ++this.gopId : this.gopId\n      });\n      this.emit(TsDemuxer.EVENTS.VIDEO_SAMPLE_PARSED, sample);\n    }\n  }, {\n    key: 'pushVideoSampleHEVC',\n    value: function pushVideoSampleHEVC(pes, options) {\n      var _this3 = this;\n\n      var nals = NalUnitHEVC.getNalunits(pes.ES.buffer);\n      nals = nals.filter(function (x) {\n        return x.body && x.body.length;\n      });\n      var meta = new VideoTrackMeta();\n      meta.streamType = 0x24;\n\n      var sampleLength = 0;\n      var vps = false;\n      var sps = false;\n      var pps = false;\n      var seiList = [];\n      var hasVPS = false;\n      var hasSPS = false;\n      var hasPPS = false;\n      var firstInGop = false;\n      for (var i = 0; i < nals.length; i++) {\n        var nal = nals[i];\n\n        if (nal.vps) {\n          if (hasVPS) {\n            continue;\n          } else {\n            hasVPS = true;\n          }\n        } else if (nal.sps) {\n          if (hasSPS) {\n            continue;\n          } else {\n            hasSPS = true;\n          }\n        } else if (nal.pps) {\n          if (hasPPS) {\n            continue;\n          } else {\n            hasPPS = true;\n          }\n        } else if (nal.key) {\n          if (nal.type === 20 || nal.type === 19) {\n            firstInGop = true;\n          }\n        } else if (nal.type === 0) {\n          // if (!hasKeyframe) {\n          //   continue;\n          // }\n        } else if (nal.type === 35) {\n          continue;\n        }\n        if (nal.sps) {\n          sps = nal;\n          meta.sps = nal.body;\n\n          meta.presentWidth = sps.sps.width;\n          meta.presentHeight = sps.sps.height;\n          meta.general_profile_space = sps.sps.general_profile_space;\n          meta.general_tier_flag = sps.sps.general_tier_flag;\n          meta.general_profile_idc = sps.sps.general_profile_idc;\n          meta.general_level_idc = sps.sps.general_level_idc;\n          // meta.duration = this._duration;\n          meta.codec = 'hev1.1.6.L93.B0';\n          meta.chromaFormatIdc = sps.sps.chromaFormatIdc;\n          meta.bitDepthLumaMinus8 = sps.sps.bitDepthLumaMinus8;\n          meta.bitDepthChromaMinus8 = sps.sps.bitDepthChromaMinus8;\n        } else if (nal.pps) {\n          meta.pps = nal.body;\n          pps = nal;\n        } else if (nal.vps) {\n          meta.vps = nal.body;\n          vps = nal;\n        } else if (nal.sei) {\n          seiList.push(nal.sei);\n        }\n        if (nal.type <= 40) {\n          sampleLength += 4 + nal.body.byteLength;\n        }\n      }\n\n      if (sps && pps && vps) {\n        // meta.avcc = NalUnitHEVC.getAvcc(sps.body, pps.body);\n        var metaEqual = TsDemuxer.compareMeta(this.videoTrack.meta, meta, true);\n        if (!this._hasVideoMeta || !metaEqual) {\n          if (options) {\n            options.meta = Object.assign({}, meta);\n          } else {\n            options = {\n              meta: Object.assign({}, meta)\n            };\n          }\n          meta.streamType = 0x24;\n          this.videoTrack.meta = meta;\n          this._hasVideoMeta = true;\n          this.emit(TsDemuxer.EVENTS.METADATA_PARSED, 'video', meta);\n        }\n      }\n\n      var data = new Uint8Array(sampleLength);\n      var offset = 0;\n      var isKeyframe = false;\n      hasVPS = false;\n      hasSPS = false;\n      hasPPS = false;\n      for (var _i2 = 0; _i2 < nals.length; _i2++) {\n        var _nal2 = nals[_i2];\n        if (_nal2.type && _nal2.type > 40) {\n          continue;\n        }\n\n        if (_nal2.vps) {\n          if (hasVPS) {\n            continue;\n          } else {\n            hasVPS = true;\n          }\n        } else if (_nal2.sps) {\n          if (hasSPS) {\n            continue;\n          } else {\n            hasSPS = true;\n          }\n        } else if (_nal2.pps) {\n          if (hasPPS) {\n            continue;\n          } else {\n            hasPPS = true;\n          }\n        } else if (_nal2.key) {} else if (_nal2.type === 0) {\n          // if (!hasKeyframe) {\n          //   continue;\n          // }\n        } else if (_nal2.type === 35) {\n          continue;\n        }\n        var length = _nal2.body.byteLength;\n        if (_nal2.key) {\n          isKeyframe = true;\n        }\n        // if (!nal.vps && !nal.pps && !nal.sps) {\n        data.set(new Uint8Array([length >>> 24 & 0xff, length >>> 16 & 0xff, length >>> 8 & 0xff, length & 0xff]), offset);\n        offset += 4;\n        data.set(_nal2.body, offset);\n        offset += length;\n        // }\n      }\n      var dts = parseInt(pes.dts / 90);\n      var pts = parseInt(pes.pts / 90);\n\n      if (seiList) {\n        seiList.forEach(function (sei) {\n          sei.dts = dts;\n          _this3.emit(TsDemuxer.EVENTS.SEI_PARSED, sei);\n        });\n      }\n\n      var sample = new VideoSample({\n        dts: dts,\n        pts: pts,\n        cts: pts - dts,\n        originDts: pes.dts,\n        purePts: pes.purePts,\n        isKeyframe: isKeyframe,\n        data: data,\n        nals: nals,\n        options: options,\n        firstInGop: firstInGop,\n        gopId: firstInGop ? ++this.gopId : this.gopId\n      });\n      this.emit(TsDemuxer.EVENTS.VIDEO_SAMPLE_PARSED, sample);\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this.removeAllListeners();\n      this.configs = {};\n      this.demuxing = false;\n      this.pat = [];\n      this.pmt = [];\n      this._hasVideoMeta = false;\n      this._hasAudioMeta = false;\n    }\n  }], [{\n    key: 'compareArray',\n    value: function compareArray(a, b, type) {\n      var al = 0;\n      var bl = 0;\n      if (type === 'Uint8Array') {\n        al = a.byteLength;\n        bl = b.byteLength;\n      } else if (type === 'Array') {\n        al = a.length;\n        bl = b.length;\n      }\n      if (al !== bl) {\n        return false;\n      }\n\n      for (var i = 0; i < al; i++) {\n        if (a[i] !== b[i]) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }, {\n    key: 'compareMeta',\n    value: function compareMeta(a, b, ignoreDuration) {\n      if (!a || !b) {\n        return false;\n      }\n\n      for (var i = 0, k = Object.keys(a).length; i < k; i++) {\n        var itema = a[Object.keys(a)[i]];\n        var itemb = b[Object.keys(a)[i]];\n        if (!itema && !itemb) {\n          return true;\n        }\n\n        if ((itema === undefined || itema === null) && itemb || itema && itemb === undefined) {\n          return false;\n        }\n\n        if ((typeof itema === 'undefined' ? 'undefined' : _typeof(itema)) !== 'object') {\n          if (ignoreDuration && Object.keys(a)[i] !== 'duration' && Object.keys(a)[i] !== 'refSampleDuration' && Object.keys(a)[i] !== 'refSampleDurationFixed' && itema !== itemb) {\n            return false;\n          }\n        } else if (itema.byteLength !== undefined) {\n          if (itemb.byteLength === undefined) {\n            return false;\n          }\n          if (!TsDemuxer.compareArray(itema, itemb, 'Uint8Array')) {\n            return false;\n          }\n        } else if (itema.length !== undefined) {\n          if (itemb.length === undefined) {\n            return false;\n          }\n          if (!TsDemuxer.compareArray(itema, itemb, 'Array')) {\n            return false;\n          }\n        } else {\n          if (!TsDemuxer.compareMeta(itema, itemb)) {\n            return false;\n          }\n        }\n      }\n      return true;\n    }\n  }, {\n    key: 'mergeVideoES',\n    value: function mergeVideoES(buffers) {\n      var data = void 0;\n      var length = 0;\n      var offset = 0;\n      for (var i = 0; i < buffers.length; i++) {\n        length += buffers[i].length - buffers[i].position;\n      }\n\n      data = new Uint8Array(length);\n      for (var _i3 = 0; _i3 < buffers.length; _i3++) {\n        var buffer = buffers[_i3];\n        data.set(new Uint8Array(buffer.buffer, buffer.position), offset);\n        offset += buffer.length - buffer.position;\n      }\n      return new XGDataView(data.buffer);\n    }\n  }, {\n    key: 'mergeAudioES',\n    value: function mergeAudioES(buffers) {\n      var data = void 0;\n      var length = 0;\n      var offset = 0;\n      for (var i = 0; i < buffers.length; i++) {\n        length += buffers[i].length;\n      }\n\n      data = new Uint8Array(length);\n      for (var _i4 = 0; _i4 < buffers.length; _i4++) {\n        var buffer = buffers[_i4];\n        data.set(new Uint8Array(buffer.buffer), offset);\n        offset += buffer.length;\n      }\n\n      return new XGDataView(data.buffer);\n    }\n  }, {\n    key: 'read',\n    value: function read(stream, ts, frags) {\n      TsDemuxer.readHeader(stream, ts);\n      TsDemuxer.readPayload(stream, ts, frags);\n      // console.log('start', window.performance.now());\n      // console.log('end', window.performance.now());\n      if (ts.header.packet === 'MEDIA' && ts.header.payload === 1 && !ts.unknownPIDs) {\n        ts.pes = TsDemuxer.PES(ts);\n      }\n    }\n  }, {\n    key: 'readPayload',\n    value: function readPayload(stream, ts, frags) {\n      var header = ts.header;\n      var pid = header.pid;\n      switch (pid) {\n        case 0:\n          TsDemuxer.PAT(stream, ts, frags);\n          break;\n        case 1:\n          TsDemuxer.CAT(stream, ts, frags);\n          break;\n        case 2:\n          TsDemuxer.TSDT(stream, ts, frags);\n          break;\n        case 0x1fff:\n          break;\n        default:\n          var isPMT = false;\n          for (var i = 0, len = frags.pat.length; i < len; i++) {\n            if (frags.pat[i].pid === pid) {\n              isPMT = true;\n              break;\n            }\n          }\n          // TODO: some的写法不太好，得改\n          if (isPMT) {\n            TsDemuxer.PMT(stream, ts, frags);\n          } else {\n            var sts = [];\n            for (var _i5 = 0, _len = frags.pmt.length; _i5 < _len; _i5++) {\n              if (frags.pmt[_i5].pid === pid) {\n                sts.push(frags.pmt[_i5]);\n                break;\n              }\n            }\n            if (sts.length > 0) {\n              var streamType = sts[0].streamType;\n              TsDemuxer.Media(stream, ts, streamType);\n            } else {\n              ts.unknownPIDs = true;\n            }\n          }\n      }\n    }\n  }, {\n    key: 'readHeader',\n    value: function readHeader(stream, ts) {\n      var header = {};\n      header.sync = stream.readUint8();\n      var next = stream.readUint16();\n      header.error = next >>> 15;\n      header.payload = next >>> 14 & 1;\n      header.priority = next >>> 13 & 1;\n      header.pid = next & 0x1fff;\n\n      next = stream.readUint8();\n\n      header.scrambling = next >> 6 & 0x3; // 是否加密，00表示不加密\n\n      /**\n       * 00 ISO/IEC未来使用保留\n       * 01 没有调整字段，仅含有184B有效净荷\n       * 02 没有有效净荷，仅含有183B调整字段\n       * 03 0~182B调整字段后为有效净荷\n       */\n      header.adaptation = next >> 4 & 0x3;\n      header.continuity = next & 15;\n      header.packet = header.pid === 0 ? 'PAT' : 'MEDIA';\n      ts.header = header;\n    }\n  }, {\n    key: 'PAT',\n    value: function PAT(stream, ts, frags) {\n      var ret = {};\n      var next = stream.readUint8();\n      stream.skip(next);\n      next = stream.readUint8();\n      ret.tabelID = next;\n      next = stream.readUint16();\n      ret.error = next >>> 7;\n      ret.zero = next >>> 6 & 1;\n      ret.sectionLength = next & 0xfff;\n      ret.streamID = stream.readUint16();\n      ret.current = stream.readUint8() & 1;\n      ret.sectionNumber = stream.readUint8();\n      ret.lastSectionNumber = stream.readUint8();\n      var N = (ret.sectionLength - 9) / 4;\n      var list = [];\n      for (var i = 0; i < N; i++) {\n        var programNumber = stream.readUint16();\n        var pid = stream.readUint16() & 0x1fff;\n        list.push({\n          program: programNumber,\n          pid: pid,\n          type: programNumber === 0 ? 'network' : 'mapPID'\n        });\n      }\n      if (list.length > 0) {\n        frags.pat = frags.pat.concat(list);\n      }\n      ret.list = list;\n      ret.program = stream.readUint16();\n      ret.pid = stream.readUint16() & 0x1fff;\n      ts.payload = ret;\n      // TODO CRC\n    }\n\n    /**\n     * ISO-13818-1 Table-2-25\n     * payload 针对 PMT:\n     *  1 字节： table id [table 第一字节]\n     *  section_length : 12bit 【table 第2字节后四位，3字节】\n     *  program_number : 16bit 【table第4，5字节】\n     *  program_info_length : 12bit 【table 第11字节后 4bit + 第12 byte】\n     *  N * 8 : descriptor\n     *    stream_type : 8bit\n     *    pid\n     *\n     * // 4 字节\n     *  reserved : 3bit\n     *  elementary_PID : 13bit\n     *  reserved : 4bit\n     *  ES_info_length: 12bit\n     */\n\n  }, {\n    key: 'PMT',\n    value: function PMT(stream, ts, frags) {\n      var header = ts.header;\n      header.packet = 'PMT';\n\n      var offset = stream.position;\n\n      offset += stream.getUint8(offset);\n\n      offset += 1; // add 1 byte for table id\n\n      var sectionLength = (stream.getUint8(offset + 1) & 0x0f) << 8 | stream.getUint8(offset + 2);\n\n      var tableEnd = offset + 3 + sectionLength - 4;\n\n      var programInfoLength = (stream.getUint8(offset + 10) & 0x0f) << 8 | stream.getUint8(offset + 11);\n\n      offset += 12 + programInfoLength;\n\n      var list = [];\n\n      while (offset < tableEnd) {\n        var pid = (stream.getUint8(offset + 1) & 0x1f) << 8 | stream.getUint8(offset + 2);\n        list.push({\n          streamType: stream.getUint8(offset),\n          pid: pid\n        });\n        offset += ((stream.getUint8(offset + 3) & 0x0f) << 8 | stream.getUint8(offset + 4)) + 5;\n      }\n      frags.pmt = list;\n      stream.skip(tableEnd + 4);\n    }\n  }, {\n    key: 'Media',\n    value: function Media(stream, ts, streamType) {\n      var header = ts.header;\n      var payload = {};\n\n      var _StreamType$streamTyp = _slicedToArray(StreamType[streamType], 2),\n          type = _StreamType$streamTyp[0],\n          codec = _StreamType$streamTyp[1];\n\n      header.streamType = streamType;\n      header.type = type;\n      header.codec = codec;\n\n      if (header.adaptation === 0x03) {\n        payload.adaptationLength = stream.readUint8();\n        if (payload.adaptationLength > 0) {\n          var next = stream.readUint8();\n          payload.discontinue = next >>> 7;\n          payload.access = next >>> 6 & 0x01;\n          payload.priority = next >>> 5 & 0x01;\n          payload.PCR = next >>> 4 & 0x01;\n          payload.OPCR = next >>> 3 & 0x01;\n          payload.splicePoint = next >>> 2 & 0x01;\n          payload.transportPrivate = next >>> 1 & 0x01;\n          payload.adaptationField = next & 0x01;\n          var _start = stream.position;\n          if (payload.PCR === 1) {\n            payload.programClockBase = stream.readUint32() << 1;\n            next = stream.readUint16();\n            payload.programClockBase |= next >>> 15;\n            payload.programClockExtension = next & 0x1ff;\n          }\n          if (payload.OPCR === 1) {\n            payload.originProgramClockBase = stream.readUint32() << 1;\n            next = stream.readUint16();\n            payload.originProgramClockBase += next >>> 15;\n            payload.originProgramClockExtension = next & 0x1ff;\n          }\n          if (payload.splicePoint === 1) {\n            payload.spliceCountdown = stream.readUint8();\n          }\n          if (payload.transportPrivate === 1) {\n            var length = stream.readUint8();\n            var transportPrivateData = [];\n            for (var i = 0; i < length; i++) {\n              transportPrivateData.push(stream.readUint8());\n            }\n          }\n          if (payload.adaptationField === 1) {\n            var _length = stream.readUint8();\n            var _next = stream.readUint8();\n            var start = stream.position;\n            var ltw = _next >>> 7;\n            var piecewise = _next >>> 6 & 0x1;\n            var seamless = _next >>> 5 & 0x1;\n            if (ltw === 1) {\n              _next = stream.readUint16();\n              payload.ltwValid = _next >>> 15;\n              payload.ltwOffset = _next & 0xefff;\n            }\n            if (piecewise === 1) {\n              _next = stream.readUint24();\n              payload.piecewiseRate = _next & 0x3fffff;\n            }\n            if (seamless === 1) {\n              _next = stream.readInt8();\n              payload.spliceType = _next >>> 4;\n              payload.dtsNextAU1 = _next >>> 1 & 0x7;\n              payload.marker1 = _next & 0x1;\n              _next = stream.readUint16();\n              payload.dtsNextAU2 = _next >>> 1;\n              payload.marker2 = _next & 0x1;\n              _next = stream.readUint16();\n              payload.dtsNextAU3 = _next;\n            }\n            stream.skip(_length - 1 - (stream.position - start));\n          }\n          var lastStuffing = payload.adaptationLength - 1 - (stream.position - _start);\n          stream.skip(lastStuffing);\n        }\n      }\n      payload.stream = new XGDataView(stream.buffer.slice(stream.position));\n      ts.payload = payload;\n    }\n\n    /**\n     * http://dvd.sourceforge.net/dvdinfo/pes-hdr.html\n     * ISO-13818-1 Table-2-17\n     * packet_start_code_prefix : 24bit 0x000001\n     * stream_id : 8bit\n     * PES_packet_length : 16bit\n     * PTS_DTS_flags : 2bit 【PES_packet_length后第2字节前2位】& 0xc0  [0x10 0x11]\n     * PES_header_data_length : 【PTS_DTS_flags 后第1字节】\n     *\n     * | 6字节header | 3字节扩展 | PES Header data | payload |\n     */\n\n  }, {\n    key: 'PES',\n    value: function PES(ts) {\n      var ret = {};\n      var buffer = ts.payload.stream;\n\n      var next = buffer.readUint24();\n      if (next !== 1) {\n        ret.ES = {};\n        ret.ES.buffer = buffer;\n      } else {\n        var streamID = buffer.readUint8();\n        if (streamID >= 0xe0 && streamID <= 0xef) {\n          ret.type = 'video';\n        }\n        if (streamID >= 0xc0 && streamID <= 0xdf) {\n          ret.type = 'audio';\n        }\n        var packetLength = buffer.readUint16();\n        ret.packetLength = packetLength;\n        if (ret.type === 'video' || ret.type === 'audio') {\n          var _next2 = buffer.readUint8();\n          var first = _next2 >>> 6;\n          if (first !== 0x02) {\n            throw new Error('error when parse pes header');\n          }\n          _next2 = buffer.readUint8();\n          ret.ptsDTSFlag = _next2 >>> 6;\n          ret.escrFlag = _next2 >>> 5 & 0x01;\n          ret.esRateFlag = _next2 >>> 4 & 0x01;\n          ret.dsmFlag = _next2 >>> 3 & 0x01;\n          ret.additionalFlag = _next2 >>> 2 & 0x01;\n          ret.crcFlag = _next2 >>> 1 & 0x01;\n          ret.extensionFlag = _next2 & 0x01;\n          ret.pesHeaderLength = buffer.readUint8();\n          var N1 = ret.pesHeaderLength;\n\n          // 计算pts\n          var pts = [];\n\n          pts.push(buffer.readUint8());\n          pts.push(buffer.readUint8());\n          pts.push(buffer.readUint8());\n          pts.push(buffer.readUint8());\n          pts.push(buffer.readUint8());\n\n          var p = (pts[0] & 0x0e) * 536870912 + // 1 << 29\n          (pts[1] & 0xff) * 4194304 + // 1 << 22\n          (pts[2] & 0xfe) * 16384 + // 1 << 14\n          (pts[3] & 0xff) * 128 + // 1 << 7\n          (pts[4] & 0xfe) / 2;\n          // 不经过任何处理的原始的pts\n          ret.purePts = p;\n          buffer.dataview.position -= 5;\n          pts = [];\n\n          _next2 = buffer.readUint8();\n          pts.push(_next2 >>> 1 & 0x07);\n          _next2 = buffer.readUint16();\n          pts.push(_next2 >>> 1);\n          _next2 = buffer.readUint16();\n          pts.push(_next2 >>> 1);\n          ret.pts = pts[0] << 30 | pts[1] << 15 | pts[2];\n          N1 -= 5;\n\n          // 视频如果没有dts用pts\n          if (ret.type === 'video') {\n            ret.dts = ret.pts;\n          }\n\n          if (ret.ptsDTSFlag === 3) {\n            var dts = [];\n            _next2 = buffer.readUint8();\n            dts.push(_next2 >>> 1 & 0x07);\n            _next2 = buffer.readUint16();\n            dts.push(_next2 >>> 1);\n            _next2 = buffer.readUint16();\n            dts.push(_next2 >>> 1);\n            ret.dts = dts[0] << 30 | dts[1] << 15 | dts[2];\n            N1 -= 5;\n          }\n\n          if (ret.escrFlag === 1) {\n            var escr = [];\n            var ex = [];\n            _next2 = buffer.readUint8();\n            escr.push(_next2 >>> 3 & 0x07);\n            escr.push(_next2 & 0x03);\n            _next2 = buffer.readUint16();\n            escr.push(_next2 >>> 13);\n            escr.push(_next2 & 0x03);\n            _next2 = buffer.readUint16();\n            escr.push(_next2 >>> 13);\n            ex.push(_next2 & 0x03);\n            _next2 = buffer.readUint8();\n            ex.push(_next2 >>> 1);\n            ret.escr = (escr[0] << 30 | escr[1] << 28 | escr[2] << 15 | escr[3] << 13 | escr[4]) * 300 + (ex[0] << 7 | ex[1]);\n            N1 -= 6;\n          }\n          if (ret.esRateFlag === 1) {\n            _next2 = buffer.readUint24();\n            ret.esRate = _next2 >>> 1 & 0x3fffff;\n            N1 -= 3;\n          }\n          if (ret.dsmFlag === 1) {\n            throw new Error('not support DSM_trick_mode');\n          }\n          if (ret.additionalFlag === 1) {\n            _next2 = buffer.readUint8();\n            ret.additionalCopyInfo = _next2 & 0x7f;\n            N1 -= 1;\n          }\n          if (ret.crcFlag === 1) {\n            ret.pesCRC = buffer.readUint16();\n            N1 -= 2;\n          }\n          if (ret.extensionFlag === 1) {\n            throw new Error('not support extension');\n          }\n          if (N1 > 0) {\n            buffer.skip(N1);\n          }\n          if (ret.dts > ret.pts) {\n            ret.dts = ret.pts;\n          }\n          ret.ES = TsDemuxer.ES(buffer, ret.type, ts.header.streamType);\n        } else {\n          throw new Error('format is not supported');\n        }\n      }\n      return ret;\n    }\n  }, {\n    key: 'ES',\n    value: function ES(buffer, type, streamType) {\n      var ret = {};\n      if (type === 'video') {\n        // TODO readnalu\n        ret.buffer = buffer;\n      } else if (type === 'audio') {\n        if (streamType === 0x0f || streamType === 0x11) {\n          ret = TsDemuxer.parseADTSHeader(buffer);\n        }\n        ret.buffer = buffer;\n      } else {\n        throw new Error('ES ' + type + ' is not supported');\n      }\n\n      return ret;\n    }\n  }, {\n    key: 'parseADTSHeader',\n    value: function parseADTSHeader(buffer) {\n      var ret = {};\n      var next = buffer.readUint16();\n      // adts的同步字节，12位\n      if (next >>> 4 !== 0xfff) {\n        throw new Error('aac ES parse Error');\n      }\n      var fq = [96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350];\n      ret.id = (next >>> 3 & 0x01) === 0 ? 'MPEG-4' : 'MPEG-2';\n      ret.layer = next >>> 1 & 0x03;\n      ret.absent = next & 0x01;\n      next = buffer.readUint16();\n      ret.audioObjectType = (next >>> 14 & 0x03) + 1;\n      ret.profile = ret.audioObjectType - 1;\n      ret.frequencyIndex = next >>> 10 & 0x0f;\n      ret.frequence = fq[ret.frequencyIndex];\n      ret.channel = next >>> 6 & 0x07;\n      ret.frameLength = (next & 0x03) << 11 | buffer.readUint16() >>> 5;\n      TsDemuxer.getAudioConfig(ret);\n      buffer.skip(1);\n      ret.buffer = buffer;\n      return ret;\n    }\n  }, {\n    key: 'TSDT',\n    value: function TSDT(stream, ts, frags) {\n      // TODO\n      ts.payload = {};\n    }\n  }, {\n    key: 'CAT',\n    value: function CAT(stream, ts, frags) {\n      var ret = {};\n      ret.tableID = stream.readUint8();\n      var next = stream.readUint16();\n      ret.sectionIndicator = next >>> 7;\n      ret.sectionLength = next & 0x0fff;\n      stream.skip(2);\n      next = stream.readUint8();\n      ret.version = next >>> 3;\n      ret.currentNextIndicator = next & 0x01;\n      ret.sectionNumber = stream.readUint8();\n      ret.lastSectionNumber = stream.readUint8();\n      var N = (this.sectionLength - 9) / 4;\n      var list = [];\n      for (var i = 0; i < N; i++) {\n        list.push({});\n      }\n      ret.crc32 = stream.readUint32();\n      ts.payload = ret;\n    }\n  }, {\n    key: 'getAudioConfig',\n    value: function getAudioConfig(ret) {\n      var userAgent = navigator.userAgent.toLowerCase();\n      var config = void 0;\n      var extensionSampleIndex = void 0;\n      ret.originAudioObjectType = ret.audioObjectType;\n      if (/firefox/i.test(userAgent)) {\n        if (ret.frequencyIndex >= 8) {\n          ret.audioObjectType = 5;\n          config = new Array(4);\n          extensionSampleIndex = ret.frequencyIndex - 3;\n        } else {\n          ret.audioObjectType = 2;\n          config = new Array(2);\n          extensionSampleIndex = ret.frequencyIndex;\n        }\n      } else if (userAgent.indexOf('android') !== -1) {\n        ret.audioObjectType = 2;\n        config = new Array(2);\n        extensionSampleIndex = ret.frequencyIndex;\n      } else {\n        ret.audioObjectType = 5;\n        config = new Array(4);\n        if (ret.frequencyIndex >= 6) {\n          extensionSampleIndex = ret.frequencyIndex - 3;\n        } else {\n          if (ret.channel === 1) {\n            ret.audioObjectType = 2;\n            config = new Array(2);\n          }\n          extensionSampleIndex = ret.frequencyIndex;\n        }\n      }\n\n      config[0] = ret.audioObjectType << 3;\n      config[0] |= (ret.frequencyIndex & 0x0e) >> 1;\n      config[1] = (ret.frequencyIndex & 0x01) << 7;\n      config[1] |= ret.channel << 3;\n      if (ret.audioObjectType === 5) {\n        config[1] |= (extensionSampleIndex & 0x0e) >> 1;\n        config[2] = (extensionSampleIndex & 0x01) << 7;\n        config[2] |= 2 << 2;\n        config[3] = 0;\n      }\n\n      ret.audioConfig = config;\n    }\n  }]);\n\n  return TsDemuxer;\n}(EventEmitter);\n\nexport default TsDemuxer;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport { EVENTS } from 'xgplayer-helper-utils';\nimport { AudioTrack, VideoTrack } from 'xgplayer-helper-models';\nimport Demuxer from './ts-demuxer';\nvar DEMUX_EVENTS = EVENTS.DEMUX_EVENTS;\n\n/**\n * @typedef {import('xgplayer-helper-models').TsFrag} TsFrag\n */\n\nvar TsDemuxer = function () {\n  function TsDemuxer(configs) {\n    _classCallCheck(this, TsDemuxer);\n\n    this.configs = Object.assign({}, configs);\n    this.demuxer = null;\n  }\n\n  _createClass(TsDemuxer, [{\n    key: 'init',\n    value: function init() {\n      this.on(DEMUX_EVENTS.DEMUX_START, this.demux.bind(this));\n    }\n  }, {\n    key: 'initDemuxer',\n    value: function initDemuxer() {\n      this.demuxer.on(Demuxer.EVENTS.METADATA_PARSED, this.onMetaDataParsed.bind(this));\n      this.demuxer.on(Demuxer.EVENTS.VIDEO_SAMPLE_PARSED, this.onVideoSampleParsed.bind(this));\n      this.demuxer.on(Demuxer.EVENTS.AUDIO_SAMPLE_PARSED, this.onAudioSampleParsed.bind(this));\n      this.demuxer.on(Demuxer.EVENTS.SEI_PARSED, this.emit.bind(this, DEMUX_EVENTS.SEI_PARSED));\n    }\n\n    /**\n     * @param {TsFrag} frag\n     * @param {boolean} isVod\n     */\n\n  }, {\n    key: 'demux',\n    value: function demux(frag, isVod) {\n      if (!this._tracks) {\n        return;\n      }\n      if (!this._tracks.audioTrack) {\n        this._tracks.audioTrack = new AudioTrack();\n      }\n\n      if (!this._tracks.videoTrack) {\n        this._tracks.videoTrack = new VideoTrack();\n      }\n\n      if (!this.demuxer) {\n        this.demuxer = new Demuxer(this._tracks);\n        this.initDemuxer();\n      }\n      try {\n        this.demuxer.demux(frag, this.inputBuffer, isVod);\n      } catch (e) {\n        this.emit(DEMUX_EVENTS.DEMUX_ERROR, this.TAG, e, false);\n      }\n      var hasVideo = this._tracks.videoTrack && this._tracks.videoTrack.samples.length ? 1 : 0;\n      var hasAudio = this._tracks.audioTrack && this._tracks.audioTrack.samples.length ? 1 : 0;\n      this.emit(DEMUX_EVENTS.DEMUX_COMPLETE, hasVideo, hasAudio);\n    }\n  }, {\n    key: 'onMetaDataParsed',\n    value: function onMetaDataParsed(type, meta) {\n      var _tracks = this._tracks,\n          videoTrack = _tracks.videoTrack,\n          audioTrack = _tracks.audioTrack;\n\n      var track = videoTrack;\n\n      switch (type) {\n        case 'video':\n          track = videoTrack;\n          break;\n        case 'audio':\n          track = audioTrack;\n          break;\n        default:\n          track = videoTrack;\n      }\n      track.meta = meta;\n      this.emit(DEMUX_EVENTS.METADATA_PARSED, type, meta);\n    }\n  }, {\n    key: 'onVideoSampleParsed',\n    value: function onVideoSampleParsed(sample) {\n      if (sample.isKeyframe) {\n        this.emit(DEMUX_EVENTS.ISKEYFRAME, sample.pts);\n      }\n      this._tracks.videoTrack.samples.push(sample);\n    }\n  }, {\n    key: 'onAudioSampleParsed',\n    value: function onAudioSampleParsed(sample) {\n      this._tracks.audioTrack.samples.push(sample);\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this.off(DEMUX_EVENTS.DEMUX_START, this.demux);\n      this.configs = {};\n      this.demuxer && this.demuxer.destroy();\n    }\n  }, {\n    key: 'inputBuffer',\n    get: function get() {\n      return this._context.getInstance(this.configs.inputbuffer);\n    }\n  }, {\n    key: '_tracks',\n    get: function get() {\n      return this._context.getInstance('TRACKS');\n    }\n  }]);\n\n  return TsDemuxer;\n}();\n\nexport default TsDemuxer;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport { TsFrag } from 'xgplayer-helper-models';\n\nvar REGEXP_ABSOLUTE_URL = /^(?:[a-zA-Z0-9+\\-.]+:)?\\/\\//;\nvar REGEXP_URL_PAIR = /^((?:[a-zA-Z0-9+\\-.]+:)?\\/\\/[^/?#]*)?([^?#]*\\/)?/;\n\nfunction getAbsoluteUrl(url, parentUrl) {\n  if (!parentUrl || !url || REGEXP_ABSOLUTE_URL.test(url)) return url;\n  var pairs = REGEXP_URL_PAIR.exec(parentUrl);\n  if (!pairs) return url;\n  if (url[0] === '/') return pairs[1] + url;\n  return pairs[1] + pairs[2] + url;\n}\n\n/**\n * Reference: https://tools.ietf.org/html/rfc8216#section-4.3\n */\n\nvar M3U8Parser = function () {\n  function M3U8Parser() {\n    _classCallCheck(this, M3U8Parser);\n  }\n\n  _createClass(M3U8Parser, null, [{\n    key: 'parse',\n\n    /**\n     * @param {string} text\n     * @param {string} baseurl\n     * @return {{duration: number}}\n     */\n    value: function parse(text) {\n      var baseurl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n      var ret = {\n        duration: 0\n      };\n      if (!text || !text.split) {\n        return;\n      }\n      var refs = text.split(/\\r|\\n/);\n      refs = refs.filter(function (ref) {\n        return ref;\n      });\n      var ref = refs.shift();\n      if (!ref.match('#EXTM3U')) {\n        throw new Error('Invalid m3u8 file: not \"#EXTM3U\"');\n      }\n      ref = refs.shift();\n      var nextDiscontinue = false;\n      var nextId = 0;\n      while (ref) {\n        var refm = ref.match(/#(.[A-Z|-]*):(.*)/);\n        var refd = ref.match(/#(.[A-Z|-]*)/);\n        if (refd && refm && refm.length > 2) {\n          switch (refm[1]) {\n            case 'EXT-X-VERSION':\n              ret.version = parseInt(refm[2]);\n              break;\n            case 'EXT-X-MEDIA-SEQUENCE':\n              ret.sequence = parseInt(refm[2]);\n              break;\n            case 'EXT-X-TARGETDURATION':\n              ret.targetduration = parseFloat(refm[2]);\n              break;\n            case 'EXTINF':\n              nextId = M3U8Parser.parseFrag(refm, refs, ret, baseurl, nextDiscontinue, nextId);\n              nextDiscontinue = false;\n              break;\n            case 'EXT-X-KEY':\n              M3U8Parser.parseDecrypt(refm[2], ret);\n              break;\n            default:\n              break;\n          }\n        }if (refd && refd.length > 1) {\n          switch (refd[1]) {\n            case 'EXT-X-DISCONTINUITY':\n              nextDiscontinue = true;\n              break;\n            case 'EXT-X-ENDLIST':\n              var last = ret.frags[ret.frags.length - 1];\n              last.isLast = true;\n              ret.end = true;\n              break;\n            default:\n              break;\n          }\n        }\n        ref = refs[nextId++];\n      }\n      return ret;\n    }\n\n    /**\n     *\n     * @param {string[]}refm\n     * @param {string[]}refs\n     * @param {*} ret\n     * @param {string} baseurl\n     * @param {boolean} discontinue\n     * @param {number} nextId\n     * @return {*}\n     */\n\n  }, {\n    key: 'parseFrag',\n    value: function parseFrag(refm, refs, ret, baseurl, discontinue, nextId) {\n      if (!ret.frags) {\n        ret.frags = [];\n      }\n\n      var frag = new TsFrag({\n        start: ret.duration,\n        duration: parseInt(parseFloat(refm[2]) * 1000)\n      });\n\n      if (frag.duration < 200) {\n        return nextId;\n      }\n\n      ret.duration += frag.duration;\n      var nextline = refs[nextId++];\n      if (nextline.match(/#(.*):(.*)/) || nextline.match(/^#/)) {\n        nextline = refs[nextId++];\n      }\n\n      frag.url = getAbsoluteUrl(nextline, baseurl);\n\n      frag.discontinue = discontinue;\n      // add id\n      if (ret.frags.length) {\n        var last = ret.frags[ret.frags.length - 1];\n        frag.id = last.id + 1;\n        frag.cc = discontinue ? last.cc + 1 : last.cc;\n      } else {\n        frag.id = ret.sequence || 1;\n        frag.cc = 0;\n      }\n      ret.frags.push(frag);\n      return nextId;\n    }\n\n    /**\n     * @param {string[]}refm\n     * @param {*} ret\n     */\n\n  }, {\n    key: 'parseDecrypt',\n    value: function parseDecrypt(refm, ret) {\n      ret.encrypt = {};\n      var refs = refm.split(',');\n      for (var i in refs) {\n        var cmd = refs[i];\n        if (cmd.match(/METHOD=(.*)/)) {\n          ret.encrypt.method = cmd.match(/METHOD=(.*)/)[1];\n        }\n        if (cmd.match(/URI=\"(.*)\"/)) {\n          ret.encrypt.uri = cmd.match(/URI=\"(.*)\"/)[1];\n        }\n\n        if (cmd.match(/IV=0x(.*)/)) {\n          var iv = cmd.match(/IV=0x(.*)/)[1];\n          var length = Math.ceil(iv.length / 2);\n          ret.encrypt.ivb = new Uint8Array(length);\n          for (var _i = length - 1; _i >= 0; _i--) {\n            var im = parseInt(iv.substr(_i * 2, 2), 16);\n            ret.encrypt.ivb[_i] = im;\n          }\n          ret.encrypt.iv = iv;\n        }\n      };\n    }\n\n    /**\n     * @param {string} url\n     * @return {boolean}\n     */\n\n  }, {\n    key: 'isHTTPS',\n    value: function isHTTPS(url) {\n      var httpsUrlRegex = /^https:\\/\\//i;\n      return httpsUrlRegex.test(url);\n    }\n  }]);\n\n  return M3U8Parser;\n}();\n\nexport default M3U8Parser;","import { Tracks, Buffer as XgBuffer, Playlist } from 'xgplayer-helper-models'\nimport { Crypto, FetchLoader } from 'xgplayer-helper-utils';\nimport { M3U8Parser, TsDemuxer } from 'xgplayer-helper-transmuxers';\n\nexport default {\n  Tracks,\n  XgBuffer,\n  FetchLoader,\n  Crypto,\n  M3U8Parser,\n  TsDemuxer,\n  Playlist\n};\n","import Player from 'xgplayer'\nimport { EVENTS, Context } from 'xgplayer-helper-utils'\nimport HlsLiveController from './hls-live-mobile';\nimport defaultConfig from './config';\n// import 'xgplayer-mobilevideo'\nconst HlsAllowedEvents = EVENTS.HlsAllowedEvents;\n\nexport default class HlsLivePlayer extends Player {\n  static isSupported () {\n    const wasmSupported = 'WebAssembly' in window;\n    const WebComponentSupported = 'customElements' in window && window.customElements.define;\n    let isComponentDefined = false;\n    if (WebComponentSupported) {\n      isComponentDefined = window.customElements.get('live-video');\n    }\n    return wasmSupported && isComponentDefined\n  }\n\n  constructor (options) {\n    if (!options.mediaType) {\n      options.mediaType = 'live-video'\n      if (options.videoConfig) {\n        options.videoConfig.preloadtime = options.preloadTime || 5;\n      } else {\n        options.videoConfig = {\n          preloadtime: options.preloadTime || 5\n        }\n      }\n    }\n    super(options)\n    this.hlsOps = {};\n    this.util = Player.util;\n    this.hlsOps = Object.assign(this.hlsOps, defaultConfig);\n    this.util.deepCopy(this.hlsOps, options);\n    if (!this.playerInited) {\n      this.initPlayer()\n    }\n    // this.started = false;\n  }\n\n  initPlayer () {\n    this.video.width = Number.parseInt(this.hlsOps.width || 600)\n    this.video.height = Number.parseInt(this.hlsOps.height || 337.5)\n    this.video.style.outline = 'none';\n    this.playerInited = true;\n  }\n\n  _initEvents () {\n    this.once('canplay', () => {\n      this.video.play()\n    });\n  }\n\n  set src (url) {\n    this.onWaiting = this.onWaiting.bind(this)\n    this._context.destroy();\n    this._context = null;\n    this.started = false;\n    this.video.currentTime = 0;\n\n    this.start(url)\n  }\n\n  start (url = this.hlsOps.url) {\n    if (!url || this.started) {\n      return;\n    }\n\n    if (!this.playerInited) {\n      this.initPlayer()\n    }\n\n    if (!this._context) {\n      this._context = new Context(HlsAllowedEvents);\n    }\n\n    this.__core__ = this._context.registry('HLS_LIVE_CONTROLLER', HlsLiveController)({player: this, container: this.video, preloadTime: this.config.preloadTime});\n    this._context.init();\n    this.url = url;\n    this.__core__.load(url);\n    super.start(url)\n    this._initEvents();\n    this.started = true;\n    this.addLiveFlag();\n  }\n\n  play () {\n    if (this.started) {\n      this._context.destroy();\n      this._context = new Context(HlsAllowedEvents);\n      this.__core__ = this._context.registry('HLS_LIVE_CONTROLLER', HlsLiveController)({player: this, container: this.video, preloadTime: this.config.preloadTime});\n      this._context.init();\n      this._initEvents();\n      this.__core__.load(this.url);\n    }\n    super.play();\n  }\n\n  addLiveFlag () {\n    const player = this;\n    Player.util.addClass(player.root, 'xgplayer-is-live')\n    if (!Player.util.findDom(this.root, 'xg-live')) {\n      const live = Player.util.createDom('xg-live', '正在直播', {}, 'xgplayer-live')\n      player.controls.appendChild(live)\n    }\n  }\n\n  destroy (isDelDOM = true) {\n    return new Promise((resolve) => {\n      super.destroy();\n      let { video, root } = this;\n      super.destroy(isDelDOM);\n      if (video && video.remove) {\n        video.remove()\n      } else if (root) {\n        root.removeChild(video);\n      }\n      if (video) {\n        video.destroy()\n      }\n      setTimeout(() => {\n        resolve()\n      }, 50)\n    })\n  }\n\n  static install (name, plugin) {\n    return Player.install(name, plugin)\n  }\n}\n\nHlsLivePlayer.install = Player.install.bind(Player)\n"],"names":["BROWSER_EVENTS","VISIBILITY_CHANGE","PLAYER_EVENTS","SEEK","LOADER_EVENTS","LADER_START","LOADER_DATALOADED","LOADER_COMPLETE","LOADER_RESPONSE_HEADERS","LOADER_ERROR","LOADER_RETRY","LOADER_TTFB","DEMUX_EVENTS","DEMUX_START","DEMUX_COMPLETE","DEMUX_ERROR","METADATA_PARSED","SEI_PARSED","VIDEO_METADATA_CHANGE","AUDIO_METADATA_CHANGE","MEDIA_INFO","ISKEYFRAME","REMUX_EVENTS","REMUX_METADATA","REMUX_MEDIA","MEDIA_SEGMENT","REMUX_ERROR","INIT_SEGMENT","DETECT_CHANGE_STREAM","DETECT_CHANGE_STREAM_DISCONTINUE","DETECT_AUDIO_GAP","DETECT_LARGE_GAP","DETECT_AUDIO_OVERLAP","RANDOM_ACCESS_POINT","DETECT_FRAG_ID_DISCONTINUE","MSE_EVENTS","SOURCE_UPDATE_END","MSE_ERROR","MSE_WRONG_TRACK_ADD","HLS_EVENTS","RETRY_TIME_EXCEEDED","CRYPTO_EVENTS","START_DECRYPTOO","DECRYPTED","ALLEVENTS","Object","assign","FlvAllowedEvents","HlsAllowedEvents","key","hasOwnProperty","push","_key","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","prototype","_classCallCheck","instance","TypeError","Playlist","configs","_baseURL","_list","_ts","version","sequence","targetduration","duration","fragLength","_lastget","undefined","end","autoclear","logger","downloadedUrls","_avgSegmentDuration","value","tsURL","discontinue","id","cc","isLast","downloaded","downloading","start","deleteFrag","url","time","_calcAvgFrgmentDuration","data","frags","fragLen","Math","floor","pushM3U8","deletepre","Error","min","encrypt","len","log","newfraglist","frag","indexOf","tslist","getTsList","_i","keys","tsname","isloaded","ts","loading","getTsByName","name","getTs","timelist","sort","a","b","parseFloat","parseInt","getLastDownloadedTs","result","Number","found","clear","clearDownloaded","list","l","destroy","resetSequence","get","set","baseURL","XGDataView","buffer","ArrayBuffer","dataview","DataView","position","back","count","getUint8","offset","skip","loop","last","readByte","readUint8","readUint16","readUint24","readUint32","readUint64","readInt8","readInt16","readInt32","writeUint32","Uint8Array","byteLength","size","sign","res","getInt8","getInt16","getUint16","getInt32","getUint32","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","Track","sequenceNumber","samples","droppedSamples","reset","AudioTrack","_Track","_this","getPrototypeOf","TAG","type","VideoTrack","_Track2","_this2","dropped","Tracks","audioTrack","videoTrack","XgBuffer","historyLen","array","shift","_shiftBuffer","_ret","slice","_ret2","ret","tmpoff","tmp","templength","toInt","retInt","AudioTrackMeta","meta","_default","sampleRate","channelCount","codec","config","refSampleDuration","sampleRateIndex","timescale","init","VideoTrackMeta","avcc","sps","pps","chromaFormat","codecHeight","codecWidth","frameRate","fixed","fps","fps_num","fps_den","level","presentHeight","presentWidth","profile","parRatio","height","width","AudioSample","info","getDefault","dts","pts","originDts","VideoSample","sample","isKeyframe","nals","isObjectFilled","obj","MediaInfo","mimeType","hasVideo","video","hasAudio","audio","isComplete","isBaseInfoReady","isVideoReady","isAudioReady","mediaInfo","TsFrag","merged","has","prefix","Events","EE","fn","context","once","addListener","emitter","event","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","eventNames","names","events","getOwnPropertySymbols","concat","listeners","handlers","ee","Array","listenerCount","emit","a1","a2","a3","a4","a5","arguments","args","removeListener","apply","j","on","removeAllListeners","off","prefixed","module","_get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","parent","getter","DIRECT_EMIT_FLAG","Context","player","allowedEvents","_emitter","_instanceMap","_clsMap","_inited","_configs","_player","_hooks","getInstance","tag","initInstance","_len","c","d","newInstance","registry","cls","checkMessageName","_isMessageNameValid","bind","enhanced","_cls","onceListeners","_context","messageName","callback","before","beforeList","_len2","_key2","emitTo","_len3","_key3","removeListeners","hasOwn","callbacks","_messageName","_callbacks","_callback","v","_len4","_key4","seek","EVENTS","destroyInstances","_this3","forEach","Crypto","inputBuffer","inputbuffer","outputBuffer","outputbuffer","iv","method","crypto","window","msCrypto","START_DECRYPTO","decrypto","aeskey","sbkey","subtle","importKey","then","decryptoData","decrypt","Speed","_firstCheckpoint","_lastCheckpoint","_intervalBytes","_lastSamplingBytes","_now","Date","now","addBytes","bytes","durationSeconds","currentKBps","_typeof","Symbol","iterator","READ_STREAM","READ_TEXT","READ_JSON","READ_BUFFER","FetchLoader","status","error","_reader","_canceled","_destroyed","readtype","_loaderTaskNo","_ttfb","_speed","AbortController","abortControllerEnabled","load","_fetch","fetch","_x","_x2","_x3","toString","params","timeout","timer","abortController","signal","getTime","Promise","race","resolve","reject","setTimeout","code","message","abort","response","clearTimeout","elapsed","internalLoad","retryTimes","totalRetry","delayTime","loadTimeout","headers","ok","_onFetchResponse","_retryTimer","reason","retryTime","statusText","catch","opts","_ref","retryCount","retryDelay","getParams","_this4","taskno","json","text","arrayBuffer","_onReader","body","getReader","reader","_this5","cancel","e","_noDataTimer","read","val","done","options","Headers","mode","cache","configHeaders","append","optHeaders","cors","withCredentials","credentials","lastSamplingKBps","isSupported","_toConsumableArray","arr","isArray","arr2","from","DevLogger","matched","exec","document","cookie","_status","_level","funName","arg1","arg2","arg3","arg4","arg5","arg6","arg7","arg8","arg9","arg10","_console","tagName","filter","x","console","ADTS","isHeader","isHeaderPattern","getFrameDuration","samplerate","getHeaderLength","getFullFrameLength","parseFrameHeader","frameIndex","frameDuration","headerLength","frameLength","stamp","appendFrame","header","aacSample","unit","subarray","Golomb","uint8array","_buffer","_bufferIndex","_totalBytes","_totalBits","_currentWord","_currentWordBitsLeft","_fillCurrentWord","bufferBytesLeft","bytesRead","word","readBits","bits","valu","readBool","_skipLeadingZero","zeroCount","readUEG","leadingZeros","readSEG","readSliceType","SPSParser","_ebsp2rbsp","src","srcLength","dst","dstIdx","parseSPS","rbsp","gb","profileIdc","levelIdc","profile_string","getProfileString","level_string","getLevelString","chroma_format_idc","chroma_format","chroma_format_table","bit_depth","scaling_list_count","_skipScalingList","pic_order_cnt_type","num_ref_frames_in_pic_order_cnt_cycle","pic_width_in_mbs_minus1","pic_height_in_map_units_minus1","frame_mbs_only_flag","frame_crop_left_offset","frame_crop_right_offset","frame_crop_top_offset","frame_crop_bottom_offset","frame_cropping_flag","par_width","par_height","fps_fixed","vui_parameters_present_flag","aspect_ratio_idc","par_w_table","par_h_table","num_units_in_tick","time_scale","parScale","crop_unit_x","crop_unit_y","sub_wc","sub_hc","codec_width","codec_height","present_width","ceil","chroma_format_string","getChromaFormatString","frame_rate","par_ratio","codec_size","present_size","lastScale","nextScale","deltaScale","toFixed","chroma","toVideoMeta","spsConfig","bitDepth","fpsDen","fpsNum","RBSP","EBSP2RBSP","el","idx","EBSP2SODB","lastByte","u8aToString","String","fromCharCode","SEIParser","_resolveNalu","parse","sodb","_SEIParser$switchPayl","switchPayloadType","payloadType","content","user_data_unregistered","dv","getPayloadLength","payloadLength","_SEIParser$getPayload","uuid","payload","Nalunit","getNalunits","buf","getAnnexbNals","getAvccNals","getHeaderPositionAnnexB","pos","analyseNal","ndr","idr","sei","SpsParser","bufferLen","getAvcc","vpsId","maxSubLayersMinus1","tINf","spsId","separate_colour_plane_flag","chromaFormatIdc","conf_win_left_offset","conf_win_right_offset","conf_win_top_offset","conf_win_bottom_offset","conformanceWindowFlag","bitDepthLumaMinus8","bitDepthChromaMinus8","sub_width_c","sub_height_c","profileTierLevel","_readProfileTierLevel","general_profile_space","general_tier_flag","general_profile_idc","general_level_idc","subLayerProfilePresentFlag","subLayerLevelPresentFlag","getHvccNals","slice_trail_n","slice_trail_r","slice_tsa_n","slice_tsa_r","slice_stsa_n","slice_stsa_r","slice_radl_n","slice_radl_r","slice_rasl_n","slice_rasl_r","slice_bla_w_lp","slice_bla_w_radl","slice_bla_n_lp","slice_idl_w_radl","slice_idr_n_lp","slice_cra_nut","vps","aud","eob","fd","_ADTS","avc","_avc","hevc","_hevc","NalUnitHEVC","NalUnit","CRYTO_EVENTS","HLS_ERROR","MASTER_PLAYLIST_REGEX","HlsLiveController","_playlist","retrytimes","preloadTime","container","_m3u8lasttime","_timmer","setInterval","_checkStatus","_lastCheck","m3u8Text","hlsOps","TsDemuxer","_m3u8loader","_tsloader","initEvents","_onLoadComplete","_onMetadataParsed","_handleSEIParsed","_onDemuxComplete","_onLoadError","_onDemuxError","mod","err","fatal","errorType","errorDetails","errorFatal","analyzed","_isHEVC","nalsLength","reduce","current","newData","nal","onDemuxComplete","_setMetaToAudio","_setMetaToVideo","audioMeta","setAudioMeta","videoMeta","setVideoMeta","loader","_onError","handleEnded","mdata","M3U8Parser","_preload","uri","_keyLoader","_m3u8Loaded","START_DECRYPT","_crypto","ivb","_onDcripted","buffered","currentTime","readyState","bufferend","clearInterval","_slicedToArray","sliceIterator","_arr","_n","_d","_e","_s","next","_typeof2","StreamType","_EventEmitter","VIDEO_SAMPLE_PARSED","AUDIO_SAMPLE_PARSED","demuxing","pat","pmt","_hasVideoMeta","_hasAudioMeta","gopId","demux","isVod","peses","tsStream","pes","pid","streamType","ES","stream","AudioOptions","VideoOptions","noAudio","noVideo","epeses","cPes","isAAC","mergeAudioES","pushAudioSample","mergeVideoES","pushVideoSampleHEVC","pushVideoSample","spsFound","audioSampleRate","frequence","channel","audioObjectType","originCodec","originAudioObjectType","originObjectType","audioConfig","frequencyIndex","metaEqual","compareMeta","pesHeaderLength","streamChanged","frame","sampleLength","seiList","h","sarRatio","sar_ratio","_nal","cts","purePts","firstInGop","hasVPS","hasSPS","hasPPS","_i2","_nal2","compareArray","al","bl","ignoreDuration","k","itema","itemb","buffers","_i3","_i4","readHeader","readPayload","packet","unknownPIDs","PES","PAT","CAT","TSDT","isPMT","PMT","sts","_i5","Media","sync","priority","scrambling","adaptation","continuity","tabelID","zero","sectionLength","streamID","sectionNumber","lastSectionNumber","N","programNumber","program","tableEnd","programInfoLength","_StreamType$streamTyp","adaptationLength","access","PCR","OPCR","splicePoint","transportPrivate","adaptationField","_start","programClockBase","programClockExtension","originProgramClockBase","originProgramClockExtension","spliceCountdown","transportPrivateData","_length","_next","ltw","piecewise","seamless","ltwValid","ltwOffset","piecewiseRate","spliceType","dtsNextAU1","marker1","dtsNextAU2","marker2","dtsNextAU3","lastStuffing","packetLength","_next2","first","ptsDTSFlag","escrFlag","esRateFlag","dsmFlag","additionalFlag","crcFlag","extensionFlag","N1","p","escr","ex","esRate","additionalCopyInfo","pesCRC","parseADTSHeader","fq","layer","absent","getAudioConfig","tableID","sectionIndicator","currentNextIndicator","crc32","userAgent","navigator","toLowerCase","extensionSampleIndex","test","demuxer","initDemuxer","Demuxer","onMetaDataParsed","onVideoSampleParsed","onAudioSampleParsed","_tracks","track","REGEXP_ABSOLUTE_URL","REGEXP_URL_PAIR","getAbsoluteUrl","parentUrl","pairs","baseurl","split","refs","ref","match","nextDiscontinue","nextId","refm","refd","parseFrag","parseDecrypt","nextline","cmd","im","substr","isHTTPS","httpsUrlRegex","HlsLivePlayer","wasmSupported","WebComponentSupported","customElements","define","isComponentDefined","mediaType","videoConfig","preloadtime","util","Player","defaultConfig","deepCopy","playerInited","initPlayer","style","outline","play","started","__core__","_initEvents","addLiveFlag","addClass","root","findDom","live","createDom","controls","appendChild","isDelDOM","remove","removeChild","onWaiting","plugin","install"],"mappings":"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;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;;;;;EAlQC,GAhC2B,EAwS3B;EACDxnB,SAAK,uBADJ;EAEDuC,WAAO,SAASqlB,qBAAT,CAA+B/G,EAA/B,EAAmCgG,kBAAnC,EAAuD;EAC5D,UAAIgB,wBAAwB,CAA5B;EACA,UAAIC,oBAAoB,CAAxB;EACA,UAAIC,sBAAsB,CAA1B;EACA,UAAIC,oBAAoB,CAAxB;EACAH,8BAAwBhH,GAAGlB,QAAH,CAAY,CAAZ,KAAkB,CAA1C,CAL4D;EAM5DmI,0BAAoBjH,GAAGlB,QAAH,CAAY,CAAZ,KAAkB,CAAtC,CAN4D;EAO5DoI,4BAAsBlH,GAAGlB,QAAH,CAAY,CAAZ,KAAkB,CAAxC,CAP4D;;EAS5DkB,SAAGlB,QAAH,CAAY,EAAZ,EAT4D;EAU5DkB,SAAGlB,QAAH,CAAY,EAAZ;;EAEAkB,SA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"}