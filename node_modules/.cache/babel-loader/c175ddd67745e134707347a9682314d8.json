{"ast":null,"code":"import \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.match.js\";\nimport \"core-js/modules/es.regexp.test.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Ability from '@/components/management/Ability.vue';\nimport Journal from '@/components/management/Journal.vue';\nimport Control from '@/components/management/Control.vue';\nimport Foot from '@/components/Foot.vue';\nimport { addadmin, userinfor, ActivationState, authorities } from '@/common/api/adminCenter'; // import {ChatClient} from \"@qians/quake_ws_client-wasm\";\n//插件\n// import BScroll from '@better-scroll/core'\n\nimport { Toast } from 'mint-ui';\nexport default {\n  inject: [\"reload\"],\n  components: {\n    Ability: Ability,\n    Journal: Journal,\n    Control: Control,\n    Foot: Foot\n  },\n  data: function data() {\n    return {\n      isadmin: null,\n      baseform: {\n        \"username\": localStorage.getItem('username'),\n        \"org_id\": Number(this.$route.query.orgId),\n        \"nickname\": \"\",\n        \"role_id\": '',\n        \"avatar\": \"./images/Rectangl24.png\",\n        \"status\": 1\n      },\n      jouranlList: []\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    // this.chat()\n    // 暂时数据\n    // this.$router.push({\n    // \tpath:'',\n    // \tquery:{\n    // \t\t\t\"adminUsername\": \"k80783\",\n    // \t\t\t\"orgId\": 3,//机构id\n    // \t\t\t\"token\":\"dc251913-1d6f-4c79-bd0b-998e985dfc64\",\n    // \t\t\t}\n    // \t})\n    // 储存路径携带用户信息\n    localStorage.setItem('urlUserinfor', JSON.stringify(this.$route.query));\n    this.$store.commit('USER_IMG', this.$route.query); // 解析token\n\n    authorities(this.$route.query.token).then(function (res) {\n      localStorage.setItem('username', JSON.stringify(res.data.name)); // this.$emit(\"indexname\",)\n\n      _this.usermassage(); //获取用户信息\n\n\n      userinfor({\n        orgId: JSON.parse(localStorage.getItem(\"urlUserinfor\")).orgId,\n        username: JSON.parse(localStorage.getItem(\"username\"))\n      }).then(function (res) {\n        _this.isadmin = res.data.data.ActivationState;\n        _this.baseform.role_id = res.data.data.RoleId; // console.log(res.data.data)\n      }); // 日志\n\n      getjournal({\n        \"appName\": \"eagle\",\n        \"page\": 1,\n        \"pageSize\": 10,\n        \"username\": res.data.name,\n        \"orgId\": Number(_this.$route.query.orgId)\n      }).then(function (res) {\n        _this.jouranlList = res.data.data.content.reverse();\n\n        if (_this.jouranlList.length != 0) {\n          _this.jouranlList.length = 4;\n\n          for (var i = 0; i < _this.jouranlList.length; i++) {\n            _this.jouranlList[i].open = true;\n          }\n        }\n      });\n    });\n  },\n  mounted: function mounted() {\n    this.$nextTick(function () {// new BScroll('.wrapper', {\n      //  movable: true,\n      //  zoom: true,\n      //  probeType:2,\n      //  click:true\n      // })\n    });\n  },\n  methods: {\n    goMember: function goMember() {\n      var iscontrol = JSON.parse(localStorage.getItem('urlUserinfor'));\n\n      if (this.isadmin == 1) {\n        this.$router.push({\n          name: 'member',\n          query: {\n            role: this.baseform.role_id\n          }\n        });\n      } else {\n        this.$router.push({\n          name: 'nodata'\n        });\n      }\n    },\n    goRole: function goRole() {\n      if (this.isadmin == 1) {\n        this.$router.push({\n          name: 'role'\n        });\n      } else {\n        this.$router.push({\n          name: 'nodata'\n        });\n      }\n    },\n    goPrivileges: function goPrivileges() {\n      if (this.isadmin == 1) {\n        this.$router.push({\n          name: 'privileges'\n        });\n      } else {\n        this.$router.push({\n          name: 'nodata'\n        });\n      }\n    },\n    gohome: function gohome() {\n      this.$router.push({\n        name: 'home'\n      });\n    },\n    goDevice: function goDevice() {\n      this.$router.push({\n        name: 'device'\n      });\n    },\n    // 申请激活状态\n    goapplyBtn: function goapplyBtn() {\n      var _this2 = this;\n\n      this.baseform.activation_state = 2;\n      this.baseform.username = localStorage.getItem(\"username\");\n      ActivationState(this.baseform).then(function (res) {\n        // console.log(res.data)\n        _this2.isadmin = 2;\n        Toast(\"申请成功\");\n      });\n    },\n    // 等待激活\n    nothing: function nothing() {\n      Toast(\"请耐心等待\");\n    },\n    // 向原生端发送信息\n    gohomePage: function gohomePage() {\n      localStorage.removeItem('urlUserinfor');\n      localStorage.removeItem('username');\n      var ua = navigator.userAgent.toLowerCase(); //android终端\n\n      var isAndroid = ua.indexOf('Android') > -1 || ua.indexOf('Adr') > -1; //ios终端\n\n      var isiOS = !!ua.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/);\n\n      if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) {\n        window.jsBack.postMessage();\n      } else if (/(Android)/i.test(navigator.userAgent)) {\n        window.flutter_inappwebview.callHandler('jsBack');\n      }\n    },\n    usermassage: function usermassage() {\n      var adminusername = this.$route.query.adminUsername;\n      var username = JSON.parse(localStorage.getItem(\"username\")); // console.log(username)\n\n      if (adminusername == username) {\n        // 添加用户，admin创建组织\n        addadmin({\n          \"username\": username,\n          \"org_id\": Number(this.$route.query.orgId),\n          \"nickname\": \"\",\n          \"avatar\": \"./images/Rectangl24.png\",\n          \"role_id\": 'admin',\n          \"status\": 1\n        }).catch(function (err) {\n          console.log(err);\n        });\n        console.log(\"我是超级管理员\");\n      } else {\n        // 添加用户，admin创建组织\n        addadmin({\n          \"username\": username,\n          \"org_id\": Number(this.$route.query.orgId),\n          \"nickname\": \"\",\n          \"role_id\": 'normal',\n          \"avatar\": \"./images/Rectangl24.png\",\n          \"status\": 1\n        }).catch(function (err) {\n          console.log(err);\n        }); // console.log(username)\n      }\n    } // 连接wasm\n    // chat(){\n    // \t// console.log(\"[Views: HomeView.vue]wait for init client\")\n    // \t//FIXME: change k32212 to username(token)\n    // \tconst that = this\n    // \tChatClient.init(\"k32212\", 'levitas.quakeai.tech:31033', 'eye_h5',true)\n    // \tthis.ChatClient = ChatClient\n    // \tsetTimeout(function(){\n    // \t\tconsole.log(\"[Views: HomeView.vue]chat client has been inited: \", that.ChatClient.get_group_chridren())\n    // \t},5000)\n    // },\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}